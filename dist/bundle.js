/*! For license information please see bundle.js.LICENSE.txt */
(()=>{"use strict";var e={};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}();const t=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let s=e.charCodeAt(r);s<128?t[n++]=s:s<2048?(t[n++]=s>>6|192,t[n++]=63&s|128):55296==(64512&s)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(s=65536+((1023&s)<<10)+(1023&e.charCodeAt(++r)),t[n++]=s>>18|240,t[n++]=s>>12&63|128,t[n++]=s>>6&63|128,t[n++]=63&s|128):(t[n++]=s>>12|224,t[n++]=s>>6&63|128,t[n++]=63&s|128)}return t},n={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let t=0;t<e.length;t+=3){const s=e[t],i=t+1<e.length,o=i?e[t+1]:0,a=t+2<e.length,c=a?e[t+2]:0,u=s>>2,h=(3&s)<<4|o>>4;let l=(15&o)<<2|c>>6,d=63&c;a||(d=64,i||(l=64)),r.push(n[u],n[h],n[l],n[d])}return r.join("")},encodeString(e,n){return this.HAS_NATIVE_SUPPORT&&!n?btoa(e):this.encodeByteArray(t(e),n)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const s=e[n++];if(s<128)t[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=e[n++];t[r++]=String.fromCharCode((31&s)<<6|63&i)}else if(s>239&&s<365){const i=((7&s)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(i>>10)),t[r++]=String.fromCharCode(56320+(1023&i))}else{const i=e[n++],o=e[n++];t[r++]=String.fromCharCode((15&s)<<12|(63&i)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let t=0;t<e.length;){const i=n[e.charAt(t++)],o=t<e.length?n[e.charAt(t)]:0;++t;const a=t<e.length?n[e.charAt(t)]:64;++t;const c=t<e.length?n[e.charAt(t)]:64;if(++t,null==i||null==o||null==a||null==c)throw new r;const u=i<<2|o>>4;if(s.push(u),64!==a){const e=o<<4&240|a>>2;if(s.push(e),64!==c){const e=a<<6&192|c;s.push(e)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class r extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const s=function(e){return function(e){const r=t(e);return n.encodeByteArray(r,!0)}(e).replace(/\./g,"")},i=function(e){try{return n.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null},o=()=>{try{return function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==e.g)return e.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if("undefined"==typeof process||void 0===process.env)return;const e=process.env.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"==typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(e){return}const t=e&&i(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`)}},a=e=>{var t,n;return null===(n=null===(t=o())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},c=e=>{const t=a(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]},u=()=>{var e;return null===(e=o())||void 0===e?void 0:e.config},h=e=>{var t;return null===(t=o())||void 0===t?void 0:t[`_${e}`]};class l{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}function d(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[s(JSON.stringify({alg:"none",type:"JWT"})),s(JSON.stringify(o)),""].join(".")}function f(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function p(){try{return"object"==typeof indexedDB}catch(e){return!1}}class g extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,g.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,m.prototype.create)}}class m{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},r=`${this.service}/${e}`,s=this.errors[e],i=s?function(e,t){return e.replace(y,((e,n)=>{const r=t[n];return null!=r?String(r):`<${n}?>`}))}(s,n):"Error",o=`${this.serviceName}: ${i} (${r}).`;return new g(r,o,n)}}const y=/\{\$([^}]+)}/g;function v(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const s of n){if(!r.includes(s))return!1;const n=e[s],i=t[s];if(w(n)&&w(i)){if(!v(n,i))return!1}else if(n!==i)return!1}for(const e of r)if(!n.includes(e))return!1;return!0}function w(e){return null!==e&&"object"==typeof e}function _(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function E(e){const t={};return e.replace(/^\?/,"").split("&").forEach((e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}})),t}function b(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}class T{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((()=>{e(this)})).catch((e=>{this.error(e)}))}next(e){this.forEachObserver((t=>{t.next(e)}))}error(e){this.forEachObserver((t=>{t.error(e)})),this.close(e)}complete(){this.forEachObserver((e=>{e.complete()})),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!=typeof e||null===e)return!1;for(const t of["next","error","complete"])if(t in e&&"function"==typeof e[t])return!0;return!1}(e)?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=I),void 0===r.error&&(r.error=I),void 0===r.complete&&(r.complete=I);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(e){}})),this.observers.push(r),s}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}}))}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function I(){}function S(e){return e&&e._delegate?e._delegate:e}class C{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const A="[DEFAULT]";class k{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new l;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(e){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),r=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(e){if(r)return null;throw e}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:A})}catch(e){}for(const[e,t]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch(e){}}}}clearInstance(e=A){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(e=A){return this.instances.has(e)}getOptions(e=A){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[e,t]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(e)&&t.resolve(r);return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),s=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;s.add(e),this.onInitCallbacks.set(r,s);const i=this.instances.get(r);return i&&e(i,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const r of n)try{r(e,t)}catch(e){}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(r=e,r===A?void 0:r),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch(e){}var r;return n||null}normalizeInstanceIdentifier(e=A){return this.component?this.component.multipleInstances?e:A:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class R{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new k(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const N=[];var D,O;(O=D||(D={}))[O.DEBUG=0]="DEBUG",O[O.VERBOSE=1]="VERBOSE",O[O.INFO=2]="INFO",O[O.WARN=3]="WARN",O[O.ERROR=4]="ERROR",O[O.SILENT=5]="SILENT";const P={debug:D.DEBUG,verbose:D.VERBOSE,info:D.INFO,warn:D.WARN,error:D.ERROR,silent:D.SILENT},L=D.INFO,x={[D.DEBUG]:"log",[D.VERBOSE]:"log",[D.INFO]:"info",[D.WARN]:"warn",[D.ERROR]:"error"},M=(e,t,...n)=>{if(t<e.logLevel)return;const r=(new Date).toISOString(),s=x[t];if(!s)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[s](`[${r}]  ${e.name}:`,...n)};class U{constructor(e){this.name=e,this._logLevel=L,this._logHandler=M,this._userLogHandler=null,N.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in D))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?P[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,D.DEBUG,...e),this._logHandler(this,D.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,D.VERBOSE,...e),this._logHandler(this,D.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,D.INFO,...e),this._logHandler(this,D.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,D.WARN,...e),this._logHandler(this,D.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,D.ERROR,...e),this._logHandler(this,D.ERROR,...e)}}const F=(e,t)=>t.some((t=>e instanceof t));let V,B;const j=new WeakMap,q=new WeakMap,$=new WeakMap,z=new WeakMap,K=new WeakMap;let H={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return q.get(e);if("objectStoreNames"===t)return e.objectStoreNames||$.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return W(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function G(e){return"function"==typeof e?(t=e)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(B||(B=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(Q(this),e),W(j.get(this))}:function(...e){return W(t.apply(Q(this),e))}:function(e,...n){const r=t.call(Q(this),e,...n);return $.set(r,e.sort?e.sort():[e]),W(r)}:(e instanceof IDBTransaction&&function(e){if(q.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",s),e.removeEventListener("error",i),e.removeEventListener("abort",i)},s=()=>{t(),r()},i=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",s),e.addEventListener("error",i),e.addEventListener("abort",i)}));q.set(e,t)}(e),F(e,V||(V=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,H):e);var t}function W(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",s),e.removeEventListener("error",i)},s=()=>{t(W(e.result)),r()},i=()=>{n(e.error),r()};e.addEventListener("success",s),e.addEventListener("error",i)}));return t.then((t=>{t instanceof IDBCursor&&j.set(t,e)})).catch((()=>{})),K.set(t,e),t}(e);if(z.has(e))return z.get(e);const t=G(e);return t!==e&&(z.set(e,t),K.set(t,e)),t}const Q=e=>K.get(e),J=["get","getKey","getAll","getAllKeys","count"],X=["put","add","delete","clear"],Y=new Map;function Z(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(Y.get(t))return Y.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,s=X.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!s&&!J.includes(n))return;const i=async function(e,...t){const i=this.transaction(e,s?"readwrite":"readonly");let o=i.store;return r&&(o=o.index(t.shift())),(await Promise.all([o[n](...t),s&&i.done]))[0]};return Y.set(t,i),i}var ee;ee=H,H={...ee,get:(e,t,n)=>Z(e,t)||ee.get(e,t,n),has:(e,t)=>!!Z(e,t)||ee.has(e,t)};class te{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null})).filter((e=>e)).join(" ")}}const ne="@firebase/app",re="0.9.29",se=new U("@firebase/app"),ie="[DEFAULT]",oe={[ne]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},ae=new Map,ce=new Map;function ue(e,t){try{e.container.addComponent(t)}catch(n){se.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function he(e){const t=e.name;if(ce.has(t))return se.debug(`There were multiple attempts to register component ${t}.`),!1;ce.set(t,e);for(const t of ae.values())ue(t,e);return!0}function le(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}const de=new m("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class fe{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new C("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw de.create("app-deleted",{appName:this._name})}}const pe="10.9.0";function ge(e,t={}){let n=e;"object"!=typeof t&&(t={name:t});const r=Object.assign({name:ie,automaticDataCollectionEnabled:!1},t),s=r.name;if("string"!=typeof s||!s)throw de.create("bad-app-name",{appName:String(s)});if(n||(n=u()),!n)throw de.create("no-options");const i=ae.get(s);if(i){if(v(n,i.options)&&v(r,i.config))return i;throw de.create("duplicate-app",{appName:s})}const o=new R(s);for(const e of ce.values())o.addComponent(e);const a=new fe(n,r,o);return ae.set(s,a),a}function me(e=ie){const t=ae.get(e);if(!t&&e===ie&&u())return ge();if(!t)throw de.create("no-app",{appName:e});return t}function ye(e,t,n){var r;let s=null!==(r=oe[e])&&void 0!==r?r:e;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=t.match(/\s|\//);if(i||o){const e=[`Unable to register library "${s}" with version "${t}":`];return i&&e.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&e.push("and"),o&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void se.warn(e.join(" "))}he(new C(`${s}-version`,(()=>({library:s,version:t})),"VERSION"))}const ve="firebase-heartbeat-database",we=1,_e="firebase-heartbeat-store";let Ee=null;function be(){return Ee||(Ee=function(e,t,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(e,t),a=W(o);return r&&o.addEventListener("upgradeneeded",(e=>{r(W(o.result),e.oldVersion,e.newVersion,W(o.transaction),e)})),n&&o.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),a.then((e=>{i&&e.addEventListener("close",(()=>i())),s&&e.addEventListener("versionchange",(e=>s(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),a}(ve,we,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(_e)}catch(e){console.warn(e)}}}).catch((e=>{throw de.create("idb-open",{originalErrorMessage:e.message})}))),Ee}async function Te(e,t){try{const n=(await be()).transaction(_e,"readwrite"),r=n.objectStore(_e);await r.put(t,Ie(e)),await n.done}catch(e){if(e instanceof g)se.warn(e.message);else{const t=de.create("idb-set",{originalErrorMessage:null==e?void 0:e.message});se.warn(t.message)}}}function Ie(e){return`${e.name}!${e.options.appId}`}class Se{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Ae(t),this._heartbeatsCachePromise=this._storage.read().then((e=>(this._heartbeatsCache=e,e)))}async triggerHeartbeat(){var e,t;const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=Ce();if((null!=(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||(this._heartbeatsCache=await this._heartbeatsCachePromise,null!=(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)))&&this._heartbeatsCache.lastSentHeartbeatDate!==r&&!this._heartbeatsCache.heartbeats.some((e=>e.date===r)))return this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var e;if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=Ce(),{heartbeatsToSend:n,unsentEntries:r}=function(e,t=1024){const n=[];let r=e.slice();for(const s of e){const e=n.find((e=>e.agent===s.agent));if(e){if(e.dates.push(s.date),ke(n)>t){e.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),ke(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),i=s(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}}function Ce(){return(new Date).toISOString().substring(0,10)}class Ae{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!p()&&new Promise(((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var e;t((null===(e=s.error)||void 0===e?void 0:e.message)||"")}}catch(e){t(e)}})).then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await be()).transaction(_e),n=await t.objectStore(_e).get(Ie(e));return await t.done,n}catch(e){if(e instanceof g)se.warn(e.message);else{const t=de.create("idb-get",{originalErrorMessage:null==e?void 0:e.message});se.warn(t.message)}}}(this.app);return(null==e?void 0:e.heartbeats)?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return Te(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return Te(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function ke(e){return s(JSON.stringify({version:2,heartbeats:e})).length}function Re(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(e);s<r.length;s++)t.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(n[r[s]]=e[r[s]])}return n}he(new C("platform-logger",(e=>new te(e)),"PRIVATE")),he(new C("heartbeat",(e=>new Se(e)),"PRIVATE")),ye(ne,re,""),ye(ne,re,"esm2017"),ye("fire-js",""),ye("firebase","10.9.0","app"),Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;const Ne=function(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},De=new m("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Oe=new U("@firebase/auth");function Pe(e,...t){Oe.logLevel<=D.ERROR&&Oe.error(`Auth (${pe}): ${e}`,...t)}function Le(e,...t){throw Me(e,...t)}function xe(e,...t){return Me(e,...t)}function Me(e,...t){if("string"!=typeof e){const n=t[0],r=[...t.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(n,...r)}return De.create(e,...t)}function Ue(e,t,...n){if(!e)throw Me(t,...n)}function Fe(e){const t="INTERNAL ASSERTION FAILED: "+e;throw Pe(t),new Error(t)}function Ve(e,t){e||Fe(t)}function Be(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function je(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}function qe(){return!("undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&("http:"===je()||"https:"===je()||function(){const e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}()||"connection"in navigator))||navigator.onLine}class $e{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ve(t>e,"Short delay should be less than long delay!"),this.isMobile="undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(f())||"object"==typeof navigator&&"ReactNative"===navigator.product}get(){return qe()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function ze(e,t){Ve(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}class Ke{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:"undefined"!=typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!=typeof fetch?fetch:void Fe("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:"undefined"!=typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!=typeof Headers?Headers:void Fe("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:"undefined"!=typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!=typeof Response?Response:void Fe("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const He={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},Ge=new $e(3e4,6e4);function We(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function Qe(e,t,n,r,s={}){return Je(e,s,(async()=>{let s={},i={};r&&("GET"===t?i=r:s={body:JSON.stringify(r)});const o=_(Object.assign({key:e.config.apiKey},i)).slice(1),a=await e._getAdditionalHeaders();return a["Content-Type"]="application/json",e.languageCode&&(a["X-Firebase-Locale"]=e.languageCode),Ke.fetch()(Ye(e,e.config.apiHost,n,o),Object.assign({method:t,headers:a,referrerPolicy:"no-referrer"},s))}))}async function Je(e,t,n){e._canInitEmulator=!1;const r=Object.assign(Object.assign({},He),t);try{const t=new et(e),s=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const i=await s.json();if("needConfirmation"in i)throw tt(e,"account-exists-with-different-credential",i);if(s.ok&&!("errorMessage"in i))return i;{const t=s.ok?i.errorMessage:i.error.message,[n,o]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw tt(e,"credential-already-in-use",i);if("EMAIL_EXISTS"===n)throw tt(e,"email-already-in-use",i);if("USER_DISABLED"===n)throw tt(e,"user-disabled",i);const a=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw function(e,t,n){const r=Object.assign(Object.assign({},Ne()),{[t]:n});return new m("auth","Firebase",r).create(t,{appName:e.name})}(e,a,o);Le(e,a)}}catch(t){if(t instanceof g)throw t;Le(e,"network-request-failed",{message:String(t)})}}async function Xe(e,t,n,r,s={}){const i=await Qe(e,t,n,r,s);return"mfaPendingCredential"in i&&Le(e,"multi-factor-auth-required",{_serverResponse:i}),i}function Ye(e,t,n,r){const s=`${t}${n}?${r}`;return e.config.emulator?ze(e.config,s):`${e.config.apiScheme}://${s}`}function Ze(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class et{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise(((e,t)=>{this.timer=setTimeout((()=>t(xe(this.auth,"network-request-failed"))),Ge.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function tt(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=xe(e,t,r);return s.customData._tokenResponse=n,s}function nt(e){return void 0!==e&&void 0!==e.enterprise}class rt{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return Ze(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}}function st(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(e){}}function it(e){return 1e3*Number(e)}function ot(e){const[t,n,r]=e.split(".");if(void 0===t||void 0===n||void 0===r)return Pe("JWT malformed, contained fewer than 3 sections"),null;try{const e=i(n);return e?JSON.parse(e):(Pe("Failed to decode base64 JWT payload"),null)}catch(e){return Pe("Caught error parsing JWT payload as JSON",null==e?void 0:e.toString()),null}}async function at(e,t,n=!1){if(n)return t;try{return await t}catch(t){throw t instanceof g&&function({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}(t)&&e.auth.currentUser===e&&await e.auth.signOut(),t}}class ct{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout((async()=>{await this.iteration()}),t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===(null==e?void 0:e.code)&&this.schedule(!0))}this.schedule()}}class ut{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=st(this.lastLoginAt),this.creationTime=st(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function ht(e){var t;const n=e.auth,r=await e.getIdToken(),s=await at(e,async function(e,t){return Qe(e,"POST","/v1/accounts:lookup",t)}(n,{idToken:r}));Ue(null==s?void 0:s.users.length,n,"internal-error");const i=s.users[0];e._notifyReloadListener(i);const o=(null===(t=i.providerUserInfo)||void 0===t?void 0:t.length)?i.providerUserInfo.map((e=>{var{providerId:t}=e,n=Re(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})):[],a=(c=e.providerData,u=o,[...c.filter((e=>!u.some((t=>t.providerId===e.providerId)))),...u]);var c,u;const h=e.isAnonymous,l=!(e.email&&i.passwordHash||(null==a?void 0:a.length)),d=!!h&&l,f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new ut(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(e,f)}class lt{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ue(e.idToken,"internal-error"),Ue(void 0!==e.idToken,"internal-error"),Ue(void 0!==e.refreshToken,"internal-error");const t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):function(e){const t=ot(e);return Ue(t,"internal-error"),Ue(void 0!==t.exp,"internal-error"),Ue(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}async getToken(e,t=!1){return Ue(!this.accessToken||this.refreshToken,e,"user-token-expired"),t||!this.accessToken||this.isExpired?this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:s}=await async function(e,t){const n=await Je(e,{},(async()=>{const n=_({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:s}=e.config,i=Ye(e,r,"/v1/token",`key=${s}`),o=await e._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",Ke.fetch()(i,{method:"POST",headers:o,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,r,Number(s))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:s}=t,i=new lt;return n&&(Ue("string"==typeof n,"internal-error",{appName:e}),i.refreshToken=n),r&&(Ue("string"==typeof r,"internal-error",{appName:e}),i.accessToken=r),s&&(Ue("number"==typeof s,"internal-error",{appName:e}),i.expirationTime=s),i}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new lt,this.toJSON())}_performRefresh(){return Fe("not implemented")}}function dt(e,t){Ue("string"==typeof e||void 0===e,"internal-error",{appName:t})}class ft{constructor(e){var{uid:t,auth:n,stsTokenManager:r}=e,s=Re(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new ct(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new ut(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await at(this,this.stsTokenManager.getToken(this.auth,e));return Ue(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e,t=!1){const n=S(e),r=await n.getIdToken(t),s=ot(r);Ue(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i="object"==typeof s.firebase?s.firebase:void 0,o=null==i?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:st(it(s.auth_time)),issuedAtTime:st(it(s.iat)),expirationTime:st(it(s.exp)),signInProvider:o||null,signInSecondFactor:(null==i?void 0:i.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=S(e);await ht(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(Ue(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((e=>Object.assign({},e))),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new ft(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Ue(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await ht(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await at(this,async function(e,t){return Qe(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((e=>Object.assign({},e))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,s,i,o,a,c,u;const h=null!==(n=t.displayName)&&void 0!==n?n:void 0,l=null!==(r=t.email)&&void 0!==r?r:void 0,d=null!==(s=t.phoneNumber)&&void 0!==s?s:void 0,f=null!==(i=t.photoURL)&&void 0!==i?i:void 0,p=null!==(o=t.tenantId)&&void 0!==o?o:void 0,g=null!==(a=t._redirectEventId)&&void 0!==a?a:void 0,m=null!==(c=t.createdAt)&&void 0!==c?c:void 0,y=null!==(u=t.lastLoginAt)&&void 0!==u?u:void 0,{uid:v,emailVerified:w,isAnonymous:_,providerData:E,stsTokenManager:b}=t;Ue(v&&b,e,"internal-error");const T=lt.fromJSON(this.name,b);Ue("string"==typeof v,e,"internal-error"),dt(h,e.name),dt(l,e.name),Ue("boolean"==typeof w,e,"internal-error"),Ue("boolean"==typeof _,e,"internal-error"),dt(d,e.name),dt(f,e.name),dt(p,e.name),dt(g,e.name),dt(m,e.name),dt(y,e.name);const I=new ft({uid:v,auth:e,email:l,emailVerified:w,displayName:h,isAnonymous:_,photoURL:f,phoneNumber:d,tenantId:p,stsTokenManager:T,createdAt:m,lastLoginAt:y});return E&&Array.isArray(E)&&(I.providerData=E.map((e=>Object.assign({},e)))),g&&(I._redirectEventId=g),I}static async _fromIdTokenResponse(e,t,n=!1){const r=new lt;r.updateFromServerResponse(t);const s=new ft({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await ht(s),s}}const pt=new Map;function gt(e){Ve(e instanceof Function,"Expected a class definition");let t=pt.get(e);return t?(Ve(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,pt.set(e,t),t)}class mt{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}mt.type="NONE";const yt=mt;function vt(e,t,n){return`firebase:${e}:${t}:${n}`}class wt{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:s}=this.auth;this.fullUserKey=vt(this.userKey,r.apiKey,s),this.fullPersistenceKey=vt("persistence",r.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?ft._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new wt(gt(yt),e,n);const r=(await Promise.all(t.map((async e=>{if(await e._isAvailable())return e})))).filter((e=>e));let s=r[0]||gt(yt);const i=vt(n,e.config.apiKey,e.name);let o=null;for(const n of t)try{const t=await n._get(i);if(t){const r=ft._fromJSON(e,t);n!==s&&(o=r),s=n;break}}catch(e){}const a=r.filter((e=>e._shouldAllowMigration));return s._shouldAllowMigration&&a.length?(s=a[0],o&&await s._set(i,o.toJSON()),await Promise.all(t.map((async e=>{if(e!==s)try{await e._remove(i)}catch(e){}}))),new wt(s,e,n)):new wt(s,e,n)}}function _t(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(It(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(Et(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(Ct(t))return"Blackberry";if(At(t))return"Webos";if(bt(t))return"Safari";if((t.includes("chrome/")||Tt(t))&&!t.includes("edge/"))return"Chrome";if(St(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function Et(e=f()){return/firefox\//i.test(e)}function bt(e=f()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function Tt(e=f()){return/crios\//i.test(e)}function It(e=f()){return/iemobile/i.test(e)}function St(e=f()){return/android/i.test(e)}function Ct(e=f()){return/blackberry/i.test(e)}function At(e=f()){return/webos/i.test(e)}function kt(e=f()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function Rt(e=f()){return kt(e)||St(e)||At(e)||Ct(e)||/windows phone/i.test(e)||It(e)}function Nt(e,t=[]){let n;switch(e){case"Browser":n=_t(f());break;case"Worker":n=`${_t(f())}-${e}`;break;default:n=e}const r=t.length?t.join(","):"FirebaseCore-web";return`${n}/JsCore/${pe}/${r}`}class Dt{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise(((n,r)=>{try{n(e(t))}catch(e){r(e)}}));n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(e){t.reverse();for(const e of t)try{e()}catch(e){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null==e?void 0:e.message})}}}class Ot{constructor(e){var t,n,r,s;const i=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(t=i.minPasswordLength)&&void 0!==t?t:6,i.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=i.maxPasswordLength),void 0!==i.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=i.containsLowercaseCharacter),void 0!==i.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=i.containsUppercaseCharacter),void 0!==i.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=i.containsNumericCharacter),void 0!==i.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=i.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(r=null===(n=e.allowedNonAlphanumericCharacters)||void 0===n?void 0:n.join(""))&&void 0!==r?r:"",this.forceUpgradeOnSignin=null!==(s=e.forceUpgradeOnSignin)&&void 0!==s&&s,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,r,s,i,o;const a={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,a),this.validatePasswordCharacterOptions(e,a),a.isValid&&(a.isValid=null===(t=a.meetsMinPasswordLength)||void 0===t||t),a.isValid&&(a.isValid=null===(n=a.meetsMaxPasswordLength)||void 0===n||n),a.isValid&&(a.isValid=null===(r=a.containsLowercaseLetter)||void 0===r||r),a.isValid&&(a.isValid=null===(s=a.containsUppercaseLetter)||void 0===s||s),a.isValid&&(a.isValid=null===(i=a.containsNumericCharacter)||void 0===i||i),a.isValid&&(a.isValid=null===(o=a.containsNonAlphanumericCharacter)||void 0===o||o),a}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let r=0;r<e.length;r++)n=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,r,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}class Pt{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new xt(this),this.idTokenSubscription=new xt(this),this.beforeStateQueue=new Dt(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=De,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=gt(t)),this._initializationPromise=this.queue((async()=>{var n,r;if(!this._deleted&&(this.persistenceManager=await wt.create(this,e),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(e){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(r=this.currentUser)||void 0===r?void 0:r.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUser(e){var t;const n=await this.assertedPersistence.getCurrentUser();let r=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,i=null==r?void 0:r._redirectEventId,o=await this.tryRedirectSignIn(e);n&&n!==i||!(null==o?void 0:o.user)||(r=o.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(e){r=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(e)))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Ue(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(e){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await ht(e)}catch(e){if("auth/network-request-failed"!==(null==e?void 0:e.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const t=e?S(e):null;return t&&Ue(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Ue(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue((async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()}))}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue((async()=>{await this.assertedPersistence.setPersistence(gt(e))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await async function(e,t={}){return Qe(e,"GET","/v2/passwordPolicy",We(e,t))}(this),t=new Ot(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new m("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise(((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged((()=>{n(),e()}),t)}}))}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await async function(e,t){return Qe(e,"POST","/v2/accounts:revokeToken",We(e,t))}(this,t)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&gt(e)||this._popupRedirectResolver;Ue(t,this,"argument-error"),this.redirectPersistenceManager=await wt.create(this,[gt(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(e)))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const s="function"==typeof t?t:t.next.bind(t);let i=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ue(o,this,"internal-error"),o.then((()=>{i||s(this.currentUser)})),"function"==typeof t){const s=e.addObserver(t,n,r);return()=>{i=!0,s()}}{const n=e.addObserver(t);return()=>{i=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ue(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Nt(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null==t?void 0:t.error)&&function(e,...t){Oe.logLevel<=D.WARN&&Oe.warn(`Auth (${pe}): ${e}`,...t)}(`Error while retrieving App Check token: ${t.error}`),null==t?void 0:t.token}}function Lt(e){return S(e)}class xt{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){const n=new T(e,void 0);return n.subscribe.bind(n)}((e=>this.observer=e))}get next(){return Ue(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Mt={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Ut(e){return Mt.loadJS(e)}function Ft(e){return`__${e}${Math.floor(1e6*Math.random())}`}class Vt{constructor(e){this.type="recaptcha-enterprise",this.auth=Lt(e)}async verify(e="verify",t=!1){function n(t,n,r){const s=window.grecaptcha;nt(s)?s.enterprise.ready((()=>{s.enterprise.execute(t,{action:e}).then((e=>{n(e)})).catch((()=>{n("NO_RECAPTCHA")}))})):r(Error("No reCAPTCHA enterprise script loaded."))}return new Promise(((e,r)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise((async(t,n)=>{(async function(e,t){return Qe(e,"GET","/v2/recaptchaConfig",We(e,t))})(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then((r=>{if(void 0!==r.recaptchaKey){const n=new rt(r);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))})).catch((e=>{n(e)}))}))})(this.auth).then((s=>{if(!t&&nt(window.grecaptcha))n(s,e,r);else{if("undefined"==typeof window)return void r(new Error("RecaptchaVerifier is only supported in browser"));let t=Mt.recaptchaEnterpriseScript;0!==t.length&&(t+=s),Ut(t).then((()=>{n(s,e,r)})).catch((e=>{r(e)}))}})).catch((e=>{r(e)}))}))}}async function Bt(e,t,n,r=!1){const s=new Vt(e);let i;try{i=await s.verify(n)}catch(e){i=await s.verify(n,!0)}const o=Object.assign({},t);return r?Object.assign(o,{captchaResp:i}):Object.assign(o,{captchaResponse:i}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function jt(e,t,n,r){var s;if(null===(s=e._getRecaptchaConfig())||void 0===s?void 0:s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await Bt(e,t,n,"getOobCode"===n);return r(e,s)}return r(e,t).catch((async s=>{if("auth/missing-recaptcha-token"===s.code){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const s=await Bt(e,t,n,"getOobCode"===n);return r(e,s)}return Promise.reject(s)}))}function qt(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function $t(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class zt{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Fe("not implemented")}_getIdTokenResponse(e){return Fe("not implemented")}_linkToIdToken(e,t){return Fe("not implemented")}_getReauthenticationResolver(e){return Fe("not implemented")}}async function Kt(e,t){return Qe(e,"POST","/v1/accounts:signUp",t)}async function Ht(e,t){return Xe(e,"POST","/v1/accounts:signInWithPassword",We(e,t))}class Gt extends zt{constructor(e,t,n,r=null){super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new Gt(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new Gt(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e;if((null==t?void 0:t.email)&&(null==t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return jt(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",Ht);case"emailLink":return async function(e,t){return Xe(e,"POST","/v1/accounts:signInWithEmailLink",We(e,t))}(e,{email:this._email,oobCode:this._password});default:Le(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return jt(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Kt);case"emailLink":return async function(e,t){return Xe(e,"POST","/v1/accounts:signInWithEmailLink",We(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:Le(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Wt(e,t){return Xe(e,"POST","/v1/accounts:signInWithIdp",We(e,t))}class Qt extends zt{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Qt(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Le("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,s=Re(t,["providerId","signInMethod"]);if(!n||!r)return null;const i=new Qt(n,r);return i.idToken=s.idToken||void 0,i.accessToken=s.accessToken||void 0,i.secret=s.secret,i.nonce=s.nonce,i.pendingToken=s.pendingToken||null,i}_getIdTokenResponse(e){return Wt(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Wt(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Wt(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=_(t)}return e}}const Jt={USER_NOT_FOUND:"user-not-found"};class Xt extends zt{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new Xt({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new Xt({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return Xe(e,"POST","/v1/accounts:signInWithPhoneNumber",We(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await Xe(e,"POST","/v1/accounts:signInWithPhoneNumber",We(e,t));if(n.temporaryProof)throw tt(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return Xe(e,"POST","/v1/accounts:signInWithPhoneNumber",We(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),Jt)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"==typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:s}=e;return n||t||r||s?new Xt({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:s}):null}}class Yt{constructor(e){var t,n,r,s,i,o;const a=E(b(e)),c=null!==(t=a.apiKey)&&void 0!==t?t:null,u=null!==(n=a.oobCode)&&void 0!==n?n:null,h=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(r=a.mode)&&void 0!==r?r:null);Ue(c&&u&&h,"argument-error"),this.apiKey=c,this.operation=h,this.code=u,this.continueUrl=null!==(s=a.continueUrl)&&void 0!==s?s:null,this.languageCode=null!==(i=a.languageCode)&&void 0!==i?i:null,this.tenantId=null!==(o=a.tenantId)&&void 0!==o?o:null}static parseLink(e){const t=function(e){const t=E(b(e)).link,n=t?E(b(t)).deep_link_id:null,r=E(b(e)).deep_link_id;return(r?E(b(r)).link:null)||r||n||t||e}(e);try{return new Yt(t)}catch(e){return null}}}class Zt{constructor(){this.providerId=Zt.PROVIDER_ID}static credential(e,t){return Gt._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=Yt.parseLink(t);return Ue(n,"argument-error"),Gt._fromEmailAndCode(e,n.code,n.tenantId)}}Zt.PROVIDER_ID="password",Zt.EMAIL_PASSWORD_SIGN_IN_METHOD="password",Zt.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class en{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class tn extends en{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class nn extends tn{constructor(){super("facebook.com")}static credential(e){return Qt._fromParams({providerId:nn.PROVIDER_ID,signInMethod:nn.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return nn.credentialFromTaggedObject(e)}static credentialFromError(e){return nn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return nn.credential(e.oauthAccessToken)}catch(e){return null}}}nn.FACEBOOK_SIGN_IN_METHOD="facebook.com",nn.PROVIDER_ID="facebook.com";class rn extends tn{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Qt._fromParams({providerId:rn.PROVIDER_ID,signInMethod:rn.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return rn.credentialFromTaggedObject(e)}static credentialFromError(e){return rn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return rn.credential(t,n)}catch(e){return null}}}rn.GOOGLE_SIGN_IN_METHOD="google.com",rn.PROVIDER_ID="google.com";class sn extends tn{constructor(){super("github.com")}static credential(e){return Qt._fromParams({providerId:sn.PROVIDER_ID,signInMethod:sn.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return sn.credentialFromTaggedObject(e)}static credentialFromError(e){return sn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return sn.credential(e.oauthAccessToken)}catch(e){return null}}}sn.GITHUB_SIGN_IN_METHOD="github.com",sn.PROVIDER_ID="github.com";class on extends tn{constructor(){super("twitter.com")}static credential(e,t){return Qt._fromParams({providerId:on.PROVIDER_ID,signInMethod:on.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return on.credentialFromTaggedObject(e)}static credentialFromError(e){return on.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return on.credential(t,n)}catch(e){return null}}}async function an(e,t){return Xe(e,"POST","/v1/accounts:signUp",We(e,t))}on.TWITTER_SIGN_IN_METHOD="twitter.com",on.PROVIDER_ID="twitter.com";class cn{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,r=!1){const s=await ft._fromIdTokenResponse(e,n,r),i=un(n);return new cn({user:s,providerId:i,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=un(n);return new cn({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function un(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class hn extends g{constructor(e,t,n,r){var s;super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,hn.prototype),this.customData={appName:e.name,tenantId:null!==(s=e.tenantId)&&void 0!==s?s:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new hn(e,t,n,r)}}function ln(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw hn._fromErrorAndOperation(e,n,t,r);throw n}))}async function dn(e,t,n=!1){const r="signIn",s=await ln(e,r,t),i=await cn._fromIdTokenResponse(e,r,s);return n||await e._updateCurrentUser(i.user),i}async function fn(e){const t=Lt(e);t._getPasswordPolicyInternal()&&await t._updatePasswordPolicy()}new WeakMap;const pn="__sak";class gn{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(pn,"1"),this.storage.removeItem(pn),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class mn extends gn{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const e=f();return bt(e)||kt(e)}()&&function(){try{return!(!window||window===window.top)}catch(e){return!1}}(),this.fallbackToPolling=Rt(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e,t=!1){if(!e.key)return void this.forAllChangedKeys(((e,t,n)=>{this.notifyListeners(e,n)}));const n=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const r=this.storage.getItem(n);if(e.newValue!==r)null!==e.newValue?this.storage.setItem(n,e.newValue):this.storage.removeItem(n);else if(this.localCache[n]===e.newValue&&!t)return}const r=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},s=this.storage.getItem(n);!function(){const e=f();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()||10!==document.documentMode||s===e.newValue||e.newValue===e.oldValue?r():setTimeout(r,10)}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}mn.type="LOCAL";const yn=mn;class vn extends gn{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(e,t){}_removeListener(e,t){}}vn.type="SESSION";const wn=vn;class _n{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find((t=>t.isListeningto(e)));if(t)return t;const n=new _n(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:s}=t.data,i=this.handlersMap[r];if(!(null==i?void 0:i.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const o=Array.from(i).map((async e=>e(t.origin,s))),a=await function(e){return Promise.all(e.map((async e=>{try{return{fulfilled:!0,value:await e}}catch(e){return{fulfilled:!1,reason:e}}})))}(o);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function En(e="",t=10){let n="";for(let e=0;e<t;e++)n+=Math.floor(10*Math.random());return e+n}_n.receivers=[];class bn{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const r="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let s,i;return new Promise(((o,a)=>{const c=En("",20);r.port1.start();const u=setTimeout((()=>{a(new Error("unsupported_event"))}),n);i={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===c)switch(t.data.status){case"ack":clearTimeout(u),s=setTimeout((()=>{a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(s),o(t.data.response);break;default:clearTimeout(u),clearTimeout(s),a(new Error("invalid_response"))}}},this.handlers.add(i),r.port1.addEventListener("message",i.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[r.port2])})).finally((()=>{i&&this.removeMessageHandler(i)}))}}function Tn(){return window}function In(){return void 0!==Tn().WorkerGlobalScope&&"function"==typeof Tn().importScripts}const Sn="firebaseLocalStorageDb",Cn="firebaseLocalStorage",An="fbase_key";class kn{constructor(e){this.request=e}toPromise(){return new Promise(((e,t)=>{this.request.addEventListener("success",(()=>{e(this.request.result)})),this.request.addEventListener("error",(()=>{t(this.request.error)}))}))}}function Rn(e,t){return e.transaction([Cn],t?"readwrite":"readonly").objectStore(Cn)}function Nn(){const e=indexedDB.open(Sn,1);return new Promise(((t,n)=>{e.addEventListener("error",(()=>{n(e.error)})),e.addEventListener("upgradeneeded",(()=>{const t=e.result;try{t.createObjectStore(Cn,{keyPath:An})}catch(e){n(e)}})),e.addEventListener("success",(async()=>{const n=e.result;n.objectStoreNames.contains(Cn)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(Sn);return new kn(e).toPromise()}(),t(await Nn()))}))}))}async function Dn(e,t,n){const r=Rn(e,!0).put({[An]:t,value:n});return new kn(r).toPromise()}function On(e,t){const n=Rn(e,!0).delete(t);return new kn(n).toPromise()}class Pn{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await Nn()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(e){if(t++>3)throw e;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return In()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=_n._getInstance(In()?self:null),this.receiver._subscribe("keyChanged",(async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)}))),this.receiver._subscribe("ping",(async(e,t)=>["keyChanged"]))}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new bn(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){var t;if(this.sender&&this.activeServiceWorker&&((null===(t=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===t?void 0:t.controller)||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Nn();return await Dn(e,pn,"1"),await On(e,pn),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite((async()=>(await this._withRetries((n=>Dn(n,e,t))),this.localCache[e]=t,this.notifyServiceWorker(e))))}async _get(e){const t=await this._withRetries((t=>async function(e,t){const n=Rn(e,!1).get(t),r=await new kn(n).toPromise();return void 0===r?null:r.value}(t,e)));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite((async()=>(await this._withRetries((t=>On(t,e))),delete this.localCache[e],this.notifyServiceWorker(e))))}async _poll(){const e=await this._withRetries((e=>{const t=Rn(e,!1).getAll();return new kn(t).toPromise()}));if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;if(0!==e.length)for(const{fbase_key:r,value:s}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(s)&&(this.notifyListeners(r,s),t.push(r));for(const e of Object.keys(this.localCache))this.localCache[e]&&!n.has(e)&&(this.notifyListeners(e,null),t.push(e));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}Pn.type="LOCAL";const Ln=Pn;Ft("rcb"),new $e(3e4,6e4);class xn{constructor(e){this.providerId=xn.PROVIDER_ID,this.auth=Lt(e)}verifyPhoneNumber(e,t){return async function(e,t,n){var r;const s=await n.verify();try{let i;if(Ue("string"==typeof s,e,"argument-error"),Ue("recaptcha"===n.type,e,"argument-error"),i="string"==typeof t?{phoneNumber:t}:t,"session"in i){const t=i.session;if("phoneNumber"in i){Ue("enroll"===t.type,e,"internal-error");const n=await function(e,t){return Qe(e,"POST","/v2/accounts/mfaEnrollment:start",We(e,t))}(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:i.phoneNumber,recaptchaToken:s}});return n.phoneSessionInfo.sessionInfo}{Ue("signin"===t.type,e,"internal-error");const n=(null===(r=i.multiFactorHint)||void 0===r?void 0:r.uid)||i.multiFactorUid;Ue(n,e,"missing-multi-factor-info");const o=await function(e,t){return Qe(e,"POST","/v2/accounts/mfaSignIn:start",We(e,t))}(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:s}});return o.phoneResponseInfo.sessionInfo}}{const{sessionInfo:t}=await async function(e,t){return Qe(e,"POST","/v1/accounts:sendVerificationCode",We(e,t))}(e,{phoneNumber:i.phoneNumber,recaptchaToken:s});return t}}finally{n._reset()}}(this.auth,e,S(t))}static credential(e,t){return Xt._fromVerification(e,t)}static credentialFromResult(e){const t=e;return xn.credentialFromTaggedObject(t)}static credentialFromError(e){return xn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:n}=e;return t&&n?Xt._fromTokenResponse(t,n):null}}xn.PROVIDER_ID="phone",xn.PHONE_SIGN_IN_METHOD="phone";class Mn extends zt{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Wt(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Wt(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Wt(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Un(e){return dn(e.auth,new Mn(e),e.bypassAuthState)}function Fn(e){const{auth:t,user:n}=e;return Ue(n,t,"internal-error"),async function(e,t,n=!1){const{auth:r}=e,s="reauthenticate";try{const i=await at(e,ln(r,s,t,e),n);Ue(i.idToken,r,"internal-error");const o=ot(i.idToken);Ue(o,r,"internal-error");const{sub:a}=o;return Ue(e.uid===a,r,"user-mismatch"),cn._forOperation(e,s,i)}catch(e){throw"auth/user-not-found"===(null==e?void 0:e.code)&&Le(r,"user-mismatch"),e}}(n,new Mn(e),e.bypassAuthState)}async function Vn(e){const{auth:t,user:n}=e;return Ue(n,t,"internal-error"),async function(e,t,n=!1){const r=await at(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return cn._forOperation(e,"link",r)}(n,new Mn(e),e.bypassAuthState)}class Bn{constructor(e,t,n,r,s=!1){this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(e){this.reject(e)}}))}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:s,error:i,type:o}=e;if(i)return void this.reject(i);const a={auth:this.auth,requestUri:t,sessionId:n,tenantId:s||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(e){this.reject(e)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Un;case"linkViaPopup":case"linkViaRedirect":return Vn;case"reauthViaPopup":case"reauthViaRedirect":return Fn;default:Le(this.auth,"internal-error")}}resolve(e){Ve(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ve(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const jn=new $e(2e3,1e4);class qn extends Bn{constructor(e,t,n,r,s){super(e,t,r,s),this.provider=n,this.authWindow=null,this.pollId=null,qn.currentPopupAction&&qn.currentPopupAction.cancel(),qn.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ue(e,this.auth,"internal-error"),e}async onExecution(){Ve(1===this.filter.length,"Popup operations only handle one event");const e=En();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch((e=>{this.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(e=>{e||this.reject(xe(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(xe(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,qn.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(xe(this.auth,"popup-closed-by-user"))}),8e3):this.pollId=window.setTimeout(e,jn.get())};e()}}qn.currentPopupAction=null;const $n="pendingRedirect",zn=new Map;class Kn extends Bn{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=zn.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=function(e){return vt($n,e.config.apiKey,e.name)}(t),r=function(e){return gt(e._redirectPersistence)}(e);if(!await r._isAvailable())return!1;const s="true"===await r._get(n);return await r._remove(n),s}(this.resolver,this.auth),n=t?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}zn.set(this.auth._key(),e)}return this.bypassAuthState||zn.set(this.auth._key(),(()=>Promise.resolve(null))),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function Hn(e,t){zn.set(e._key(),t)}async function Gn(e,t,n=!1){const r=Lt(e),s=function(e,t){return t?gt(t):(Ue(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}(r,t),i=new Kn(r,s,n),o=await i.execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,t)),o}class Wn{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Jn(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!Jn(e)){const r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(xe(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Qn(e))}saveEventToCache(e){this.cachedEventUids.add(Qn(e)),this.lastProcessedEventTime=Date.now()}}function Qn(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((e=>e)).join("-")}function Jn({type:e,error:t}){return"unknown"===e&&"auth/no-auth-event"===(null==t?void 0:t.code)}const Xn=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Yn=/^https?/;function Zn(e){const t=Be(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const s=new URL(e);return""===s.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&s.hostname===r}if(!Yn.test(n))return!1;if(Xn.test(e))return r===e;const s=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}const er=new $e(3e4,6e4);function tr(){const e=Tn().___jsl;if(null==e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let t=0;t<e.CP.length;t++)e.CP[t]=null}function nr(e){return new Promise(((t,n)=>{var r,s,i;function o(){tr(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{tr(),n(xe(e,"network-request-failed"))},timeout:er.get()})}if(null===(s=null===(r=Tn().gapi)||void 0===r?void 0:r.iframes)||void 0===s?void 0:s.Iframe)t(gapi.iframes.getContext());else{if(!(null===(i=Tn().gapi)||void 0===i?void 0:i.load)){const t=Ft("iframefcb");return Tn()[t]=()=>{gapi.load?o():n(xe(e,"network-request-failed"))},Ut(`${Mt.gapiScript}?onload=${t}`).catch((e=>n(e)))}o()}})).catch((e=>{throw rr=null,e}))}let rr=null;const sr=new $e(5e3,15e3),ir="__/auth/iframe",or="emulator/auth/iframe",ar={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},cr=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function ur(e){const t=e.config;Ue(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?ze(t,or):`https://${e.config.authDomain}/${ir}`,r={apiKey:t.apiKey,appName:e.name,v:pe},s=cr.get(e.config.apiHost);s&&(r.eid=s);const i=e._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${_(r).slice(1)}`}const hr={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class lr{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}const dr=encodeURIComponent("fac");async function fr(e,t,n,r,s,i){Ue(e.config.authDomain,e,"auth-domain-config-required"),Ue(e.config.apiKey,e,"invalid-api-key");const o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:pe,eventId:s};if(t instanceof en){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(i||{}))o[e]=t}if(t instanceof tn){const e=t.getScopes().filter((e=>""!==e));e.length>0&&(o.scopes=e.join(","))}e.tenantId&&(o.tid=e.tenantId);const a=o;for(const e of Object.keys(a))void 0===a[e]&&delete a[e];const c=await e._getAppCheckToken(),u=c?`#${dr}=${encodeURIComponent(c)}`:"";return`${function({config:e}){return e.emulator?ze(e,"emulator/auth/handler"):`https://${e.authDomain}/__/auth/handler`}(e)}?${_(a).slice(1)}${u}`}const pr="webStorageSupport",gr=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=wn,this._completeRedirectFn=Gn,this._overrideRedirectResult=Hn}async _openPopup(e,t,n,r){var s;return Ve(null===(s=this.eventManagers[e._key()])||void 0===s?void 0:s.manager,"_initialize() not called before _openPopup()"),function(e,t,n,r=500,s=600){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const c=Object.assign(Object.assign({},hr),{width:r.toString(),height:s.toString(),top:i,left:o}),u=f().toLowerCase();n&&(a=Tt(u)?"_blank":n),Et(u)&&(t=t||"http://localhost",c.scrollbars="yes");const h=Object.entries(c).reduce(((e,[t,n])=>`${e}${t}=${n},`),"");if(function(e=f()){var t;return kt(e)&&!!(null===(t=window.navigator)||void 0===t?void 0:t.standalone)}(u)&&"_self"!==a)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",a),new lr(null);const l=window.open(t||"",a,h);Ue(l,e,"popup-blocked");try{l.focus()}catch(e){}return new lr(l)}(e,await fr(e,t,n,Be(),r),En())}async _openRedirect(e,t,n,r){return await this._originValidation(e),s=await fr(e,t,n,Be(),r),Tn().location.href=s,new Promise((()=>{}));var s}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(Ve(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch((()=>{delete this.eventManagers[t]})),n}async initAndGetManager(e){const t=await async function(e){const t=await function(e){return rr=rr||nr(e),rr}(e),n=Tn().gapi;return Ue(n,e,"internal-error"),t.open({where:document.body,url:ur(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:ar,dontclear:!0},(t=>new Promise((async(n,r)=>{await t.restyle({setHideOnLeave:!1});const s=xe(e,"network-request-failed"),i=Tn().setTimeout((()=>{r(s)}),sr.get());function o(){Tn().clearTimeout(i),n(t)}t.ping(o).then(o,(()=>{r(s)}))}))))}(e),n=new Wn(e);return t.register("authEvent",(t=>(Ue(null==t?void 0:t.authEvent,e,"invalid-auth-event"),{status:n.onEvent(t.authEvent)?"ACK":"ERROR"})),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(pr,{type:pr},(n=>{var r;const s=null===(r=null==n?void 0:n[0])||void 0===r?void 0:r[pr];void 0!==s&&t(!!s),Le(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=async function(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e,t={}){return Qe(e,"GET","/v1/projects",t)}(e);for(const e of t)try{if(Zn(e))return}catch(e){}Le(e,"unauthorized-domain")}(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Rt()||bt()||kt()}};var mr="@firebase/auth",yr="1.6.2";class vr{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged((t=>{e((null==t?void 0:t.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Ue(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const wr=h("authIdTokenMaxAge")||300;let _r=null;var Er;!function(e){Mt=e}({loadJS:e=>new Promise(((t,n)=>{const r=document.createElement("script");var s,i;r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=xe("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",(null!==(i=null===(s=document.getElementsByTagName("head"))||void 0===s?void 0:s[0])&&void 0!==i?i:document).appendChild(r)})),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="}),Er="Browser",he(new C("auth",((e,{options:t})=>{const n=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:i,authDomain:o}=n.options;Ue(i&&!i.includes(":"),"invalid-api-key",{appName:n.name});const a={apiKey:i,authDomain:o,clientPlatform:Er,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Nt(Er)},c=new Pt(n,r,s,a);return function(e,t){const n=(null==t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(gt);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null==t?void 0:t.popupRedirectResolver)}(c,t),c}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((e,t,n)=>{e.getProvider("auth-internal").initialize()}))),he(new C("auth-internal",(e=>(e=>new vr(e))(Lt(e.getProvider("auth").getImmediate()))),"PRIVATE").setInstantiationMode("EXPLICIT")),ye(mr,yr,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(Er)),ye(mr,yr,"esm2017");var br,Tr="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Ir={},Sr=Sr||{},Cr=Tr||self;function Ar(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function kr(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var Rr="closure_uid_"+(1e9*Math.random()>>>0),Nr=0;function Dr(e,t,n){return e.call.apply(e.bind,arguments)}function Or(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function Pr(e,t,n){return(Pr=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Dr:Or).apply(null,arguments)}function Lr(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function xr(e,t){function n(){}n.prototype=t.prototype,e.$=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.ac=function(e,n,r){for(var s=Array(arguments.length-2),i=2;i<arguments.length;i++)s[i-2]=arguments[i];return t.prototype[n].apply(e,s)}}function Mr(){this.s=this.s,this.o=this.o}Mr.prototype.s=!1,Mr.prototype.sa=function(){var e;!this.s&&(this.s=!0,this.N(),0)&&(e=this,Object.prototype.hasOwnProperty.call(e,Rr)&&e[Rr]||(e[Rr]=++Nr))},Mr.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const Ur=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.indexOf(t,0);for(let n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1};function Fr(e){const t=e.length;if(0<t){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function Vr(e,t){for(let t=1;t<arguments.length;t++){const n=arguments[t];if(Ar(n)){const t=e.length||0,r=n.length||0;e.length=t+r;for(let s=0;s<r;s++)e[t+s]=n[s]}else e.push(n)}}function Br(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}Br.prototype.h=function(){this.defaultPrevented=!0};var jr=function(){if(!Cr.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};Cr.addEventListener("test",e,t),Cr.removeEventListener("test",e,t)}catch(e){}return e}();function qr(e){return/^[\s\xa0]*$/.test(e)}function $r(){var e=Cr.navigator;return e&&(e=e.userAgent)?e:""}function zr(e){return-1!=$r().indexOf(e)}function Kr(e){return Kr[" "](e),e}Kr[" "]=function(){};var Hr,Gr,Wr,Qr=zr("Opera"),Jr=zr("Trident")||zr("MSIE"),Xr=zr("Edge"),Yr=Xr||Jr,Zr=zr("Gecko")&&!(-1!=$r().toLowerCase().indexOf("webkit")&&!zr("Edge"))&&!(zr("Trident")||zr("MSIE"))&&!zr("Edge"),es=-1!=$r().toLowerCase().indexOf("webkit")&&!zr("Edge");function ts(){var e=Cr.document;return e?e.documentMode:void 0}e:{var ns="",rs=(Gr=$r(),Zr?/rv:([^\);]+)(\)|;)/.exec(Gr):Xr?/Edge\/([\d\.]+)/.exec(Gr):Jr?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Gr):es?/WebKit\/(\S+)/.exec(Gr):Qr?/(?:Version)[ \/]?(\S+)/.exec(Gr):void 0);if(rs&&(ns=rs?rs[1]:""),Jr){var ss=ts();if(null!=ss&&ss>parseFloat(ns)){Hr=String(ss);break e}}Hr=ns}Cr.document&&Jr?Wr=ts()||parseInt(Hr,10)||void 0:Wr=void 0;var is=Wr;function os(e,t){if(Br.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(Zr){e:{try{Kr(t.nodeName);var s=!0;break e}catch(e){}s=!1}s||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:as[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&os.$.h.call(this)}}xr(os,Br);var as={2:"touch",3:"pen",4:"mouse"};os.prototype.h=function(){os.$.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var cs="closure_listenable_"+(1e6*Math.random()|0),us=0;function hs(e,t,n,r,s){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.la=s,this.key=++us,this.fa=this.ia=!1}function ls(e){e.fa=!0,e.listener=null,e.proxy=null,e.src=null,e.la=null}function ds(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function fs(e){const t={};for(const n in e)t[n]=e[n];return t}const ps="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function gs(e,t){let n,r;for(let t=1;t<arguments.length;t++){for(n in r=arguments[t],r)e[n]=r[n];for(let t=0;t<ps.length;t++)n=ps[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function ms(e){this.src=e,this.g={},this.h=0}function ys(e,t){var n=t.type;if(n in e.g){var r,s=e.g[n],i=Ur(s,t);(r=0<=i)&&Array.prototype.splice.call(s,i,1),r&&(ls(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function vs(e,t,n,r){for(var s=0;s<e.length;++s){var i=e[s];if(!i.fa&&i.listener==t&&i.capture==!!n&&i.la==r)return s}return-1}ms.prototype.add=function(e,t,n,r,s){var i=e.toString();(e=this.g[i])||(e=this.g[i]=[],this.h++);var o=vs(e,t,r,s);return-1<o?(t=e[o],n||(t.ia=!1)):((t=new hs(t,this.src,i,!!r,s)).ia=n,e.push(t)),t};var ws="closure_lm_"+(1e6*Math.random()|0),_s={};function Es(e,t,n,r,s){if(r&&r.once)return Ts(e,t,n,r,s);if(Array.isArray(t)){for(var i=0;i<t.length;i++)Es(e,t[i],n,r,s);return null}return n=Ns(n),e&&e[cs]?e.O(t,n,kr(r)?!!r.capture:!!r,s):bs(e,t,n,!1,r,s)}function bs(e,t,n,r,s,i){if(!t)throw Error("Invalid event type");var o=kr(s)?!!s.capture:!!s,a=ks(e);if(a||(e[ws]=a=new ms(e)),(n=a.add(t,n,r,o,i)).proxy)return n;if(r=function(){const e=As;return function t(n){return e.call(t.src,t.listener,n)}}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)jr||(s=o),void 0===s&&(s=!1),e.addEventListener(t.toString(),r,s);else if(e.attachEvent)e.attachEvent(Cs(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function Ts(e,t,n,r,s){if(Array.isArray(t)){for(var i=0;i<t.length;i++)Ts(e,t[i],n,r,s);return null}return n=Ns(n),e&&e[cs]?e.P(t,n,kr(r)?!!r.capture:!!r,s):bs(e,t,n,!0,r,s)}function Is(e,t,n,r,s){if(Array.isArray(t))for(var i=0;i<t.length;i++)Is(e,t[i],n,r,s);else r=kr(r)?!!r.capture:!!r,n=Ns(n),e&&e[cs]?(e=e.i,(t=String(t).toString())in e.g&&-1<(n=vs(i=e.g[t],n,r,s))&&(ls(i[n]),Array.prototype.splice.call(i,n,1),0==i.length&&(delete e.g[t],e.h--))):e&&(e=ks(e))&&(t=e.g[t.toString()],e=-1,t&&(e=vs(t,n,r,s)),(n=-1<e?t[e]:null)&&Ss(n))}function Ss(e){if("number"!=typeof e&&e&&!e.fa){var t=e.src;if(t&&t[cs])ys(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(Cs(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=ks(t))?(ys(n,e),0==n.h&&(n.src=null,t[ws]=null)):ls(e)}}}function Cs(e){return e in _s?_s[e]:_s[e]="on"+e}function As(e,t){if(e.fa)e=!0;else{t=new os(t,this);var n=e.listener,r=e.la||e.src;e.ia&&Ss(e),e=n.call(r,t)}return e}function ks(e){return(e=e[ws])instanceof ms?e:null}var Rs="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ns(e){return"function"==typeof e?e:(e[Rs]||(e[Rs]=function(t){return e.handleEvent(t)}),e[Rs])}function Ds(){Mr.call(this),this.i=new ms(this),this.S=this,this.J=null}function Os(e,t){var n,r=e.J;if(r)for(n=[];r;r=r.J)n.push(r);if(e=e.S,r=t.type||t,"string"==typeof t)t=new Br(t,e);else if(t instanceof Br)t.target=t.target||e;else{var s=t;gs(t=new Br(r,e),s)}if(s=!0,n)for(var i=n.length-1;0<=i;i--){var o=t.g=n[i];s=Ps(o,r,!0,t)&&s}if(s=Ps(o=t.g=e,r,!0,t)&&s,s=Ps(o,r,!1,t)&&s,n)for(i=0;i<n.length;i++)s=Ps(o=t.g=n[i],r,!1,t)&&s}function Ps(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var s=!0,i=0;i<t.length;++i){var o=t[i];if(o&&!o.fa&&o.capture==n){var a=o.listener,c=o.la||o.src;o.ia&&ys(e.i,o),s=!1!==a.call(c,r)&&s}}return s&&!r.defaultPrevented}xr(Ds,Mr),Ds.prototype[cs]=!0,Ds.prototype.removeEventListener=function(e,t,n,r){Is(this,e,t,n,r)},Ds.prototype.N=function(){if(Ds.$.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)ls(n[r]);delete t.g[e],t.h--}}this.J=null},Ds.prototype.O=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},Ds.prototype.P=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};var Ls=Cr.JSON.stringify;function xs(){var e=qs;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var Ms=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}((()=>new Us),(e=>e.reset()));class Us{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function Fs(e){var t=1;e=e.split(":");const n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function Vs(e){Cr.setTimeout((()=>{throw e}),0)}let Bs,js=!1,qs=new class{constructor(){this.h=this.g=null}add(e,t){const n=Ms.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},$s=()=>{const e=Cr.Promise.resolve(void 0);Bs=()=>{e.then(zs)}};var zs=()=>{for(var e;e=xs();){try{e.h.call(e.g)}catch(e){Vs(e)}var t=Ms;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}js=!1};function Ks(e,t){Ds.call(this),this.h=e||1,this.g=t||Cr,this.j=Pr(this.qb,this),this.l=Date.now()}function Hs(e){e.ga=!1,e.T&&(e.g.clearTimeout(e.T),e.T=null)}function Gs(e,t,n){if("function"==typeof e)n&&(e=Pr(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=Pr(e.handleEvent,e)}return 2147483647<Number(t)?-1:Cr.setTimeout(e,t||0)}function Ws(e){e.g=Gs((()=>{e.g=null,e.i&&(e.i=!1,Ws(e))}),e.j);const t=e.h;e.h=null,e.m.apply(null,t)}xr(Ks,Ds),(br=Ks.prototype).ga=!1,br.T=null,br.qb=function(){if(this.ga){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-e):(this.T&&(this.g.clearTimeout(this.T),this.T=null),Os(this,"tick"),this.ga&&(Hs(this),this.start()))}},br.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},br.N=function(){Ks.$.N.call(this),Hs(this),delete this.g};class Qs extends Mr{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:Ws(this)}N(){super.N(),this.g&&(Cr.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Js(e){Mr.call(this),this.h=e,this.g={}}xr(Js,Mr);var Xs=[];function Ys(e,t,n,r){Array.isArray(n)||(n&&(Xs[0]=n.toString()),n=Xs);for(var s=0;s<n.length;s++){var i=Es(t,n[s],r||e.handleEvent,!1,e.h||e);if(!i)break;e.g[i.key]=i}}function Zs(e){ds(e.g,(function(e,t){this.g.hasOwnProperty(t)&&Ss(e)}),e),e.g={}}function ei(){this.g=!0}function ti(e,t,n,r){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var s=r[1];if(Array.isArray(s)&&!(1>s.length)){var i=s[0];if("noop"!=i&&"stop"!=i&&"close"!=i)for(var o=1;o<s.length;o++)s[o]=""}}}return Ls(n)}catch(e){return t}}(e,n)+(r?" "+r:"")}))}Js.prototype.N=function(){Js.$.N.call(this),Zs(this)},Js.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},ei.prototype.Ea=function(){this.g=!1},ei.prototype.info=function(){};var ni={},ri=null;function si(){return ri=ri||new Ds}function ii(e){Br.call(this,ni.Ta,e)}function oi(e){const t=si();Os(t,new ii(t))}function ai(e,t){Br.call(this,ni.STAT_EVENT,e),this.stat=t}function ci(e){const t=si();Os(t,new ai(t,e))}function ui(e,t){Br.call(this,ni.Ua,e),this.size=t}function hi(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return Cr.setTimeout((function(){e()}),t)}ni.Ta="serverreachability",xr(ii,Br),ni.STAT_EVENT="statevent",xr(ai,Br),ni.Ua="timingevent",xr(ui,Br);var li={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},di={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function fi(){}function pi(e){return e.h||(e.h=e.i())}function gi(){}fi.prototype.h=null;var mi,yi={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function vi(){Br.call(this,"d")}function wi(){Br.call(this,"c")}function _i(){}function Ei(e,t,n,r){this.l=e,this.j=t,this.m=n,this.W=r||1,this.U=new Js(this),this.P=Ti,e=Yr?125:void 0,this.V=new Ks(e),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new bi}function bi(){this.i=null,this.g="",this.h=!1}xr(vi,Br),xr(wi,Br),xr(_i,fi),_i.prototype.g=function(){return new XMLHttpRequest},_i.prototype.i=function(){return{}},mi=new _i;var Ti=45e3,Ii={},Si={};function Ci(e,t,n){e.L=1,e.A=Ki(Bi(t)),e.u=n,e.S=!0,Ai(e,null)}function Ai(e,t){e.G=Date.now(),Di(e),e.B=Bi(e.A);var n=e.B,r=e.W;Array.isArray(r)||(r=[String(r)]),so(n.i,"t",r),e.o=0,n=e.l.J,e.h=new bi,e.g=sa(e.l,n?t:null,!e.u),0<e.O&&(e.M=new Qs(Pr(e.Pa,e,e.g),e.O)),Ys(e.U,e.g,"readystatechange",e.nb),t=e.I?fs(e.I):{},e.u?(e.v||(e.v="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ha(e.B,e.v,e.u,t)):(e.v="GET",e.g.ha(e.B,e.v,null,t)),oi(),function(e,t,n,r,s,i){e.info((function(){if(e.g)if(i)for(var o="",a=i.split("&"),c=0;c<a.length;c++){var u=a[c].split("=");if(1<u.length){var h=u[0];u=u[1];var l=h.split("_");o=2<=l.length&&"type"==l[1]?o+(h+"=")+u+"&":o+(h+"=redacted&")}}else o=null;else o=i;return"XMLHTTP REQ ("+r+") [attempt "+s+"]: "+t+"\n"+n+"\n"+o}))}(e.j,e.v,e.B,e.m,e.W,e.u)}function ki(e){return!!e.g&&"GET"==e.v&&2!=e.L&&e.l.Ha}function Ri(e,t,n){let r,s=!0;for(;!e.J&&e.o<n.length;){if(r=Ni(e,n),r==Si){4==t&&(e.s=4,ci(14),s=!1),ti(e.j,e.m,null,"[Incomplete Response]");break}if(r==Ii){e.s=4,ci(15),ti(e.j,e.m,n,"[Invalid Chunk]"),s=!1;break}ti(e.j,e.m,r,null),Mi(e,r)}ki(e)&&0!=e.o&&(e.h.g=e.h.g.slice(e.o),e.o=0),4!=t||0!=n.length||e.h.h||(e.s=1,ci(16),s=!1),e.i=e.i&&s,s?0<n.length&&!e.ba&&(e.ba=!0,(t=e.l).g==e&&t.ca&&!t.M&&(t.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),Jo(t),t.M=!0,ci(11))):(ti(e.j,e.m,n,"[Invalid Chunked Response]"),xi(e),Li(e))}function Ni(e,t){var n=e.o,r=t.indexOf("\n",n);return-1==r?Si:(n=Number(t.substring(n,r)),isNaN(n)?Ii:(r+=1)+n>t.length?Si:(t=t.slice(r,r+n),e.o=r+n,t))}function Di(e){e.Y=Date.now()+e.P,Oi(e,e.P)}function Oi(e,t){if(null!=e.C)throw Error("WatchDog timer not null");e.C=hi(Pr(e.lb,e),t)}function Pi(e){e.C&&(Cr.clearTimeout(e.C),e.C=null)}function Li(e){0==e.l.H||e.J||Zo(e.l,e)}function xi(e){Pi(e);var t=e.M;t&&"function"==typeof t.sa&&t.sa(),e.M=null,Hs(e.V),Zs(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.sa())}function Mi(e,t){try{var n=e.l;if(0!=n.H&&(n.g==e||ho(n.i,e)))if(!e.K&&ho(n.i,e)&&3==n.H){try{var r=n.Ja.g.parse(t)}catch(e){r=null}if(Array.isArray(r)&&3==r.length){var s=r;if(0==s[0]){e:if(!n.u){if(n.g){if(!(n.g.G+3e3<e.G))break e;Yo(n),qo(n)}Qo(n),ci(18)}}else n.Fa=s[1],0<n.Fa-n.V&&37500>s[2]&&n.G&&0==n.A&&!n.v&&(n.v=hi(Pr(n.ib,n),6e3));if(1>=uo(n.i)&&n.oa){try{n.oa()}catch(e){}n.oa=void 0}}else ta(n,11)}else if((e.K||n.g==e)&&Yo(n),!qr(t))for(s=n.Ja.g.parse(t),t=0;t<s.length;t++){let u=s[t];if(n.V=u[0],u=u[1],2==n.H)if("c"==u[0]){n.K=u[1],n.pa=u[2];const t=u[3];null!=t&&(n.ra=t,n.l.info("VER="+n.ra));const s=u[4];null!=s&&(n.Ga=s,n.l.info("SVER="+n.Ga));const h=u[5];null!=h&&"number"==typeof h&&0<h&&(r=1.5*h,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;const l=e.g;if(l){const e=l.g?l.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var i=r.i;i.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(i.j=i.l,i.g=new Set,i.h&&(lo(i,i.h),i.h=null))}if(r.F){const e=l.g?l.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.Da=e,zi(r.I,r.F,e))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-e.G,n.l.info("Handshake RTT: "+n.S+"ms"));var o=e;if((r=n).wa=ra(r,r.J?r.pa:null,r.Y),o.K){fo(r.i,o);var a=o,c=r.L;c&&a.setTimeout(c),a.C&&(Pi(a),Di(a)),r.g=o}else Wo(r);0<n.j.length&&zo(n)}else"stop"!=u[0]&&"close"!=u[0]||ta(n,7);else 3==n.H&&("stop"==u[0]||"close"==u[0]?"stop"==u[0]?ta(n,7):jo(n):"noop"!=u[0]&&n.h&&n.h.Aa(u),n.A=0)}oi()}catch(e){}}function Ui(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(Ar(e)||"string"==typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.ta&&"function"==typeof e.ta)return e.ta();if(!e.Z||"function"!=typeof e.Z){if("undefined"!=typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!=typeof Set&&e instanceof Set)){if(Ar(e)||"string"==typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const r in e)t[n++]=r;return t}}}(e),r=function(e){if(e.Z&&"function"==typeof e.Z)return e.Z();if("undefined"!=typeof Map&&e instanceof Map||"undefined"!=typeof Set&&e instanceof Set)return Array.from(e.values());if("string"==typeof e)return e.split("");if(Ar(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),s=r.length,i=0;i<s;i++)t.call(void 0,r[i],n&&n[i],e)}(br=Ei.prototype).setTimeout=function(e){this.P=e},br.nb=function(e){e=e.target;const t=this.M;t&&3==xo(e)?t.l():this.Pa(e)},br.Pa=function(e){try{if(e==this.g)e:{const h=xo(this.g);var t=this.g.Ia();if(this.g.da(),!(3>h)&&(3!=h||Yr||this.g&&(this.h.h||this.g.ja()||Mo(this.g)))){this.J||4!=h||7==t||oi(),Pi(this);var n=this.g.da();this.ca=n;t:if(ki(this)){var r=Mo(this.g);e="";var s=r.length,i=4==xo(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){xi(this),Li(this);var o="";break t}this.h.i=new Cr.TextDecoder}for(t=0;t<s;t++)this.h.h=!0,e+=this.h.i.decode(r[t],{stream:i&&t==s-1});r.length=0,this.h.g+=e,this.o=0,o=this.h.g}else o=this.g.ja();if(this.i=200==n,function(e,t,n,r,s,i,o){e.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+s+"]: "+t+"\n"+n+"\n"+i+" "+o}))}(this.j,this.v,this.B,this.m,this.W,h,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!qr(a)){var u=a;break t}}u=null}if(!(n=u)){this.i=!1,this.s=3,ci(12),xi(this),Li(this);break e}ti(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Mi(this,n)}this.S?(Ri(this,h,o),Yr&&this.i&&3==h&&(Ys(this.U,this.V,"tick",this.mb),this.V.start())):(ti(this.j,this.m,o,null),Mi(this,o)),4==h&&xi(this),this.i&&!this.J&&(4==h?Zo(this.l,this):(this.i=!1,Di(this)))}else(function(e){const t={};e=(e.g&&2<=xo(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<e.length;r++){if(qr(e[r]))continue;var n=Fs(e[r]);const s=n[0];if("string"!=typeof(n=n[1]))continue;n=n.trim();const i=t[s]||[];t[s]=i,i.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,(function(e){return e.join(", ")}))})(this.g),400==n&&0<o.indexOf("Unknown SID")?(this.s=3,ci(12)):(this.s=0,ci(13)),xi(this),Li(this)}}}catch(e){}},br.mb=function(){if(this.g){var e=xo(this.g),t=this.g.ja();this.o<t.length&&(Pi(this),Ri(this,e,t),this.i&&4!=e&&Di(this))}},br.cancel=function(){this.J=!0,xi(this)},br.lb=function(){this.C=null;const e=Date.now();0<=e-this.Y?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.j,this.B),2!=this.L&&(oi(),ci(17)),xi(this),this.s=2,Li(this)):Oi(this,this.Y-e)};var Fi=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Vi(e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,e instanceof Vi){this.h=e.h,ji(this,e.j),this.s=e.s,this.g=e.g,qi(this,e.m),this.l=e.l;var t=e.i,n=new eo;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),$i(this,n),this.o=e.o}else e&&(t=String(e).match(Fi))?(this.h=!1,ji(this,t[1]||"",!0),this.s=Hi(t[2]||""),this.g=Hi(t[3]||"",!0),qi(this,t[4]),this.l=Hi(t[5]||"",!0),$i(this,t[6]||"",!0),this.o=Hi(t[7]||"")):(this.h=!1,this.i=new eo(null,this.h))}function Bi(e){return new Vi(e)}function ji(e,t,n){e.j=n?Hi(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function qi(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function $i(e,t,n){t instanceof eo?(e.i=t,function(e,t){t&&!e.j&&(to(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(no(this,t),so(this,n,e))}),e)),e.j=t}(e.i,e.h)):(n||(t=Gi(t,Yi)),e.i=new eo(t,e.h))}function zi(e,t,n){e.i.set(t,n)}function Ki(e){return zi(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function Hi(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function Gi(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,Wi),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function Wi(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}Vi.prototype.toString=function(){var e=[],t=this.j;t&&e.push(Gi(t,Qi,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(Gi(t,Qi,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(Gi(n,"/"==n.charAt(0)?Xi:Ji,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.o)&&e.push("#",Gi(n,Zi)),e.join("")};var Qi=/[#\/\?@]/g,Ji=/[#\?:]/g,Xi=/[#\?]/g,Yi=/[#\?@]/g,Zi=/#/g;function eo(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function to(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),s=null;if(0<=r){var i=e[n].substring(0,r);s=e[n].substring(r+1)}else i=e[n];t(i,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function no(e,t){to(e),t=io(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function ro(e,t){return to(e),t=io(e,t),e.g.has(t)}function so(e,t,n){no(e,t),0<n.length&&(e.i=null,e.g.set(io(e,t),Fr(n)),e.h+=n.length)}function io(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function oo(e){this.l=e||ao,e=Cr.PerformanceNavigationTiming?0<(e=Cr.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):!!(Cr.g&&Cr.g.Ka&&Cr.g.Ka()&&Cr.g.Ka().dc),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(br=eo.prototype).add=function(e,t){to(this),this.i=null,e=io(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},br.forEach=function(e,t){to(this),this.g.forEach((function(n,r){n.forEach((function(n){e.call(t,n,r,this)}),this)}),this)},br.ta=function(){to(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let r=0;r<t.length;r++){const s=e[r];for(let e=0;e<s.length;e++)n.push(t[r])}return n},br.Z=function(e){to(this);let t=[];if("string"==typeof e)ro(this,e)&&(t=t.concat(this.g.get(io(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},br.set=function(e,t){return to(this),this.i=null,ro(this,e=io(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},br.get=function(e,t){return e&&0<(e=this.Z(e)).length?String(e[0]):t},br.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var r=t[n];const i=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var s=i;""!==o[r]&&(s+="="+encodeURIComponent(String(o[r]))),e.push(s)}}return this.i=e.join("&")};var ao=10;function co(e){return!!e.h||!!e.g&&e.g.size>=e.j}function uo(e){return e.h?1:e.g?e.g.size:0}function ho(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function lo(e,t){e.g?e.g.add(t):e.h=t}function fo(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function po(e){if(null!=e.h)return e.i.concat(e.h.F);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.F);return t}return Fr(e.i)}oo.prototype.cancel=function(){if(this.i=po(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var go=class{stringify(e){return Cr.JSON.stringify(e,void 0)}parse(e){return Cr.JSON.parse(e,void 0)}};function mo(){this.g=new go}function yo(e,t,n){const r=n||"";try{Ui(e,(function(e,n){let s=e;kr(e)&&(s=Ls(e)),t.push(r+n+"="+encodeURIComponent(s))}))}catch(e){throw t.push(r+"type="+encodeURIComponent("_badmap")),e}}function vo(e,t,n,r,s){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,s(r)}catch(e){}}function wo(e){this.l=e.ec||null,this.j=e.ob||!1}function _o(e,t){Ds.call(this),this.F=e,this.u=t,this.m=void 0,this.readyState=Eo,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}xr(wo,fi),wo.prototype.g=function(){return new _o(this.l,this.j)},wo.prototype.i=function(e){return function(){return e}}({}),xr(_o,Ds);var Eo=0;function bo(e){e.j.read().then(e.Xa.bind(e)).catch(e.ka.bind(e))}function To(e){e.readyState=4,e.l=null,e.j=null,e.A=null,Io(e)}function Io(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(br=_o.prototype).open=function(e,t){if(this.readyState!=Eo)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,Io(this)},br.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.F||Cr).fetch(new Request(this.B,t)).then(this.$a.bind(this),this.ka.bind(this))},br.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,To(this)),this.readyState=Eo},br.$a=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Io(this)),this.g&&(this.readyState=3,Io(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(void 0!==Cr.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;bo(this)}else e.text().then(this.Za.bind(this),this.ka.bind(this))},br.Xa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?To(this):Io(this),3==this.readyState&&bo(this)}},br.Za=function(e){this.g&&(this.response=this.responseText=e,To(this))},br.Ya=function(e){this.g&&(this.response=e,To(this))},br.ka=function(){this.g&&To(this)},br.setRequestHeader=function(e,t){this.v.append(e,t)},br.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},br.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(_o.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var So=Cr.JSON.parse;function Co(e){Ds.call(this),this.headers=new Map,this.u=e||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=Ao,this.L=this.M=!1}xr(Co,Ds);var Ao="",ko=/^https?$/i,Ro=["POST","PUT"];function No(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,Do(e),Po(e)}function Do(e){e.F||(e.F=!0,Os(e,"complete"),Os(e,"error"))}function Oo(e){if(e.h&&void 0!==Sr&&(!e.C[1]||4!=xo(e)||2!=e.da()))if(e.v&&4==xo(e))Gs(e.La,0,e);else if(Os(e,"readystatechange"),4==xo(e)){e.h=!1;try{const o=e.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var r;if(r=0===o){var s=String(e.I).match(Fi)[1]||null;!s&&Cr.self&&Cr.self.location&&(s=Cr.self.location.protocol.slice(0,-1)),r=!ko.test(s?s.toLowerCase():"")}n=r}if(n)Os(e,"complete"),Os(e,"success");else{e.m=6;try{var i=2<xo(e)?e.g.statusText:""}catch(e){i=""}e.j=i+" ["+e.da()+"]",Do(e)}}finally{Po(e)}}}function Po(e,t){if(e.g){Lo(e);const n=e.g,r=e.C[0]?()=>{}:null;e.g=null,e.C=null,t||Os(e,"ready");try{n.onreadystatechange=r}catch(e){}}}function Lo(e){e.g&&e.L&&(e.g.ontimeout=null),e.A&&(Cr.clearTimeout(e.A),e.A=null)}function xo(e){return e.g?e.g.readyState:0}function Mo(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.K){case Ao:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(e){return null}}function Uo(e){let t="";return ds(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}function Fo(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=Uo(n),"string"==typeof e?null!=n&&encodeURIComponent(String(n)):zi(e,t,n))}function Vo(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Bo(e){this.Ga=0,this.j=[],this.l=new ei,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Vo("failFast",!1,e),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Vo("baseRetryDelayMs",5e3,e),this.hb=Vo("retryDelaySeedMs",1e4,e),this.eb=Vo("forwardChannelMaxRetries",2,e),this.xa=Vo("forwardChannelRequestTimeoutMs",2e4,e),this.va=e&&e.xmlHttpFactory||void 0,this.Ha=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.i=new oo(e&&e.concurrentRequestLimit),this.Ja=new mo,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=e&&e.bc||!1,e&&e.Ea&&this.l.Ea(),e&&e.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&e&&e.detectBufferingProxy||!1,this.qa=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.qa=e.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function jo(e){if($o(e),3==e.H){var t=e.W++,n=Bi(e.I);if(zi(n,"SID",e.K),zi(n,"RID",t),zi(n,"TYPE","terminate"),Ho(e,n),(t=new Ei(e,e.l,t)).L=2,t.A=Ki(Bi(n)),n=!1,Cr.navigator&&Cr.navigator.sendBeacon)try{n=Cr.navigator.sendBeacon(t.A.toString(),"")}catch(e){}!n&&Cr.Image&&((new Image).src=t.A,n=!0),n||(t.g=sa(t.l,null),t.g.ha(t.A)),t.G=Date.now(),Di(t)}na(e)}function qo(e){e.g&&(Jo(e),e.g.cancel(),e.g=null)}function $o(e){qo(e),e.u&&(Cr.clearTimeout(e.u),e.u=null),Yo(e),e.i.cancel(),e.m&&("number"==typeof e.m&&Cr.clearTimeout(e.m),e.m=null)}function zo(e){if(!co(e.i)&&!e.m){e.m=!0;var t=e.Na;Bs||$s(),js||(Bs(),js=!0),qs.add(t,e),e.C=0}}function Ko(e,t){var n;n=t?t.m:e.W++;const r=Bi(e.I);zi(r,"SID",e.K),zi(r,"RID",n),zi(r,"AID",e.V),Ho(e,r),e.o&&e.s&&Fo(r,e.o,e.s),n=new Ei(e,e.l,n,e.C+1),null===e.o&&(n.I=e.s),t&&(e.j=t.F.concat(e.j)),t=Go(e,n,1e3),n.setTimeout(Math.round(.5*e.xa)+Math.round(.5*e.xa*Math.random())),lo(e.i,n),Ci(n,r,t)}function Ho(e,t){e.na&&ds(e.na,(function(e,n){zi(t,n,e)})),e.h&&Ui({},(function(e,n){zi(t,n,e)}))}function Go(e,t,n){n=Math.min(e.j.length,n);var r=e.h?Pr(e.h.Va,e.h,e):null;e:{var s=e.j;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=s[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let i=!0;for(let o=0;o<n;o++){let n=s[o].g;const a=s[o].map;if(n-=t,0>n)t=Math.max(0,s[o].g-100),i=!1;else try{yo(a,e,"req"+n+"_")}catch(e){r&&r(a)}}if(i){r=e.join("&");break e}}}return e=e.j.splice(0,n),t.F=e,r}function Wo(e){if(!e.g&&!e.u){e.ba=1;var t=e.Ma;Bs||$s(),js||(Bs(),js=!0),qs.add(t,e),e.A=0}}function Qo(e){return!(e.g||e.u||3<=e.A||(e.ba++,e.u=hi(Pr(e.Ma,e),ea(e,e.A)),e.A++,0))}function Jo(e){null!=e.B&&(Cr.clearTimeout(e.B),e.B=null)}function Xo(e){e.g=new Ei(e,e.l,"rpc",e.ba),null===e.o&&(e.g.I=e.s),e.g.O=0;var t=Bi(e.wa);zi(t,"RID","rpc"),zi(t,"SID",e.K),zi(t,"AID",e.V),zi(t,"CI",e.G?"0":"1"),!e.G&&e.qa&&zi(t,"TO",e.qa),zi(t,"TYPE","xmlhttp"),Ho(e,t),e.o&&e.s&&Fo(t,e.o,e.s),e.L&&e.g.setTimeout(e.L);var n=e.g;e=e.pa,n.L=1,n.A=Ki(Bi(t)),n.u=null,n.S=!0,Ai(n,e)}function Yo(e){null!=e.v&&(Cr.clearTimeout(e.v),e.v=null)}function Zo(e,t){var n=null;if(e.g==t){Yo(e),Jo(e),e.g=null;var r=2}else{if(!ho(e.i,t))return;n=t.F,fo(e.i,t),r=1}if(0!=e.H)if(t.i)if(1==r){n=t.u?t.u.length:0,t=Date.now()-t.G;var s=e.C;Os(r=si(),new ui(r,n)),zo(e)}else Wo(e);else if(3==(s=t.s)||0==s&&0<t.ca||!(1==r&&function(e,t){return!(uo(e.i)>=e.i.j-(e.m?1:0)||(e.m?(e.j=t.F.concat(e.j),0):1==e.H||2==e.H||e.C>=(e.cb?0:e.eb)||(e.m=hi(Pr(e.Na,e,t),ea(e,e.C)),e.C++,0)))}(e,t)||2==r&&Qo(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),s){case 1:ta(e,5);break;case 4:ta(e,10);break;case 3:ta(e,6);break;default:ta(e,2)}}function ea(e,t){let n=e.ab+Math.floor(Math.random()*e.hb);return e.isActive()||(n*=2),n*t}function ta(e,t){if(e.l.info("Error code "+t),2==t){var n=null;e.h&&(n=null);var r=Pr(e.pb,e);n||(n=new Vi("//www.google.com/images/cleardot.gif"),Cr.location&&"http"==Cr.location.protocol||ji(n,"https"),Ki(n)),function(e,t){const n=new ei;if(Cr.Image){const r=new Image;r.onload=Lr(vo,n,r,"TestLoadImage: loaded",!0,t),r.onerror=Lr(vo,n,r,"TestLoadImage: error",!1,t),r.onabort=Lr(vo,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=Lr(vo,n,r,"TestLoadImage: timeout",!1,t),Cr.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=e}else t(!1)}(n.toString(),r)}else ci(2);e.H=0,e.h&&e.h.za(t),na(e),$o(e)}function na(e){if(e.H=0,e.ma=[],e.h){const t=po(e.i);0==t.length&&0==e.j.length||(Vr(e.ma,t),Vr(e.ma,e.j),e.i.i.length=0,Fr(e.j),e.j.length=0),e.h.ya()}}function ra(e,t,n){var r=n instanceof Vi?Bi(n):new Vi(n);if(""!=r.g)t&&(r.g=t+"."+r.g),qi(r,r.m);else{var s=Cr.location;r=s.protocol,t=t?t+"."+s.hostname:s.hostname,s=+s.port;var i=new Vi(null);r&&ji(i,r),t&&(i.g=t),s&&qi(i,s),n&&(i.l=n),r=i}return n=e.F,t=e.Da,n&&t&&zi(r,n,t),zi(r,"VER",e.ra),Ho(e,r),r}function sa(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Ha&&!e.va?new Co(new wo({ob:n})):new Co(e.va)).Oa(e.J),t}function ia(){}function oa(){if(Jr&&!(10<=Number(is)))throw Error("Environmental error: no available transport.")}function aa(e,t){Ds.call(this),this.g=new Bo(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.Ca&&(e?e["X-WebChannel-Client-Profile"]=t.Ca:e={"X-WebChannel-Client-Profile":t.Ca}),this.g.U=e,(e=t&&t.cc)&&!qr(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!qr(t)&&(this.g.F=t,null!==(e=this.h)&&t in e&&t in(e=this.h)&&delete e[t]),this.j=new ha(this)}function ca(e){vi.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function ua(){wi.call(this),this.status=1}function ha(e){this.g=e}function la(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function da(e,t,n){n||(n=0);var r=Array(16);if("string"==typeof t)for(var s=0;16>s;++s)r[s]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(s=0;16>s;++s)r[s]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],s=e.g[2];var i=e.g[3],o=t+(i^n&(s^i))+r[0]+3614090360&4294967295;o=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=n+(o<<7&4294967295|o>>>25))+((o=i+(s^t&(n^s))+r[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=s+(n^i&(t^n))+r[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^s&(i^t))+r[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=t+(i^n&(s^i))+r[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=i+(s^t&(n^s))+r[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=s+(n^i&(t^n))+r[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^s&(i^t))+r[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=t+(i^n&(s^i))+r[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=i+(s^t&(n^s))+r[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=s+(n^i&(t^n))+r[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^s&(i^t))+r[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=t+(i^n&(s^i))+r[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=i+(s^t&(n^s))+r[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=s+(n^i&(t^n))+r[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^s&(i^t))+r[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^i&(n^s))+r[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=i+(n^s&(t^n))+r[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=s+(t^n&(i^t))+r[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=n+(i^t&(s^i))+r[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=t+(s^i&(n^s))+r[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=i+(n^s&(t^n))+r[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=s+(t^n&(i^t))+r[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=n+(i^t&(s^i))+r[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=t+(s^i&(n^s))+r[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=i+(n^s&(t^n))+r[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=s+(t^n&(i^t))+r[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=n+(i^t&(s^i))+r[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=t+(s^i&(n^s))+r[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=i+(n^s&(t^n))+r[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=s+(t^n&(i^t))+r[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=n+(i^t&(s^i))+r[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=t+(n^s^i)+r[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=i+(t^n^s)+r[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=s+(i^t^n)+r[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=n+(s^i^t)+r[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^s^i)+r[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=i+(t^n^s)+r[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=s+(i^t^n)+r[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=n+(s^i^t)+r[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^s^i)+r[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=i+(t^n^s)+r[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=s+(i^t^n)+r[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=n+(s^i^t)+r[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^s^i)+r[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=i+(t^n^s)+r[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=s+(i^t^n)+r[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=n+(s^i^t)+r[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=t+(s^(n|~i))+r[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=i+(n^(t|~s))+r[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=s+(t^(i|~n))+r[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=n+(i^(s|~t))+r[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=t+(s^(n|~i))+r[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=i+(n^(t|~s))+r[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=s+(t^(i|~n))+r[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=n+(i^(s|~t))+r[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=t+(s^(n|~i))+r[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=i+(n^(t|~s))+r[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=s+(t^(i|~n))+r[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=n+(i^(s|~t))+r[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((i=(t=n+((o=t+(s^(n|~i))+r[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=i+(n^(t|~s))+r[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((s=i+((o=s+(t^(i|~n))+r[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(s+(o<<21&4294967295|o>>>11))&4294967295,e.g[2]=e.g[2]+s&4294967295,e.g[3]=e.g[3]+i&4294967295}function fa(e,t){this.h=t;for(var n=[],r=!0,s=e.length-1;0<=s;s--){var i=0|e[s];r&&i==t||(n[s]=i,r=!1)}this.g=n}(br=Co.prototype).Oa=function(e){this.M=e},br.ha=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+e);t=t?t.toUpperCase():"GET",this.I=e,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():mi.g(),this.C=this.u?pi(this.u):pi(mi),this.g.onreadystatechange=Pr(this.La,this);try{this.G=!0,this.g.open(t,String(e),!0),this.G=!1}catch(e){return void No(this,e)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var s in r)n.set(s,r[s]);else{if("function"!=typeof r.keys||"function"!=typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const e of r.keys())n.set(e,r.get(e))}r=Array.from(n.keys()).find((e=>"content-type"==e.toLowerCase())),s=Cr.FormData&&e instanceof Cr.FormData,!(0<=Ur(Ro,t))||r||s||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[e,t]of n)this.g.setRequestHeader(e,t);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{Lo(this),0<this.B&&((this.L=function(e){return Jr&&"number"==typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Pr(this.ua,this)):this.A=Gs(this.ua,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(e){No(this,e)}},br.ua=function(){void 0!==Sr&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Os(this,"timeout"),this.abort(8))},br.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,Os(this,"complete"),Os(this,"abort"),Po(this))},br.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Po(this,!0)),Co.$.N.call(this)},br.La=function(){this.s||(this.G||this.v||this.l?Oo(this):this.kb())},br.kb=function(){Oo(this)},br.isActive=function(){return!!this.g},br.da=function(){try{return 2<xo(this)?this.g.status:-1}catch(e){return-1}},br.ja=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},br.Wa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),So(t)}},br.Ia=function(){return this.m},br.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(br=Bo.prototype).ra=8,br.H=1,br.Na=function(e){if(this.m)if(this.m=null,1==this.H){if(!e){this.W=Math.floor(1e5*Math.random()),e=this.W++;const s=new Ei(this,this.l,e);let i=this.s;if(this.U&&(i?(i=fs(i),gs(i,this.U)):i=this.U),null!==this.o||this.O||(s.I=i,i=null),this.P)e:{for(var t=0,n=0;n<this.j.length;n++){var r=this.j[n];if(void 0===(r="__data__"in r.map&&"string"==typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(t+=r)){t=n;break e}if(4096===t||n===this.j.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=Go(this,s,t),zi(n=Bi(this.I),"RID",e),zi(n,"CVER",22),this.F&&zi(n,"X-HTTP-Session-Id",this.F),Ho(this,n),i&&(this.O?t="headers="+encodeURIComponent(String(Uo(i)))+"&"+t:this.o&&Fo(n,this.o,i)),lo(this.i,s),this.bb&&zi(n,"TYPE","init"),this.P?(zi(n,"$req",t),zi(n,"SID","null"),s.aa=!0,Ci(s,n,null)):Ci(s,n,t),this.H=2}}else 3==this.H&&(e?Ko(this,e):0==this.j.length||co(this.i)||Ko(this))},br.Ma=function(){if(this.u=null,Xo(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var e=2*this.S;this.l.info("BP detection timer enabled: "+e),this.B=hi(Pr(this.jb,this),e)}},br.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,ci(10),qo(this),Xo(this))},br.ib=function(){null!=this.v&&(this.v=null,qo(this),Qo(this),ci(19))},br.pb=function(e){e?(this.l.info("Successfully pinged google.com"),ci(2)):(this.l.info("Failed to ping google.com"),ci(1))},br.isActive=function(){return!!this.h&&this.h.isActive(this)},(br=ia.prototype).Ba=function(){},br.Aa=function(){},br.za=function(){},br.ya=function(){},br.isActive=function(){return!0},br.Va=function(){},oa.prototype.g=function(e,t){return new aa(e,t)},xr(aa,Ds),aa.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var e=this.g,t=this.l,n=this.h||void 0;ci(0),e.Y=t,e.na=n||{},e.G=e.aa,e.I=ra(e,null,e.Y),zo(e)},aa.prototype.close=function(){jo(this.g)},aa.prototype.u=function(e){var t=this.g;if("string"==typeof e){var n={};n.__data__=e,e=n}else this.v&&((n={}).__data__=Ls(e),e=n);t.j.push(new class{constructor(e,t){this.g=e,this.map=t}}(t.fb++,e)),3==t.H&&zo(t)},aa.prototype.N=function(){this.g.h=null,delete this.j,jo(this.g),delete this.g,aa.$.N.call(this)},xr(ca,vi),xr(ua,wi),xr(ha,ia),ha.prototype.Ba=function(){Os(this.g,"a")},ha.prototype.Aa=function(e){Os(this.g,new ca(e))},ha.prototype.za=function(e){Os(this.g,new ua)},ha.prototype.ya=function(){Os(this.g,"b")},xr(la,(function(){this.blockSize=-1})),la.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},la.prototype.j=function(e,t){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=this.m,s=this.h,i=0;i<t;){if(0==s)for(;i<=n;)da(this,e,i),i+=this.blockSize;if("string"==typeof e){for(;i<t;)if(r[s++]=e.charCodeAt(i++),s==this.blockSize){da(this,r),s=0;break}}else for(;i<t;)if(r[s++]=e[i++],s==this.blockSize){da(this,r),s=0;break}}this.h=s,this.i+=t},la.prototype.l=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.i;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.j(e),e=Array(16),t=n=0;4>t;++t)for(var r=0;32>r;r+=8)e[n++]=this.g[t]>>>r&255;return e};var pa={};function ga(e){return-128<=e&&128>e?function(e,t){var n=pa;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=function(e){return new fa([0|e],0>e?-1:0)}(e)}(e):new fa([0|e],0>e?-1:0)}function ma(e){if(isNaN(e)||!isFinite(e))return va;if(0>e)return Ta(ma(-e));for(var t=[],n=1,r=0;e>=n;r++)t[r]=e/n|0,n*=ya;return new fa(t,0)}var ya=4294967296,va=ga(0),wa=ga(1),_a=ga(16777216);function Ea(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function ba(e){return-1==e.h}function Ta(e){for(var t=e.g.length,n=[],r=0;r<t;r++)n[r]=~e.g[r];return new fa(n,~e.h).add(wa)}function Ia(e,t){return e.add(Ta(t))}function Sa(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function Ca(e,t){this.g=e,this.h=t}function Aa(e,t){if(Ea(t))throw Error("division by zero");if(Ea(e))return new Ca(va,va);if(ba(e))return t=Aa(Ta(e),t),new Ca(Ta(t.g),Ta(t.h));if(ba(t))return t=Aa(e,Ta(t)),new Ca(Ta(t.g),t.h);if(30<e.g.length){if(ba(e)||ba(t))throw Error("slowDivide_ only works with positive integers.");for(var n=wa,r=t;0>=r.X(e);)n=ka(n),r=ka(r);var s=Ra(n,1),i=Ra(r,1);for(r=Ra(r,2),n=Ra(n,2);!Ea(r);){var o=i.add(r);0>=o.X(e)&&(s=s.add(n),i=o),r=Ra(r,1),n=Ra(n,1)}return t=Ia(e,s.R(t)),new Ca(s,t)}for(s=va;0<=e.X(t);){for(n=Math.max(1,Math.floor(e.ea()/t.ea())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),o=(i=ma(n)).R(t);ba(o)||0<o.X(e);)o=(i=ma(n-=r)).R(t);Ea(i)&&(i=wa),s=s.add(i),e=Ia(e,o)}return new Ca(s,e)}function ka(e){for(var t=e.g.length+1,n=[],r=0;r<t;r++)n[r]=e.D(r)<<1|e.D(r-1)>>>31;return new fa(n,e.h)}function Ra(e,t){var n=t>>5;t%=32;for(var r=e.g.length-n,s=[],i=0;i<r;i++)s[i]=0<t?e.D(i+n)>>>t|e.D(i+n+1)<<32-t:e.D(i+n);return new fa(s,e.h)}(br=fa.prototype).ea=function(){if(ba(this))return-Ta(this).ea();for(var e=0,t=1,n=0;n<this.g.length;n++){var r=this.D(n);e+=(0<=r?r:ya+r)*t,t*=ya}return e},br.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(Ea(this))return"0";if(ba(this))return"-"+Ta(this).toString(e);for(var t=ma(Math.pow(e,6)),n=this,r="";;){var s=Aa(n,t).g,i=((0<(n=Ia(n,s.R(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(Ea(n=s))return i+r;for(;6>i.length;)i="0"+i;r=i+r}},br.D=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},br.X=function(e){return ba(e=Ia(this,e))?-1:Ea(e)?0:1},br.abs=function(){return ba(this)?Ta(this):this},br.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0,s=0;s<=t;s++){var i=r+(65535&this.D(s))+(65535&e.D(s)),o=(i>>>16)+(this.D(s)>>>16)+(e.D(s)>>>16);r=o>>>16,i&=65535,o&=65535,n[s]=o<<16|i}return new fa(n,-2147483648&n[n.length-1]?-1:0)},br.R=function(e){if(Ea(this)||Ea(e))return va;if(ba(this))return ba(e)?Ta(this).R(Ta(e)):Ta(Ta(this).R(e));if(ba(e))return Ta(this.R(Ta(e)));if(0>this.X(_a)&&0>e.X(_a))return ma(this.ea()*e.ea());for(var t=this.g.length+e.g.length,n=[],r=0;r<2*t;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var s=0;s<e.g.length;s++){var i=this.D(r)>>>16,o=65535&this.D(r),a=e.D(s)>>>16,c=65535&e.D(s);n[2*r+2*s]+=o*c,Sa(n,2*r+2*s),n[2*r+2*s+1]+=i*c,Sa(n,2*r+2*s+1),n[2*r+2*s+1]+=o*a,Sa(n,2*r+2*s+1),n[2*r+2*s+2]+=i*a,Sa(n,2*r+2*s+2)}for(r=0;r<t;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=t;r<2*t;r++)n[r]=0;return new fa(n,0)},br.gb=function(e){return Aa(this,e).h},br.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)&e.D(r);return new fa(n,this.h&e.h)},br.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)|e.D(r);return new fa(n,this.h|e.h)},br.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)^e.D(r);return new fa(n,this.h^e.h)},oa.prototype.createWebChannel=oa.prototype.g,aa.prototype.send=aa.prototype.u,aa.prototype.open=aa.prototype.m,aa.prototype.close=aa.prototype.close,li.NO_ERROR=0,li.TIMEOUT=8,li.HTTP_ERROR=6,di.COMPLETE="complete",gi.EventType=yi,yi.OPEN="a",yi.CLOSE="b",yi.ERROR="c",yi.MESSAGE="d",Ds.prototype.listen=Ds.prototype.O,Co.prototype.listenOnce=Co.prototype.P,Co.prototype.getLastError=Co.prototype.Sa,Co.prototype.getLastErrorCode=Co.prototype.Ia,Co.prototype.getStatus=Co.prototype.da,Co.prototype.getResponseJson=Co.prototype.Wa,Co.prototype.getResponseText=Co.prototype.ja,Co.prototype.send=Co.prototype.ha,Co.prototype.setWithCredentials=Co.prototype.Oa,la.prototype.digest=la.prototype.l,la.prototype.reset=la.prototype.reset,la.prototype.update=la.prototype.j,fa.prototype.add=fa.prototype.add,fa.prototype.multiply=fa.prototype.R,fa.prototype.modulo=fa.prototype.gb,fa.prototype.compare=fa.prototype.X,fa.prototype.toNumber=fa.prototype.ea,fa.prototype.toString=fa.prototype.toString,fa.prototype.getBits=fa.prototype.D,fa.fromNumber=ma,fa.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return Ta(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=ma(Math.pow(n,8)),s=va,i=0;i<t.length;i+=8){var o=Math.min(8,t.length-i),a=parseInt(t.substring(i,i+o),n);8>o?(o=ma(Math.pow(n,o)),s=s.R(o).add(ma(a))):s=(s=s.R(r)).add(ma(a))}return s};var Na=Ir.createWebChannelTransport=function(){return new oa},Da=Ir.getStatEventTarget=function(){return si()},Oa=Ir.ErrorCode=li,Pa=Ir.EventType=di,La=Ir.Event=ni,xa=Ir.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},Ma=(Ir.FetchXmlHttpFactory=wo,Ir.WebChannel=gi),Ua=Ir.XhrIo=Co,Fa=Ir.Md5=la,Va=Ir.Integer=fa;const Ba="@firebase/firestore";class ja{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ja.UNAUTHENTICATED=new ja(null),ja.GOOGLE_CREDENTIALS=new ja("google-credentials-uid"),ja.FIRST_PARTY=new ja("first-party-uid"),ja.MOCK_USER=new ja("mock-user");let qa="10.9.0";const $a=new U("@firebase/firestore");function za(){return $a.logLevel}function Ka(e,...t){if($a.logLevel<=D.DEBUG){const n=t.map(Wa);$a.debug(`Firestore (${qa}): ${e}`,...n)}}function Ha(e,...t){if($a.logLevel<=D.ERROR){const n=t.map(Wa);$a.error(`Firestore (${qa}): ${e}`,...n)}}function Ga(e,...t){if($a.logLevel<=D.WARN){const n=t.map(Wa);$a.warn(`Firestore (${qa}): ${e}`,...n)}}function Wa(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(t){return e}}function Qa(e="Unexpected state"){const t=`FIRESTORE (${qa}) INTERNAL ASSERTION FAILED: `+e;throw Ha(t),new Error(t)}function Ja(e,t){e||Qa()}function Xa(e,t){return e}const Ya={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Za extends g{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class ec{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class tc{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class nc{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(ja.UNAUTHENTICATED)))}shutdown(){}}class rc{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class sc{constructor(e){this.t=e,this.currentUser=ja.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let s=new ec;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new ec,e.enqueueRetryable((()=>r(this.currentUser)))};const i=()=>{const t=s;e.enqueueRetryable((async()=>{await t.promise,await r(this.currentUser)}))},o=e=>{Ka("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.auth.addAuthTokenListener(this.o),i()};this.t.onInit((e=>o(e))),setTimeout((()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?o(e):(Ka("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new ec)}}),0),i()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((t=>this.i!==e?(Ka("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(Ja("string"==typeof t.accessToken),new tc(t.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return Ja(null===e||"string"==typeof e),new ja(e)}}class ic{constructor(e,t,n){this.l=e,this.h=t,this.P=n,this.type="FirstParty",this.user=ja.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class oc{constructor(e,t,n){this.l=e,this.h=t,this.P=n}getToken(){return Promise.resolve(new ic(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable((()=>t(ja.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class ac{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class cc{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){const n=e=>{null!=e.error&&Ka("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const n=e.token!==this.R;return this.R=e.token,Ka("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable((()=>n(t)))};const r=e=>{Ka("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.appCheck.addTokenListener(this.o)};this.A.onInit((e=>r(e))),setTimeout((()=>{if(!this.appCheck){const e=this.A.getImmediate({optional:!0});e?r(e):Ka("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((e=>e?(Ja("string"==typeof e.token),this.R=e.token,new ac(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function uc(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let t=0;t<e;t++)n[t]=Math.floor(256*Math.random());return n}class hc{static newId(){const e=62*Math.floor(256/62);let t="";for(;t.length<20;){const n=uc(40);for(let r=0;r<n.length;++r)t.length<20&&n[r]<e&&(t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[r]%62))}return t}}function lc(e,t){return e<t?-1:e>t?1:0}function dc(e,t,n){return e.length===t.length&&e.every(((e,r)=>n(e,t[r])))}class fc{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Za(Ya.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Za(Ya.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Za(Ya.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Za(Ya.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return fc.fromMillis(Date.now())}static fromDate(e){return fc.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new fc(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?lc(this.nanoseconds,e.nanoseconds):lc(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class pc{constructor(e){this.timestamp=e}static fromTimestamp(e){return new pc(e)}static min(){return new pc(new fc(0,0))}static max(){return new pc(new fc(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class gc{constructor(e,t,n){void 0===t?t=0:t>e.length&&Qa(),void 0===n?n=e.length-t:n>e.length-t&&Qa(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===gc.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof gc?e.forEach((e=>{t.push(e)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.get(r),s=t.get(r);if(n<s)return-1;if(n>s)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class mc extends gc{construct(e,t,n){return new mc(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new Za(Ya.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter((e=>e.length>0)))}return new mc(t)}static emptyPath(){return new mc([])}}const yc=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class vc extends gc{construct(e,t,n){return new vc(e,t,n)}static isValidIdentifier(e){return yc.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),vc.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new vc(["__name__"])}static fromServerFormat(e){const t=[];let n="",r=0;const s=()=>{if(0===n.length)throw new Za(Ya.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let i=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new Za(Ya.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new Za(Ya.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(i=!i,r++):"."!==t||i?(n+=t,r++):(s(),r++)}if(s(),i)throw new Za(Ya.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new vc(t)}static emptyPath(){return new vc([])}}class wc{constructor(e){this.path=e}static fromPath(e){return new wc(mc.fromString(e))}static fromName(e){return new wc(mc.fromString(e).popFirst(5))}static empty(){return new wc(mc.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===mc.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return mc.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new wc(new mc(e.slice()))}}function _c(e){return new Ec(e.readTime,e.key,-1)}class Ec{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Ec(pc.min(),wc.empty(),-1)}static max(){return new Ec(pc.max(),wc.empty(),-1)}}function bc(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=wc.comparator(e.documentKey,t.documentKey),0!==n?n:lc(e.largestBatchId,t.largestBatchId))}const Tc="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Ic{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Sc(e){if(e.code!==Ya.FAILED_PRECONDITION||e.message!==Tc)throw e;Ka("LocalStore","Unexpectedly lost primary lease")}class Cc{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Qa(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Cc(((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof Cc?t:Cc.resolve(t)}catch(e){return Cc.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):Cc.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):Cc.reject(t)}static resolve(e){return new Cc(((t,n)=>{t(e)}))}static reject(e){return new Cc(((t,n)=>{n(e)}))}static waitFor(e){return new Cc(((t,n)=>{let r=0,s=0,i=!1;e.forEach((e=>{++r,e.next((()=>{++s,i&&s===r&&t()}),(e=>n(e)))})),i=!0,s===r&&t()}))}static or(e){let t=Cc.resolve(!1);for(const n of e)t=t.next((e=>e?Cc.resolve(e):n()));return t}static forEach(e,t){const n=[];return e.forEach(((e,r)=>{n.push(t.call(this,e,r))})),this.waitFor(n)}static mapArray(e,t){return new Cc(((n,r)=>{const s=e.length,i=new Array(s);let o=0;for(let a=0;a<s;a++){const c=a;t(e[c]).next((e=>{i[c]=e,++o,o===s&&n(i)}),(e=>r(e)))}}))}static doWhile(e,t){return new Cc(((n,r)=>{const s=()=>{!0===e()?t().next((()=>{s()}),r):n()};s()}))}}class Ac{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new ec,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new Nc(e,t.error)):this.V.resolve()},this.transaction.onerror=t=>{const n=xc(t.target.error);this.V.reject(new Nc(e,n))}}static open(e,t,n,r){try{return new Ac(t,e.transaction(r,n))}catch(e){throw new Nc(t,e)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(Ka("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new Oc(t)}}class kc{constructor(e,t,n){this.name=e,this.version=t,this.p=n,12.2===kc.S(f())&&Ha("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return Ka("SimpleDb","Removing database:",e),Pc(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!p())return!1;if(kc.C())return!0;const e=f(),t=kc.S(e),n=0<t&&t<10,r=kc.v(e),s=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||s)}static C(){var e;return"undefined"!=typeof process&&"YES"===(null===(e=process.__PRIVATE_env)||void 0===e?void 0:e.F)}static M(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}static v(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}async O(e){return this.db||(Ka("SimpleDb","Opening database:",this.name),this.db=await new Promise(((t,n)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=e=>{const n=e.target.result;t(n)},r.onblocked=()=>{n(new Nc(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=t=>{const r=t.target.error;"VersionError"===r.name?n(new Za(Ya.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===r.name?n(new Za(Ya.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+r)):n(new Nc(e,r))},r.onupgradeneeded=e=>{Ka("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',e.oldVersion);const t=e.target.result;this.p.N(t,r.transaction,e.oldVersion,this.version).next((()=>{Ka("SimpleDb","Database upgrade to version "+this.version+" complete")}))}}))),this.L&&(this.db.onversionchange=e=>this.L(e)),this.db}B(e){this.L=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,n,r){const s="readonly"===t;let i=0;for(;;){++i;try{this.db=await this.O(e);const t=Ac.open(this.db,e,s?"readonly":"readwrite",n),i=r(t).next((e=>(t.g(),e))).catch((e=>(t.abort(e),Cc.reject(e)))).toPromise();return i.catch((()=>{})),await t.m,i}catch(e){const t=e,n="FirebaseError"!==t.name&&i<3;if(Ka("SimpleDb","Transaction failed with error:",t.message,"Retrying:",n),this.close(),!n)return Promise.reject(t)}}}close(){this.db&&this.db.close(),this.db=void 0}}class Rc{constructor(e){this.k=e,this.q=!1,this.K=null}get isDone(){return this.q}get $(){return this.K}set cursor(e){this.k=e}done(){this.q=!0}U(e){this.K=e}delete(){return Pc(this.k.delete())}}class Nc extends Za{constructor(e,t){super(Ya.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Dc(e){return"IndexedDbTransactionError"===e.name}class Oc{constructor(e){this.store=e}put(e,t){let n;return void 0!==t?(Ka("SimpleDb","PUT",this.store.name,e,t),n=this.store.put(t,e)):(Ka("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),Pc(n)}add(e){return Ka("SimpleDb","ADD",this.store.name,e,e),Pc(this.store.add(e))}get(e){return Pc(this.store.get(e)).next((t=>(void 0===t&&(t=null),Ka("SimpleDb","GET",this.store.name,e,t),t)))}delete(e){return Ka("SimpleDb","DELETE",this.store.name,e),Pc(this.store.delete(e))}count(){return Ka("SimpleDb","COUNT",this.store.name),Pc(this.store.count())}W(e,t){const n=this.options(e,t),r=n.index?this.store.index(n.index):this.store;if("function"==typeof r.getAll){const e=r.getAll(n.range);return new Cc(((t,n)=>{e.onerror=e=>{n(e.target.error)},e.onsuccess=e=>{t(e.target.result)}}))}{const e=this.cursor(n),t=[];return this.G(e,((e,n)=>{t.push(n)})).next((()=>t))}}j(e,t){const n=this.store.getAll(e,null===t?void 0:t);return new Cc(((e,t)=>{n.onerror=e=>{t(e.target.error)},n.onsuccess=t=>{e(t.target.result)}}))}H(e,t){Ka("SimpleDb","DELETE ALL",this.store.name);const n=this.options(e,t);n.J=!1;const r=this.cursor(n);return this.G(r,((e,t,n)=>n.delete()))}Y(e,t){let n;t?n=e:(n={},t=e);const r=this.cursor(n);return this.G(r,t)}Z(e){const t=this.cursor({});return new Cc(((n,r)=>{t.onerror=e=>{const t=xc(e.target.error);r(t)},t.onsuccess=t=>{const r=t.target.result;r?e(r.primaryKey,r.value).next((e=>{e?r.continue():n()})):n()}}))}G(e,t){const n=[];return new Cc(((r,s)=>{e.onerror=e=>{s(e.target.error)},e.onsuccess=e=>{const s=e.target.result;if(!s)return void r();const i=new Rc(s),o=t(s.primaryKey,s.value,i);if(o instanceof Cc){const e=o.catch((e=>(i.done(),Cc.reject(e))));n.push(e)}i.isDone?r():null===i.$?s.continue():s.continue(i.$)}})).next((()=>Cc.waitFor(n)))}options(e,t){let n;return void 0!==e&&("string"==typeof e?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const n=this.store.index(e.index);return e.J?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Pc(e){return new Cc(((t,n)=>{e.onsuccess=e=>{const n=e.target.result;t(n)},e.onerror=e=>{const t=xc(e.target.error);n(t)}}))}let Lc=!1;function xc(e){const t=kc.S(f());if(t>=12.2&&t<13){const t="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(t)>=0){const e=new Za("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Lc||(Lc=!0,setTimeout((()=>{throw e}),0)),e}}return e}class Mc{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.se(e),this.oe=e=>t.writeSequenceNumber(e))}se(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.oe&&this.oe(e),e}}function Uc(e){return null==e}function Fc(e){return 0===e&&1/e==-1/0}Mc._e=-1;function Vc(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Bc(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function jc(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class qc{constructor(e,t){this.comparator=e,this.root=t||zc.EMPTY}insert(e,t){return new qc(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,zc.BLACK,null,null))}remove(e){return new qc(this.comparator,this.root.remove(e,this.comparator).copy(null,null,zc.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new $c(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new $c(this.root,e,this.comparator,!1)}getReverseIterator(){return new $c(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new $c(this.root,e,this.comparator,!0)}}class $c{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,t&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(0===s){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class zc{constructor(e,t,n,r,s){this.key=e,this.value=t,this.color=null!=n?n:zc.RED,this.left=null!=r?r:zc.EMPTY,this.right=null!=s?s:zc.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,s){return new zc(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=s?s:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const s=n(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===s?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return zc.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return zc.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,zc.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,zc.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Qa();if(this.right.isRed())throw Qa();const e=this.left.check();if(e!==this.right.check())throw Qa();return e+(this.isRed()?0:1)}}zc.EMPTY=null,zc.RED=!0,zc.BLACK=!1,zc.EMPTY=new class{constructor(){this.size=0}get key(){throw Qa()}get value(){throw Qa()}get color(){throw Qa()}get left(){throw Qa()}get right(){throw Qa()}copy(e,t,n,r,s){return this}insert(e,t,n){return new zc(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Kc{constructor(e){this.comparator=e,this.data=new qc(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Hc(this.data.getIterator())}getIteratorFrom(e){return new Hc(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((e=>{t=t.add(e)})),t}isEqual(e){if(!(e instanceof Kc))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Kc(this.comparator);return t.data=e,t}}class Hc{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Gc{constructor(e){this.fields=e,e.sort(vc.comparator)}static empty(){return new Gc([])}unionWith(e){let t=new Kc(vc.comparator);for(const e of this.fields)t=t.add(e);for(const n of e)t=t.add(n);return new Gc(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return dc(this.fields,e.fields,((e,t)=>e.isEqual(t)))}}class Wc extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Qc{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new Wc("Invalid base64 string: "+e):e}}(e);return new Qc(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new Qc(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return lc(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Qc.EMPTY_BYTE_STRING=new Qc("");const Jc=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Xc(e){if(Ja(!!e),"string"==typeof e){let t=0;const n=Jc.exec(e);if(Ja(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:Yc(e.seconds),nanos:Yc(e.nanos)}}function Yc(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function Zc(e){return"string"==typeof e?Qc.fromBase64String(e):Qc.fromUint8Array(e)}function eu(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function tu(e){const t=e.mapValue.fields.__previous_value__;return eu(t)?tu(t):t}function nu(e){const t=Xc(e.mapValue.fields.__local_write_time__.timestampValue);return new fc(t.seconds,t.nanos)}class ru{constructor(e,t,n,r,s,i,o,a,c){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=s,this.forceLongPolling=i,this.autoDetectLongPolling=o,this.longPollingOptions=a,this.useFetchStreams=c}}class su{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new su("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof su&&e.projectId===this.projectId&&e.database===this.database}}const iu={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function ou(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?eu(e)?4:_u(e)?9007199254740991:10:Qa()}function au(e,t){if(e===t)return!0;const n=ou(e);if(n!==ou(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return nu(e).isEqual(nu(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=Xc(e.timestampValue),r=Xc(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return Zc(e.bytesValue).isEqual(Zc(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return Yc(e.geoPointValue.latitude)===Yc(t.geoPointValue.latitude)&&Yc(e.geoPointValue.longitude)===Yc(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return Yc(e.integerValue)===Yc(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=Yc(e.doubleValue),r=Yc(t.doubleValue);return n===r?Fc(n)===Fc(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return dc(e.arrayValue.values||[],t.arrayValue.values||[],au);case 10:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(Vc(n)!==Vc(r))return!1;for(const e in n)if(n.hasOwnProperty(e)&&(void 0===r[e]||!au(n[e],r[e])))return!1;return!0}(e,t);default:return Qa()}}function cu(e,t){return void 0!==(e.values||[]).find((e=>au(e,t)))}function uu(e,t){if(e===t)return 0;const n=ou(e),r=ou(t);if(n!==r)return lc(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return lc(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=Yc(e.integerValue||e.doubleValue),r=Yc(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return hu(e.timestampValue,t.timestampValue);case 4:return hu(nu(e),nu(t));case 5:return lc(e.stringValue,t.stringValue);case 6:return function(e,t){const n=Zc(e),r=Zc(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let e=0;e<n.length&&e<r.length;e++){const t=lc(n[e],r[e]);if(0!==t)return t}return lc(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=lc(Yc(e.latitude),Yc(t.latitude));return 0!==n?n:lc(Yc(e.longitude),Yc(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){const n=e.values||[],r=t.values||[];for(let e=0;e<n.length&&e<r.length;++e){const t=uu(n[e],r[e]);if(t)return t}return lc(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){if(e===iu.mapValue&&t===iu.mapValue)return 0;if(e===iu.mapValue)return 1;if(t===iu.mapValue)return-1;const n=e.fields||{},r=Object.keys(n),s=t.fields||{},i=Object.keys(s);r.sort(),i.sort();for(let e=0;e<r.length&&e<i.length;++e){const t=lc(r[e],i[e]);if(0!==t)return t;const o=uu(n[r[e]],s[i[e]]);if(0!==o)return o}return lc(r.length,i.length)}(e.mapValue,t.mapValue);default:throw Qa()}}function hu(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return lc(e,t);const n=Xc(e),r=Xc(t),s=lc(n.seconds,r.seconds);return 0!==s?s:lc(n.nanos,r.nanos)}function lu(e){return du(e)}function du(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=Xc(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return Zc(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return wc.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return`geo(${e.latitude},${e.longitude})`}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=du(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const s of t)r?r=!1:n+=",",n+=`${s}:${du(e.fields[s])}`;return n+"}"}(e.mapValue):Qa()}function fu(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function pu(e){return!!e&&"integerValue"in e}function gu(e){return!!e&&"arrayValue"in e}function mu(e){return!!e&&"nullValue"in e}function yu(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function vu(e){return!!e&&"mapValue"in e}function wu(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return Bc(e.mapValue.fields,((e,n)=>t.mapValue.fields[e]=wu(n))),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=wu(e.arrayValue.values[n]);return t}return Object.assign({},e)}function _u(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}class Eu{constructor(e){this.value=e}static empty(){return new Eu({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!vu(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=wu(t)}setAll(e){let t=vc.emptyPath(),n={},r=[];e.forEach(((e,s)=>{if(!t.isImmediateParentOf(s)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=s.popLast()}e?n[s.lastSegment()]=wu(e):r.push(s.lastSegment())}));const s=this.getFieldsMap(t);this.applyChanges(s,n,r)}delete(e){const t=this.field(e.popLast());vu(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return au(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];vu(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){Bc(t,((t,n)=>e[t]=n));for(const t of n)delete e[t]}clone(){return new Eu(wu(this.value))}}function bu(e){const t=[];return Bc(e.fields,((e,n)=>{const r=new vc([e]);if(vu(n)){const e=bu(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)})),new Gc(t)}class Tu{constructor(e,t,n,r,s,i,o){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=s,this.data=i,this.documentState=o}static newInvalidDocument(e){return new Tu(e,0,pc.min(),pc.min(),pc.min(),Eu.empty(),0)}static newFoundDocument(e,t,n,r){return new Tu(e,1,t,pc.min(),n,r,0)}static newNoDocument(e,t){return new Tu(e,2,t,pc.min(),pc.min(),Eu.empty(),0)}static newUnknownDocument(e,t){return new Tu(e,3,t,pc.min(),pc.min(),Eu.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(pc.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Eu.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Eu.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=pc.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Tu&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Tu(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Iu{constructor(e,t){this.position=e,this.inclusive=t}}function Su(e,t,n){let r=0;for(let s=0;s<e.position.length;s++){const i=t[s],o=e.position[s];if(r=i.field.isKeyField()?wc.comparator(wc.fromName(o.referenceValue),n.key):uu(o,n.data.field(i.field)),"desc"===i.dir&&(r*=-1),0!==r)break}return r}function Cu(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!au(e.position[n],t.position[n]))return!1;return!0}class Au{constructor(e,t="asc"){this.field=e,this.dir=t}}function ku(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class Ru{}class Nu extends Ru{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new Uu(e,t,n):"array-contains"===t?new ju(e,n):"in"===t?new qu(e,n):"not-in"===t?new $u(e,n):"array-contains-any"===t?new zu(e,n):new Nu(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new Fu(e,n):new Vu(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(uu(t,this.value)):null!==t&&ou(this.value)===ou(t)&&this.matchesComparison(uu(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return Qa()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Du extends Ru{constructor(e,t){super(),this.filters=e,this.op=t,this.ue=null}static create(e,t){return new Du(e,t)}matches(e){return Ou(this)?void 0===this.filters.find((t=>!t.matches(e))):void 0!==this.filters.find((t=>t.matches(e)))}getFlattenedFilters(){return null!==this.ue||(this.ue=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.ue}getFilters(){return Object.assign([],this.filters)}}function Ou(e){return"and"===e.op}function Pu(e){return function(e){for(const t of e.filters)if(t instanceof Du)return!1;return!0}(e)&&Ou(e)}function Lu(e){if(e instanceof Nu)return e.field.canonicalString()+e.op.toString()+lu(e.value);if(Pu(e))return e.filters.map((e=>Lu(e))).join(",");{const t=e.filters.map((e=>Lu(e))).join(",");return`${e.op}(${t})`}}function xu(e,t){return e instanceof Nu?function(e,t){return t instanceof Nu&&e.op===t.op&&e.field.isEqual(t.field)&&au(e.value,t.value)}(e,t):e instanceof Du?function(e,t){return t instanceof Du&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce(((e,n,r)=>e&&xu(n,t.filters[r])),!0)}(e,t):void Qa()}function Mu(e){return e instanceof Nu?function(e){return`${e.field.canonicalString()} ${e.op} ${lu(e.value)}`}(e):e instanceof Du?function(e){return e.op.toString()+" {"+e.getFilters().map(Mu).join(" ,")+"}"}(e):"Filter"}class Uu extends Nu{constructor(e,t,n){super(e,t,n),this.key=wc.fromName(n.referenceValue)}matches(e){const t=wc.comparator(e.key,this.key);return this.matchesComparison(t)}}class Fu extends Nu{constructor(e,t){super(e,"in",t),this.keys=Bu(0,t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class Vu extends Nu{constructor(e,t){super(e,"not-in",t),this.keys=Bu(0,t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function Bu(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((e=>wc.fromName(e.referenceValue)))}class ju extends Nu{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return gu(t)&&cu(t.arrayValue,this.value)}}class qu extends Nu{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&cu(this.value.arrayValue,t)}}class $u extends Nu{constructor(e,t){super(e,"not-in",t)}matches(e){if(cu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!cu(this.value.arrayValue,t)}}class zu extends Nu{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!gu(t)||!t.arrayValue.values)&&t.arrayValue.values.some((e=>cu(this.value.arrayValue,e)))}}class Ku{constructor(e,t=null,n=[],r=[],s=null,i=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=s,this.startAt=i,this.endAt=o,this.ce=null}}function Hu(e,t=null,n=[],r=[],s=null,i=null,o=null){return new Ku(e,t,n,r,s,i,o)}function Gu(e){const t=Xa(e);if(null===t.ce){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((e=>Lu(e))).join(","),e+="|ob:",e+=t.orderBy.map((e=>function(e){return e.field.canonicalString()+e.dir}(e))).join(","),Uc(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((e=>lu(e))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((e=>lu(e))).join(",")),t.ce=e}return t.ce}function Wu(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!ku(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!xu(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!Cu(e.startAt,t.startAt)&&Cu(e.endAt,t.endAt)}function Qu(e){return wc.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}class Ju{constructor(e,t=null,n=[],r=[],s=null,i="F",o=null,a=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=s,this.limitType=i,this.startAt=o,this.endAt=a,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt}}function Xu(e){return new Ju(e)}function Yu(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function Zu(e){return null!==e.collectionGroup}function eh(e){const t=Xa(e);if(null===t.le){t.le=[];const e=new Set;for(const n of t.explicitOrderBy)t.le.push(n),e.add(n.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",r=function(e){let t=new Kc(vc.comparator);return e.filters.forEach((e=>{e.getFlattenedFilters().forEach((e=>{e.isInequality()&&(t=t.add(e.field))}))})),t}(t);r.forEach((r=>{e.has(r.canonicalString())||r.isKeyField()||t.le.push(new Au(r,n))})),e.has(vc.keyField().canonicalString())||t.le.push(new Au(vc.keyField(),n))}return t.le}function th(e){const t=Xa(e);return t.he||(t.he=function(e,t){if("F"===e.limitType)return Hu(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map((e=>{const t="desc"===e.dir?"asc":"desc";return new Au(e.field,t)}));const n=e.endAt?new Iu(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new Iu(e.startAt.position,e.startAt.inclusive):null;return Hu(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}(t,eh(e))),t.he}function nh(e,t){const n=e.filters.concat([t]);return new Ju(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function rh(e,t,n){return new Ju(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function sh(e,t){return Wu(th(e),th(t))&&e.limitType===t.limitType}function ih(e){return`${Gu(th(e))}|lt:${e.limitType}`}function oh(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map((e=>Mu(e))).join(", ")}]`),Uc(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map((e=>function(e){return`${e.field.canonicalString()} (${e.dir})`}(e))).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((e=>lu(e))).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((e=>lu(e))).join(",")),`Target(${t})`}(th(e))}; limitType=${e.limitType})`}function ah(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):wc.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of eh(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const r=Su(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,eh(e),t)||e.endAt&&!function(e,t,n){const r=Su(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,eh(e),t))}(e,t)}function ch(e){return(t,n)=>{let r=!1;for(const s of eh(e)){const e=uh(s,t,n);if(0!==e)return e;r=r||s.field.isKeyField()}return 0}}function uh(e,t,n){const r=e.field.isKeyField()?wc.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),s=n.data.field(e);return null!==r&&null!==s?uu(r,s):Qa()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return Qa()}}class hh{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[t,r]of n)if(this.equalsFn(t,e))return r}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let n=0;n<r.length;n++)if(this.equalsFn(r[n][0],e))return void(r[n]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Bc(this.inner,((t,n)=>{for(const[t,r]of n)e(t,r)}))}isEmpty(){return jc(this.inner)}size(){return this.innerSize}}const lh=new qc(wc.comparator);function dh(){return lh}const fh=new qc(wc.comparator);function ph(...e){let t=fh;for(const n of e)t=t.insert(n.key,n);return t}function gh(e){let t=fh;return e.forEach(((e,n)=>t=t.insert(e,n.overlayedDocument))),t}function mh(){return vh()}function yh(){return vh()}function vh(){return new hh((e=>e.toString()),((e,t)=>e.isEqual(t)))}const wh=new qc(wc.comparator),_h=new Kc(wc.comparator);function Eh(...e){let t=_h;for(const n of e)t=t.add(n);return t}const bh=new Kc(lc);function Th(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Fc(t)?"-0":t}}function Ih(e){return{integerValue:""+e}}function Sh(e,t){return function(e){return"number"==typeof e&&Number.isInteger(e)&&!Fc(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}(t)?Ih(t):Th(e,t)}class Ch{constructor(){this._=void 0}}function Ah(e,t,n){return e instanceof Nh?function(e,t){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&eu(t)&&(t=tu(t)),t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof Dh?Oh(e,t):e instanceof Ph?Lh(e,t):function(e,t){const n=Rh(e,t),r=Mh(n)+Mh(e.Ie);return pu(n)&&pu(e.Ie)?Ih(r):Th(e.serializer,r)}(e,t)}function kh(e,t,n){return e instanceof Dh?Oh(e,t):e instanceof Ph?Lh(e,t):n}function Rh(e,t){return e instanceof xh?function(e){return pu(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}class Nh extends Ch{}class Dh extends Ch{constructor(e){super(),this.elements=e}}function Oh(e,t){const n=Uh(t);for(const t of e.elements)n.some((e=>au(e,t)))||n.push(t);return{arrayValue:{values:n}}}class Ph extends Ch{constructor(e){super(),this.elements=e}}function Lh(e,t){let n=Uh(t);for(const t of e.elements)n=n.filter((e=>!au(e,t)));return{arrayValue:{values:n}}}class xh extends Ch{constructor(e,t){super(),this.serializer=e,this.Ie=t}}function Mh(e){return Yc(e.integerValue||e.doubleValue)}function Uh(e){return gu(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class Fh{constructor(e,t){this.version=e,this.transformResults=t}}class Vh{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Vh}static exists(e){return new Vh(void 0,e)}static updateTime(e){return new Vh(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Bh(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class jh{}function qh(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new Yh(e.key,Vh.none()):new Gh(e.key,e.data,Vh.none());{const n=e.data,r=Eu.empty();let s=new Kc(vc.comparator);for(let e of t.fields)if(!s.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),s=s.add(e)}return new Wh(e.key,r,new Gc(s.toArray()),Vh.none())}}function $h(e,t,n){e instanceof Gh?function(e,t,n){const r=e.value.clone(),s=Jh(e.fieldTransforms,t,n.transformResults);r.setAll(s),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof Wh?function(e,t,n){if(!Bh(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=Jh(e.fieldTransforms,t,n.transformResults),s=t.data;s.setAll(Qh(e)),s.setAll(r),t.convertToFoundDocument(n.version,s).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function zh(e,t,n,r){return e instanceof Gh?function(e,t,n,r){if(!Bh(e.precondition,t))return n;const s=e.value.clone(),i=Xh(e.fieldTransforms,r,t);return s.setAll(i),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null}(e,t,n,r):e instanceof Wh?function(e,t,n,r){if(!Bh(e.precondition,t))return n;const s=Xh(e.fieldTransforms,r,t),i=t.data;return i.setAll(Qh(e)),i.setAll(s),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((e=>e.field)))}(e,t,n,r):function(e,t,n){return Bh(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function Kh(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),s=Rh(r.transform,e||null);null!=s&&(null===n&&(n=Eu.empty()),n.set(r.field,s))}return n||null}function Hh(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&dc(e,t,((e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof Dh&&t instanceof Dh||e instanceof Ph&&t instanceof Ph?dc(e.elements,t.elements,au):e instanceof xh&&t instanceof xh?au(e.Ie,t.Ie):e instanceof Nh&&t instanceof Nh}(e.transform,t.transform)}(e,t)))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class Gh extends jh{constructor(e,t,n,r=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Wh extends jh{constructor(e,t,n,r,s=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function Qh(e){const t=new Map;return e.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}})),t}function Jh(e,t,n){const r=new Map;Ja(e.length===n.length);for(let s=0;s<n.length;s++){const i=e[s],o=i.transform,a=t.data.field(i.field);r.set(i.field,kh(o,a,n[s]))}return r}function Xh(e,t,n){const r=new Map;for(const s of e){const e=s.transform,i=n.data.field(s.field);r.set(s.field,Ah(e,i,t))}return r}class Yh extends jh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Zh extends jh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class el{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let t=0;t<this.mutations.length;t++){const r=this.mutations[t];r.key.isEqual(e.key)&&$h(r,e,n[t])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=zh(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=zh(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=yh();return this.mutations.forEach((r=>{const s=e.get(r.key),i=s.overlayedDocument;let o=this.applyToLocalView(i,s.mutatedFields);o=t.has(r.key)?null:o;const a=qh(i,o);null!==a&&n.set(r.key,a),i.isValidDocument()||i.convertToNoDocument(pc.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Eh())}isEqual(e){return this.batchId===e.batchId&&dc(this.mutations,e.mutations,((e,t)=>Hh(e,t)))&&dc(this.baseMutations,e.baseMutations,((e,t)=>Hh(e,t)))}}class tl{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){Ja(e.mutations.length===n.length);let r=wh;const s=e.mutations;for(let e=0;e<s.length;e++)r=r.insert(s[e].key,n[e].version);return new tl(e,t,n,r)}}class nl{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class rl{constructor(e,t){this.count=e,this.unchangedNames=t}}var sl,il;function ol(e){if(void 0===e)return Ha("GRPC error has no .code"),Ya.UNKNOWN;switch(e){case sl.OK:return Ya.OK;case sl.CANCELLED:return Ya.CANCELLED;case sl.UNKNOWN:return Ya.UNKNOWN;case sl.DEADLINE_EXCEEDED:return Ya.DEADLINE_EXCEEDED;case sl.RESOURCE_EXHAUSTED:return Ya.RESOURCE_EXHAUSTED;case sl.INTERNAL:return Ya.INTERNAL;case sl.UNAVAILABLE:return Ya.UNAVAILABLE;case sl.UNAUTHENTICATED:return Ya.UNAUTHENTICATED;case sl.INVALID_ARGUMENT:return Ya.INVALID_ARGUMENT;case sl.NOT_FOUND:return Ya.NOT_FOUND;case sl.ALREADY_EXISTS:return Ya.ALREADY_EXISTS;case sl.PERMISSION_DENIED:return Ya.PERMISSION_DENIED;case sl.FAILED_PRECONDITION:return Ya.FAILED_PRECONDITION;case sl.ABORTED:return Ya.ABORTED;case sl.OUT_OF_RANGE:return Ya.OUT_OF_RANGE;case sl.UNIMPLEMENTED:return Ya.UNIMPLEMENTED;case sl.DATA_LOSS:return Ya.DATA_LOSS;default:return Qa()}}(il=sl||(sl={}))[il.OK=0]="OK",il[il.CANCELLED=1]="CANCELLED",il[il.UNKNOWN=2]="UNKNOWN",il[il.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",il[il.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",il[il.NOT_FOUND=5]="NOT_FOUND",il[il.ALREADY_EXISTS=6]="ALREADY_EXISTS",il[il.PERMISSION_DENIED=7]="PERMISSION_DENIED",il[il.UNAUTHENTICATED=16]="UNAUTHENTICATED",il[il.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",il[il.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",il[il.ABORTED=10]="ABORTED",il[il.OUT_OF_RANGE=11]="OUT_OF_RANGE",il[il.UNIMPLEMENTED=12]="UNIMPLEMENTED",il[il.INTERNAL=13]="INTERNAL",il[il.UNAVAILABLE=14]="UNAVAILABLE",il[il.DATA_LOSS=15]="DATA_LOSS";const al=new Va([4294967295,4294967295],0);function cl(e){const t=(new TextEncoder).encode(e),n=new Fa;return n.update(t),new Uint8Array(n.digest())}function ul(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),s=t.getUint32(8,!0),i=t.getUint32(12,!0);return[new Va([n,r],0),new Va([s,i],0)]}class hl{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new ll(`Invalid padding: ${t}`);if(n<0)throw new ll(`Invalid hash count: ${n}`);if(e.length>0&&0===this.hashCount)throw new ll(`Invalid hash count: ${n}`);if(0===e.length&&0!==t)throw new ll(`Invalid padding when bitmap length is 0: ${t}`);this.Te=8*e.length-t,this.Ee=Va.fromNumber(this.Te)}de(e,t,n){let r=e.add(t.multiply(Va.fromNumber(n)));return 1===r.compare(al)&&(r=new Va([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Ee).toNumber()}Ae(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.Te)return!1;const t=cl(e),[n,r]=ul(t);for(let e=0;e<this.hashCount;e++){const t=this.de(n,r,e);if(!this.Ae(t))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),i=new hl(s,r,t);return n.forEach((e=>i.insert(e))),i}insert(e){if(0===this.Te)return;const t=cl(e),[n,r]=ul(t);for(let e=0;e<this.hashCount;e++){const t=this.de(n,r,e);this.Re(t)}}Re(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class ll extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class dl{constructor(e,t,n,r,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,fl.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new dl(pc.min(),r,new qc(lc),dh(),Eh())}}class fl{constructor(e,t,n,r,s){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new fl(n,t,Eh(),Eh(),Eh())}}class pl{constructor(e,t,n,r){this.Ve=e,this.removedTargetIds=t,this.key=n,this.me=r}}class gl{constructor(e,t){this.targetId=e,this.fe=t}}class ml{constructor(e,t,n=Qc.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class yl{constructor(){this.ge=0,this.pe=_l(),this.ye=Qc.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return 0!==this.ge}get De(){return this.Se}Ce(e){e.approximateByteSize()>0&&(this.Se=!0,this.ye=e)}ve(){let e=Eh(),t=Eh(),n=Eh();return this.pe.forEach(((r,s)=>{switch(s){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:Qa()}})),new fl(this.ye,this.we,e,t,n)}Fe(){this.Se=!1,this.pe=_l()}Me(e,t){this.Se=!0,this.pe=this.pe.insert(e,t)}xe(e){this.Se=!0,this.pe=this.pe.remove(e)}Oe(){this.ge+=1}Ne(){this.ge-=1,Ja(this.ge>=0)}Le(){this.Se=!0,this.we=!0}}class vl{constructor(e){this.Be=e,this.ke=new Map,this.qe=dh(),this.Qe=wl(),this.Ke=new qc(lc)}$e(e){for(const t of e.Ve)e.me&&e.me.isFoundDocument()?this.Ue(t,e.me):this.We(t,e.key,e.me);for(const t of e.removedTargetIds)this.We(t,e.key,e.me)}Ge(e){this.forEachTarget(e,(t=>{const n=this.ze(t);switch(e.state){case 0:this.je(t)&&n.Ce(e.resumeToken);break;case 1:n.Ne(),n.be||n.Fe(),n.Ce(e.resumeToken);break;case 2:n.Ne(),n.be||this.removeTarget(t);break;case 3:this.je(t)&&(n.Le(),n.Ce(e.resumeToken));break;case 4:this.je(t)&&(this.He(t),n.Ce(e.resumeToken));break;default:Qa()}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ke.forEach(((e,n)=>{this.je(n)&&t(n)}))}Je(e){const t=e.targetId,n=e.fe.count,r=this.Ye(t);if(r){const s=r.target;if(Qu(s))if(0===n){const e=new wc(s.path);this.We(t,e,Tu.newNoDocument(e,pc.min()))}else Ja(1===n);else{const r=this.Ze(t);if(r!==n){const n=this.Xe(e),s=n?this.et(n,e,r):1;if(0!==s){this.He(t);const e=2===s?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(t,e)}}}}}Xe(e){const t=e.fe.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:s=0}=t;let i,o;try{i=Zc(n).toUint8Array()}catch(e){if(e instanceof Wc)return Ga("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{o=new hl(i,r,s)}catch(e){return Ga(e instanceof ll?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===o.Te?null:o}et(e,t,n){return t.fe.count===n-this.rt(e,t.targetId)?0:2}rt(e,t){const n=this.Be.getRemoteKeysForTarget(t);let r=0;return n.forEach((n=>{const s=this.Be.nt(),i=`projects/${s.projectId}/databases/${s.database}/documents/${n.path.canonicalString()}`;e.mightContain(i)||(this.We(t,n,null),r++)})),r}it(e){const t=new Map;this.ke.forEach(((n,r)=>{const s=this.Ye(r);if(s){if(n.current&&Qu(s.target)){const t=new wc(s.target.path);null!==this.qe.get(t)||this.st(r,t)||this.We(r,t,Tu.newNoDocument(t,e))}n.De&&(t.set(r,n.ve()),n.Fe())}}));let n=Eh();this.Qe.forEach(((e,t)=>{let r=!0;t.forEachWhile((e=>{const t=this.Ye(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)})),r&&(n=n.add(e))})),this.qe.forEach(((t,n)=>n.setReadTime(e)));const r=new dl(e,t,this.Ke,this.qe,n);return this.qe=dh(),this.Qe=wl(),this.Ke=new qc(lc),r}Ue(e,t){if(!this.je(e))return;const n=this.st(e,t.key)?2:0;this.ze(e).Me(t.key,n),this.qe=this.qe.insert(t.key,t),this.Qe=this.Qe.insert(t.key,this.ot(t.key).add(e))}We(e,t,n){if(!this.je(e))return;const r=this.ze(e);this.st(e,t)?r.Me(t,1):r.xe(t),this.Qe=this.Qe.insert(t,this.ot(t).delete(e)),n&&(this.qe=this.qe.insert(t,n))}removeTarget(e){this.ke.delete(e)}Ze(e){const t=this.ze(e).ve();return this.Be.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Oe(e){this.ze(e).Oe()}ze(e){let t=this.ke.get(e);return t||(t=new yl,this.ke.set(e,t)),t}ot(e){let t=this.Qe.get(e);return t||(t=new Kc(lc),this.Qe=this.Qe.insert(e,t)),t}je(e){const t=null!==this.Ye(e);return t||Ka("WatchChangeAggregator","Detected inactive target",e),t}Ye(e){const t=this.ke.get(e);return t&&t.be?null:this.Be._t(e)}He(e){this.ke.set(e,new yl),this.Be.getRemoteKeysForTarget(e).forEach((t=>{this.We(e,t,null)}))}st(e,t){return this.Be.getRemoteKeysForTarget(e).has(t)}}function wl(){return new qc(wc.comparator)}function _l(){return new qc(wc.comparator)}const El={asc:"ASCENDING",desc:"DESCENDING"},bl={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Tl={and:"AND",or:"OR"};class Il{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Sl(e,t){return e.useProto3Json||Uc(t)?t:{value:t}}function Cl(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function Al(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function kl(e,t){return Cl(e,t.toTimestamp())}function Rl(e){return Ja(!!e),pc.fromTimestamp(function(e){const t=Xc(e);return new fc(t.seconds,t.nanos)}(e))}function Nl(e,t){return Dl(e,t).canonicalString()}function Dl(e,t){const n=function(e){return new mc(["projects",e.projectId,"databases",e.database])}(e).child("documents");return void 0===t?n:n.child(t)}function Ol(e){const t=mc.fromString(e);return Ja(Jl(t)),t}function Pl(e,t){return Nl(e.databaseId,t.path)}function Ll(e,t){const n=Ol(t);if(n.get(1)!==e.databaseId.projectId)throw new Za(Ya.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new Za(Ya.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new wc(Ul(n))}function xl(e,t){return Nl(e.databaseId,t)}function Ml(e){return new mc(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Ul(e){return Ja(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function Fl(e,t,n){return{name:Pl(e,t),fields:n.value.mapValue.fields}}function Vl(e,t){return{documents:[xl(e,t.path)]}}function Bl(e,t){const n={structuredQuery:{}},r=t.path;let s;null!==t.collectionGroup?(s=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=xl(e,s);const i=function(e){if(0!==e.length)return Wl(Du.create(e,"and"))}(t.filters);i&&(n.structuredQuery.where=i);const o=function(e){if(0!==e.length)return e.map((e=>function(e){return{field:Hl(e.field),direction:$l(e.dir)}}(e)))}(t.orderBy);o&&(n.structuredQuery.orderBy=o);const a=Sl(e,t.limit);return null!==a&&(n.structuredQuery.limit=a),t.startAt&&(n.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{ut:n,parent:s}}function jl(e){let t=function(e){const t=Ol(e);return 4===t.length?mc.emptyPath():Ul(t)}(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){Ja(1===r);const e=n.from[0];e.allDescendants?s=e.collectionId:t=t.child(e.collectionId)}let i=[];n.where&&(i=function(e){const t=ql(e);return t instanceof Du&&Pu(t)?t.getFilters():[t]}(n.where));let o=[];n.orderBy&&(o=function(e){return e.map((e=>function(e){return new Au(Gl(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e)))}(n.orderBy));let a=null;n.limit&&(a=function(e){let t;return t="object"==typeof e?e.value:e,Uc(t)?null:t}(n.limit));let c=null;n.startAt&&(c=function(e){const t=!!e.before,n=e.values||[];return new Iu(n,t)}(n.startAt));let u=null;return n.endAt&&(u=function(e){const t=!e.before,n=e.values||[];return new Iu(n,t)}(n.endAt)),function(e,t,n,r,s,i,o,a){return new Ju(e,t,n,r,s,i,o,a)}(t,s,o,i,a,"F",c,u)}function ql(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=Gl(e.unaryFilter.field);return Nu.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=Gl(e.unaryFilter.field);return Nu.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Gl(e.unaryFilter.field);return Nu.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=Gl(e.unaryFilter.field);return Nu.create(s,"!=",{nullValue:"NULL_VALUE"});default:return Qa()}}(e):void 0!==e.fieldFilter?function(e){return Nu.create(Gl(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Qa()}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return Du.create(e.compositeFilter.filters.map((e=>ql(e))),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return Qa()}}(e.compositeFilter.op))}(e):Qa()}function $l(e){return El[e]}function zl(e){return bl[e]}function Kl(e){return Tl[e]}function Hl(e){return{fieldPath:e.canonicalString()}}function Gl(e){return vc.fromServerFormat(e.fieldPath)}function Wl(e){return e instanceof Nu?function(e){if("=="===e.op){if(yu(e.value))return{unaryFilter:{field:Hl(e.field),op:"IS_NAN"}};if(mu(e.value))return{unaryFilter:{field:Hl(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(yu(e.value))return{unaryFilter:{field:Hl(e.field),op:"IS_NOT_NAN"}};if(mu(e.value))return{unaryFilter:{field:Hl(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Hl(e.field),op:zl(e.op),value:e.value}}}(e):e instanceof Du?function(e){const t=e.getFilters().map((e=>Wl(e)));return 1===t.length?t[0]:{compositeFilter:{op:Kl(e.op),filters:t}}}(e):Qa()}function Ql(e){const t=[];return e.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function Jl(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class Xl{constructor(e,t,n,r,s=pc.min(),i=pc.min(),o=Qc.EMPTY_BYTE_STRING,a=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=i,this.resumeToken=o,this.expectedCount=a}withSequenceNumber(e){return new Xl(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Xl(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Xl(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Xl(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class Yl{constructor(e){this.ct=e}}function Zl(e){const t=jl({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?rh(t,t.limit,"L"):t}class ed{constructor(){}Pt(e,t){this.It(e,t),t.Tt()}It(e,t){if("nullValue"in e)this.Et(t,5);else if("booleanValue"in e)this.Et(t,10),t.dt(e.booleanValue?1:0);else if("integerValue"in e)this.Et(t,15),t.dt(Yc(e.integerValue));else if("doubleValue"in e){const n=Yc(e.doubleValue);isNaN(n)?this.Et(t,13):(this.Et(t,15),Fc(n)?t.dt(0):t.dt(n))}else if("timestampValue"in e){const n=e.timestampValue;this.Et(t,20),"string"==typeof n?t.At(n):(t.At(`${n.seconds||""}`),t.dt(n.nanos||0))}else if("stringValue"in e)this.Rt(e.stringValue,t),this.Vt(t);else if("bytesValue"in e)this.Et(t,30),t.ft(Zc(e.bytesValue)),this.Vt(t);else if("referenceValue"in e)this.gt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.Et(t,45),t.dt(n.latitude||0),t.dt(n.longitude||0)}else"mapValue"in e?_u(e)?this.Et(t,Number.MAX_SAFE_INTEGER):(this.yt(e.mapValue,t),this.Vt(t)):"arrayValue"in e?(this.wt(e.arrayValue,t),this.Vt(t)):Qa()}Rt(e,t){this.Et(t,25),this.St(e,t)}St(e,t){t.At(e)}yt(e,t){const n=e.fields||{};this.Et(t,55);for(const e of Object.keys(n))this.Rt(e,t),this.It(n[e],t)}wt(e,t){const n=e.values||[];this.Et(t,50);for(const e of n)this.It(e,t)}gt(e,t){this.Et(t,37),wc.fromName(e).path.forEach((e=>{this.Et(t,60),this.St(e,t)}))}Et(e,t){e.dt(t)}Vt(e){e.dt(2)}}ed.bt=new ed;class td{constructor(){this._n=new nd}addToCollectionParentIndex(e,t){return this._n.add(t),Cc.resolve()}getCollectionParents(e,t){return Cc.resolve(this._n.getEntries(t))}addFieldIndex(e,t){return Cc.resolve()}deleteFieldIndex(e,t){return Cc.resolve()}deleteAllFieldIndexes(e){return Cc.resolve()}createTargetIndexes(e,t){return Cc.resolve()}getDocumentsMatchingTarget(e,t){return Cc.resolve(null)}getIndexType(e,t){return Cc.resolve(0)}getFieldIndexes(e,t){return Cc.resolve([])}getNextCollectionGroupToUpdate(e){return Cc.resolve(null)}getMinOffset(e,t){return Cc.resolve(Ec.min())}getMinOffsetFromCollectionGroup(e,t){return Cc.resolve(Ec.min())}updateCollectionGroup(e,t,n){return Cc.resolve()}updateIndexEntries(e,t){return Cc.resolve()}}class nd{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new Kc(mc.comparator),s=!r.has(n);return this.index[t]=r.add(n),s}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new Kc(mc.comparator)).toArray()}}new Uint8Array(0);class rd{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new rd(e,rd.DEFAULT_COLLECTION_PERCENTILE,rd.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}rd.DEFAULT_COLLECTION_PERCENTILE=10,rd.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,rd.DEFAULT=new rd(41943040,rd.DEFAULT_COLLECTION_PERCENTILE,rd.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),rd.DISABLED=new rd(-1,0,0);class sd{constructor(e){this.On=e}next(){return this.On+=2,this.On}static Nn(){return new sd(0)}static Ln(){return new sd(-1)}}class id{constructor(){this.changes=new hh((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Tu.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?Cc.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class od{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class ad{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(n=r,this.remoteDocumentCache.getEntry(e,t)))).next((e=>(null!==n&&zh(n.mutation,e,Gc.empty(),fc.now()),e)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.getLocalViewOfDocuments(e,t,Eh()).next((()=>t))))}getLocalViewOfDocuments(e,t,n=Eh()){const r=mh();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,n).next((e=>{let t=ph();return e.forEach(((e,n)=>{t=t.insert(e,n.overlayedDocument)})),t}))))}getOverlayedDocuments(e,t){const n=mh();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,Eh())))}populateOverlays(e,t,n){const r=[];return n.forEach((e=>{t.has(e)||r.push(e)})),this.documentOverlayCache.getOverlays(e,r).next((e=>{e.forEach(((e,n)=>{t.set(e,n)}))}))}computeViews(e,t,n,r){let s=dh();const i=vh(),o=vh();return t.forEach(((e,t)=>{const o=n.get(t.key);r.has(t.key)&&(void 0===o||o.mutation instanceof Wh)?s=s.insert(t.key,t):void 0!==o?(i.set(t.key,o.mutation.getFieldMask()),zh(o.mutation,t,o.mutation.getFieldMask(),fc.now())):i.set(t.key,Gc.empty())})),this.recalculateAndSaveOverlays(e,s).next((e=>(e.forEach(((e,t)=>i.set(e,t))),t.forEach(((e,t)=>{var n;return o.set(e,new od(t,null!==(n=i.get(e))&&void 0!==n?n:null))})),o)))}recalculateAndSaveOverlays(e,t){const n=vh();let r=new qc(((e,t)=>e-t)),s=Eh();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((e=>{for(const s of e)s.keys().forEach((e=>{const i=t.get(e);if(null===i)return;let o=n.get(e)||Gc.empty();o=s.applyToLocalView(i,o),n.set(e,o);const a=(r.get(s.batchId)||Eh()).add(e);r=r.insert(s.batchId,a)}))})).next((()=>{const i=[],o=r.getReverseIterator();for(;o.hasNext();){const r=o.getNext(),a=r.key,c=r.value,u=yh();c.forEach((e=>{if(!s.has(e)){const r=qh(t.get(e),n.get(e));null!==r&&u.set(e,r),s=s.add(e)}})),i.push(this.documentOverlayCache.saveOverlays(e,a,u))}return Cc.waitFor(i)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.recalculateAndSaveOverlays(e,t)))}getDocumentsMatchingQuery(e,t,n,r){return function(e){return wc.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Zu(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next((s=>{const i=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-s.size):Cc.resolve(mh());let o=-1,a=s;return i.next((t=>Cc.forEach(t,((t,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),s.get(t)?Cc.resolve():this.remoteDocumentCache.getEntry(e,t).next((e=>{a=a.insert(t,e)}))))).next((()=>this.populateOverlays(e,t,s))).next((()=>this.computeViews(e,a,t,Eh()))).next((e=>({batchId:o,changes:gh(e)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new wc(t)).next((e=>{let t=ph();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const s=t.collectionGroup;let i=ph();return this.indexManager.getCollectionParents(e,s).next((o=>Cc.forEach(o,(o=>{const a=function(e,t){return new Ju(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,o.child(s));return this.getDocumentsMatchingCollectionQuery(e,a,n,r).next((e=>{e.forEach(((e,t)=>{i=i.insert(e,t)}))}))})).next((()=>i))))}getDocumentsMatchingCollectionQuery(e,t,n,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((i=>(s=i,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,s,r)))).next((e=>{s.forEach(((t,n)=>{const r=n.getKey();null===e.get(r)&&(e=e.insert(r,Tu.newInvalidDocument(r)))}));let n=ph();return e.forEach(((e,r)=>{const i=s.get(e);void 0!==i&&zh(i.mutation,r,Gc.empty(),fc.now()),ah(t,r)&&(n=n.insert(e,r))})),n}))}}class cd{constructor(e){this.serializer=e,this.cr=new Map,this.lr=new Map}getBundleMetadata(e,t){return Cc.resolve(this.cr.get(t))}saveBundleMetadata(e,t){return this.cr.set(t.id,function(e){return{id:e.id,version:e.version,createTime:Rl(e.createTime)}}(t)),Cc.resolve()}getNamedQuery(e,t){return Cc.resolve(this.lr.get(t))}saveNamedQuery(e,t){return this.lr.set(t.name,function(e){return{name:e.name,query:Zl(e.bundledQuery),readTime:Rl(e.readTime)}}(t)),Cc.resolve()}}class ud{constructor(){this.overlays=new qc(wc.comparator),this.hr=new Map}getOverlay(e,t){return Cc.resolve(this.overlays.get(t))}getOverlays(e,t){const n=mh();return Cc.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((n,r)=>{this.ht(e,t,r)})),Cc.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.hr.get(n);return void 0!==r&&(r.forEach((e=>this.overlays=this.overlays.remove(e))),this.hr.delete(n)),Cc.resolve()}getOverlaysForCollection(e,t,n){const r=mh(),s=t.length+1,i=new wc(t.child("")),o=this.overlays.getIteratorFrom(i);for(;o.hasNext();){const e=o.getNext().value,i=e.getKey();if(!t.isPrefixOf(i.path))break;i.path.length===s&&e.largestBatchId>n&&r.set(e.getKey(),e)}return Cc.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let s=new qc(((e,t)=>e-t));const i=this.overlays.getIterator();for(;i.hasNext();){const e=i.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=s.get(e.largestBatchId);null===t&&(t=mh(),s=s.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const o=mh(),a=s.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach(((e,t)=>o.set(e,t))),!(o.size()>=r)););return Cc.resolve(o)}ht(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.hr.get(r.largestBatchId).delete(n.key);this.hr.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new nl(t,n));let s=this.hr.get(t);void 0===s&&(s=Eh(),this.hr.set(t,s)),this.hr.set(t,s.add(n.key))}}class hd{constructor(){this.Pr=new Kc(ld.Ir),this.Tr=new Kc(ld.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(e,t){const n=new ld(e,t);this.Pr=this.Pr.add(n),this.Tr=this.Tr.add(n)}dr(e,t){e.forEach((e=>this.addReference(e,t)))}removeReference(e,t){this.Ar(new ld(e,t))}Rr(e,t){e.forEach((e=>this.removeReference(e,t)))}Vr(e){const t=new wc(new mc([])),n=new ld(t,e),r=new ld(t,e+1),s=[];return this.Tr.forEachInRange([n,r],(e=>{this.Ar(e),s.push(e.key)})),s}mr(){this.Pr.forEach((e=>this.Ar(e)))}Ar(e){this.Pr=this.Pr.delete(e),this.Tr=this.Tr.delete(e)}gr(e){const t=new wc(new mc([])),n=new ld(t,e),r=new ld(t,e+1);let s=Eh();return this.Tr.forEachInRange([n,r],(e=>{s=s.add(e.key)})),s}containsKey(e){const t=new ld(e,0),n=this.Pr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class ld{constructor(e,t){this.key=e,this.pr=t}static Ir(e,t){return wc.comparator(e.key,t.key)||lc(e.pr,t.pr)}static Er(e,t){return lc(e.pr,t.pr)||wc.comparator(e.key,t.key)}}class dd{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.yr=1,this.wr=new Kc(ld.Ir)}checkEmpty(e){return Cc.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const s=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const i=new el(s,t,n,r);this.mutationQueue.push(i);for(const t of r)this.wr=this.wr.add(new ld(t.key,s)),this.indexManager.addToCollectionParentIndex(e,t.key.path.popLast());return Cc.resolve(i)}lookupMutationBatch(e,t){return Cc.resolve(this.Sr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.br(n),s=r<0?0:r;return Cc.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return Cc.resolve(0===this.mutationQueue.length?-1:this.yr-1)}getAllMutationBatches(e){return Cc.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new ld(t,0),r=new ld(t,Number.POSITIVE_INFINITY),s=[];return this.wr.forEachInRange([n,r],(e=>{const t=this.Sr(e.pr);s.push(t)})),Cc.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Kc(lc);return t.forEach((e=>{const t=new ld(e,0),r=new ld(e,Number.POSITIVE_INFINITY);this.wr.forEachInRange([t,r],(e=>{n=n.add(e.pr)}))})),Cc.resolve(this.Dr(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let s=n;wc.isDocumentKey(s)||(s=s.child(""));const i=new ld(new wc(s),0);let o=new Kc(lc);return this.wr.forEachWhile((e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.pr)),!0)}),i),Cc.resolve(this.Dr(o))}Dr(e){const t=[];return e.forEach((e=>{const n=this.Sr(e);null!==n&&t.push(n)})),t}removeMutationBatch(e,t){Ja(0===this.Cr(t.batchId,"removed")),this.mutationQueue.shift();let n=this.wr;return Cc.forEach(t.mutations,(r=>{const s=new ld(r.key,t.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.wr=n}))}Mn(e){}containsKey(e,t){const n=new ld(t,0),r=this.wr.firstAfterOrEqual(n);return Cc.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,Cc.resolve()}Cr(e,t){return this.br(e)}br(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Sr(e){const t=this.br(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class fd{constructor(e){this.vr=e,this.docs=new qc(wc.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),s=r?r.size:0,i=this.vr(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:i}),this.size+=i-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return Cc.resolve(n?n.document.mutableCopy():Tu.newInvalidDocument(t))}getEntries(e,t){let n=dh();return t.forEach((e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():Tu.newInvalidDocument(e))})),Cc.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let s=dh();const i=t.path,o=new wc(i.child("")),a=this.docs.getIteratorFrom(o);for(;a.hasNext();){const{key:e,value:{document:o}}=a.getNext();if(!i.isPrefixOf(e.path))break;e.path.length>i.length+1||bc(_c(o),n)<=0||(r.has(o.key)||ah(t,o))&&(s=s.insert(o.key,o.mutableCopy()))}return Cc.resolve(s)}getAllFromCollectionGroup(e,t,n,r){Qa()}Fr(e,t){return Cc.forEach(this.docs,(e=>t(e)))}newChangeBuffer(e){return new pd(this)}getSize(e){return Cc.resolve(this.size)}}class pd extends id{constructor(e){super(),this.ar=e}applyChanges(e){const t=[];return this.changes.forEach(((n,r)=>{r.isValidDocument()?t.push(this.ar.addEntry(e,r)):this.ar.removeEntry(n)})),Cc.waitFor(t)}getFromCache(e,t){return this.ar.getEntry(e,t)}getAllFromCache(e,t){return this.ar.getEntries(e,t)}}class gd{constructor(e){this.persistence=e,this.Mr=new hh((e=>Gu(e)),Wu),this.lastRemoteSnapshotVersion=pc.min(),this.highestTargetId=0,this.Or=0,this.Nr=new hd,this.targetCount=0,this.Lr=sd.Nn()}forEachTarget(e,t){return this.Mr.forEach(((e,n)=>t(n))),Cc.resolve()}getLastRemoteSnapshotVersion(e){return Cc.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Cc.resolve(this.Or)}allocateTargetId(e){return this.highestTargetId=this.Lr.next(),Cc.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Or&&(this.Or=t),Cc.resolve()}qn(e){this.Mr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Lr=new sd(t),this.highestTargetId=t),e.sequenceNumber>this.Or&&(this.Or=e.sequenceNumber)}addTargetData(e,t){return this.qn(t),this.targetCount+=1,Cc.resolve()}updateTargetData(e,t){return this.qn(t),Cc.resolve()}removeTargetData(e,t){return this.Mr.delete(t.target),this.Nr.Vr(t.targetId),this.targetCount-=1,Cc.resolve()}removeTargets(e,t,n){let r=0;const s=[];return this.Mr.forEach(((i,o)=>{o.sequenceNumber<=t&&null===n.get(o.targetId)&&(this.Mr.delete(i),s.push(this.removeMatchingKeysForTargetId(e,o.targetId)),r++)})),Cc.waitFor(s).next((()=>r))}getTargetCount(e){return Cc.resolve(this.targetCount)}getTargetData(e,t){const n=this.Mr.get(t)||null;return Cc.resolve(n)}addMatchingKeys(e,t,n){return this.Nr.dr(t,n),Cc.resolve()}removeMatchingKeys(e,t,n){this.Nr.Rr(t,n);const r=this.persistence.referenceDelegate,s=[];return r&&t.forEach((t=>{s.push(r.markPotentiallyOrphaned(e,t))})),Cc.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Nr.Vr(t),Cc.resolve()}getMatchingKeysForTargetId(e,t){const n=this.Nr.gr(t);return Cc.resolve(n)}containsKey(e,t){return Cc.resolve(this.Nr.containsKey(t))}}class md{constructor(e,t){this.Br={},this.overlays={},this.kr=new Mc(0),this.qr=!1,this.qr=!0,this.referenceDelegate=e(this),this.Qr=new gd(this),this.indexManager=new td,this.remoteDocumentCache=function(e){return new fd(e)}((e=>this.referenceDelegate.Kr(e))),this.serializer=new Yl(t),this.$r=new cd(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new ud,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.Br[e.toKey()];return n||(n=new dd(t,this.referenceDelegate),this.Br[e.toKey()]=n),n}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(e,t,n){Ka("MemoryPersistence","Starting transaction:",e);const r=new yd(this.kr.next());return this.referenceDelegate.Ur(),n(r).next((e=>this.referenceDelegate.Wr(r).next((()=>e)))).toPromise().then((e=>(r.raiseOnCommittedEvent(),e)))}Gr(e,t){return Cc.or(Object.values(this.Br).map((n=>()=>n.containsKey(e,t))))}}class yd extends Ic{constructor(e){super(),this.currentSequenceNumber=e}}class vd{constructor(e){this.persistence=e,this.zr=new hd,this.jr=null}static Hr(e){return new vd(e)}get Jr(){if(this.jr)return this.jr;throw Qa()}addReference(e,t,n){return this.zr.addReference(n,t),this.Jr.delete(n.toString()),Cc.resolve()}removeReference(e,t,n){return this.zr.removeReference(n,t),this.Jr.add(n.toString()),Cc.resolve()}markPotentiallyOrphaned(e,t){return this.Jr.add(t.toString()),Cc.resolve()}removeTarget(e,t){this.zr.Vr(t.targetId).forEach((e=>this.Jr.add(e.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((e=>{e.forEach((e=>this.Jr.add(e.toString())))})).next((()=>n.removeTargetData(e,t)))}Ur(){this.jr=new Set}Wr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Cc.forEach(this.Jr,(n=>{const r=wc.fromPath(n);return this.Yr(e,r).next((e=>{e||t.removeEntry(r,pc.min())}))})).next((()=>(this.jr=null,t.apply(e))))}updateLimboDocument(e,t){return this.Yr(e,t).next((e=>{e?this.Jr.delete(t.toString()):this.Jr.add(t.toString())}))}Kr(e){return 0}Yr(e,t){return Cc.or([()=>Cc.resolve(this.zr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Gr(e,t)])}}class wd{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.qi=n,this.Qi=r}static Ki(e,t){let n=Eh(),r=Eh();for(const e of t.docChanges)switch(e.type){case 0:n=n.add(e.doc.key);break;case 1:r=r.add(e.doc.key)}return new wd(e,t.fromCache,n,r)}}class _d{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class Ed{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=!function(){var t;const n=null===(t=o())||void 0===t?void 0:t.forceEnvironment;if("node"===n)return!0;if("browser"===n)return!1;try{return"[object process]"===Object.prototype.toString.call(e.g.process)}catch(e){return!1}}()&&navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")?8:kc.v(f())>0?6:4}initialize(e,t){this.zi=e,this.indexManager=t,this.$i=!0}getDocumentsMatchingQuery(e,t,n,r){const s={result:null};return this.ji(e,t).next((e=>{s.result=e})).next((()=>{if(!s.result)return this.Hi(e,t,r,n).next((e=>{s.result=e}))})).next((()=>{if(s.result)return;const n=new _d;return this.Ji(e,t,n).next((r=>{if(s.result=r,this.Ui)return this.Yi(e,t,n,r.size)}))})).next((()=>s.result))}Yi(e,t,n,r){return n.documentReadCount<this.Wi?(za()<=D.DEBUG&&Ka("QueryEngine","SDK will not create cache indexes for query:",oh(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),Cc.resolve()):(za()<=D.DEBUG&&Ka("QueryEngine","Query:",oh(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.Gi*r?(za()<=D.DEBUG&&Ka("QueryEngine","The SDK decides to create cache indexes for query:",oh(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,th(t))):Cc.resolve())}ji(e,t){if(Yu(t))return Cc.resolve(null);let n=th(t);return this.indexManager.getIndexType(e,n).next((r=>0===r?null:(null!==t.limit&&1===r&&(t=rh(t,null,"F"),n=th(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((r=>{const s=Eh(...r);return this.zi.getDocuments(e,s).next((r=>this.indexManager.getMinOffset(e,n).next((n=>{const i=this.Zi(t,r);return this.Xi(t,i,s,n.readTime)?this.ji(e,rh(t,null,"F")):this.es(e,i,t,n)}))))})))))}Hi(e,t,n,r){return Yu(t)||r.isEqual(pc.min())?Cc.resolve(null):this.zi.getDocuments(e,n).next((s=>{const i=this.Zi(t,s);return this.Xi(t,i,n,r)?Cc.resolve(null):(za()<=D.DEBUG&&Ka("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),oh(t)),this.es(e,i,t,function(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,s=pc.fromTimestamp(1e9===r?new fc(n+1,0):new fc(n,r));return new Ec(s,wc.empty(),t)}(r,-1)).next((e=>e)))}))}Zi(e,t){let n=new Kc(ch(e));return t.forEach(((t,r)=>{ah(e,r)&&(n=n.add(r))})),n}Xi(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const s="F"===e.limitType?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}Ji(e,t,n){return za()<=D.DEBUG&&Ka("QueryEngine","Using full collection scan to execute query:",oh(t)),this.zi.getDocumentsMatchingQuery(e,t,Ec.min(),n)}es(e,t,n,r){return this.zi.getDocumentsMatchingQuery(e,n,r).next((e=>(t.forEach((t=>{e=e.insert(t.key,t)})),e)))}}class bd{constructor(e,t,n,r){this.persistence=e,this.ts=t,this.serializer=r,this.ns=new qc(lc),this.rs=new hh((e=>Gu(e)),Wu),this.ss=new Map,this.os=e.getRemoteDocumentCache(),this.Qr=e.getTargetCache(),this.$r=e.getBundleCache(),this._s(n)}_s(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new ad(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.ns)))}}async function Td(e,t){const n=Xa(e);return await n.persistence.runTransaction("Handle user change","readonly",(e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next((s=>(r=s,n._s(t),n.mutationQueue.getAllMutationBatches(e)))).next((t=>{const s=[],i=[];let o=Eh();for(const e of r){s.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}for(const e of t){i.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}return n.localDocuments.getDocuments(e,o).next((e=>({us:e,removedBatchIds:s,addedBatchIds:i})))}))}))}function Id(e){const t=Xa(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.Qr.getLastRemoteSnapshotVersion(e)))}function Sd(e,t){const n=Xa(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(e=>(void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t))))}async function Cd(e,t,n){const r=Xa(e),s=r.ns.get(t),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,(e=>r.persistence.referenceDelegate.removeTarget(e,s)))}catch(e){if(!Dc(e))throw e;Ka("LocalStore",`Failed to update sequence numbers for target ${t}: ${e}`)}r.ns=r.ns.remove(t),r.rs.delete(s.target)}function Ad(e,t,n){const r=Xa(e);let s=pc.min(),i=Eh();return r.persistence.runTransaction("Execute query","readwrite",(e=>function(e,t,n){const r=Xa(e),s=r.rs.get(n);return void 0!==s?Cc.resolve(r.ns.get(s)):r.Qr.getTargetData(t,n)}(r,e,th(t)).next((t=>{if(t)return s=t.lastLimboFreeSnapshotVersion,r.Qr.getMatchingKeysForTargetId(e,t.targetId).next((e=>{i=e}))})).next((()=>r.ts.getDocumentsMatchingQuery(e,t,n?s:pc.min(),n?i:Eh()))).next((e=>(function(e,t,n){let r=e.ss.get(t)||pc.min();n.forEach(((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)})),e.ss.set(t,r)}(r,function(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}(t),e),{documents:e,hs:i})))))}class kd{constructor(){this.activeTargetIds=bh}As(e){this.activeTargetIds=this.activeTargetIds.add(e)}Rs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}ds(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Rd{constructor(){this.no=new kd,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return this.no.As(e),this.ro[e]||"not-current"}updateQueryState(e,t,n){this.ro[e]=t}removeLocalQueryTarget(e){this.no.Rs(e)}isLocalQueryTarget(e){return this.no.activeTargetIds.has(e)}clearQueryState(e){delete this.ro[e]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(e){return this.no.activeTargetIds.has(e)}start(){return this.no=new kd,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class Nd{io(e){}shutdown(){}}class Dd{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(e){this.uo.push(e)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){Ka("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.uo)e(0)}ao(){Ka("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.uo)e(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let Od=null;function Pd(){return null===Od?Od=268435456+Math.round(2147483648*Math.random()):Od++,"0x"+Od.toString(16)}const Ld={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class xd{constructor(e){this.lo=e.lo,this.ho=e.ho}Po(e){this.Io=e}To(e){this.Eo=e}onMessage(e){this.Ao=e}close(){this.ho()}send(e){this.lo(e)}Ro(){this.Io()}Vo(e){this.Eo(e)}mo(e){this.Ao(e)}}const Md="WebChannelConnection";class Ud extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.fo=t+"://"+e.host,this.po=`projects/${n}/databases/${r}`,this.yo="(default)"===this.databaseId.database?`project_id=${n}`:`project_id=${n}&database_id=${r}`}get wo(){return!1}So(e,t,n,r,s){const i=Pd(),o=this.bo(e,t.toUriEncodedString());Ka("RestConnection",`Sending RPC '${e}' ${i}:`,o,n);const a={"google-cloud-resource-prefix":this.po,"x-goog-request-params":this.yo};return this.Do(a,r,s),this.Co(e,o,a,n).then((t=>(Ka("RestConnection",`Received RPC '${e}' ${i}: `,t),t)),(t=>{throw Ga("RestConnection",`RPC '${e}' ${i} failed with error: `,t,"url: ",o,"request:",n),t}))}vo(e,t,n,r,s,i){return this.So(e,t,n,r,s)}Do(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+qa,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((t,n)=>e[n]=t)),n&&n.headers.forEach(((t,n)=>e[n]=t))}bo(e,t){const n=Ld[e];return`${this.fo}/v1/${t}:${n}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Co(e,t,n,r){const s=Pd();return new Promise(((i,o)=>{const a=new Ua;a.setWithCredentials(!0),a.listenOnce(Pa.COMPLETE,(()=>{try{switch(a.getLastErrorCode()){case Oa.NO_ERROR:const t=a.getResponseJson();Ka(Md,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(t)),i(t);break;case Oa.TIMEOUT:Ka(Md,`RPC '${e}' ${s} timed out`),o(new Za(Ya.DEADLINE_EXCEEDED,"Request time out"));break;case Oa.HTTP_ERROR:const n=a.getStatus();if(Ka(Md,`RPC '${e}' ${s} failed with status:`,n,"response text:",a.getResponseText()),n>0){let e=a.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(Ya).indexOf(t)>=0?t:Ya.UNKNOWN}(t.status);o(new Za(e,t.message))}else o(new Za(Ya.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new Za(Ya.UNAVAILABLE,"Connection failed."));break;default:Qa()}}finally{Ka(Md,`RPC '${e}' ${s} completed.`)}}));const c=JSON.stringify(r);Ka(Md,`RPC '${e}' ${s} sending request:`,r),a.send(t,"POST",c,n,15)}))}Fo(e,t,n){const r=Pd(),s=[this.fo,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=Na(),o=Da(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;void 0!==c&&(a.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(a.useFetchStreams=!0),this.Do(a.initMessageHeaders,t,n),a.encodeInitMessageHeaders=!0;const u=s.join("");Ka(Md,`Creating RPC '${e}' stream ${r}: ${u}`,a);const h=i.createWebChannel(u,a);let l=!1,d=!1;const f=new xd({lo:t=>{d?Ka(Md,`Not sending because RPC '${e}' stream ${r} is closed:`,t):(l||(Ka(Md,`Opening RPC '${e}' stream ${r} transport.`),h.open(),l=!0),Ka(Md,`RPC '${e}' stream ${r} sending:`,t),h.send(t))},ho:()=>h.close()}),p=(e,t,n)=>{e.listen(t,(e=>{try{n(e)}catch(e){setTimeout((()=>{throw e}),0)}}))};return p(h,Ma.EventType.OPEN,(()=>{d||Ka(Md,`RPC '${e}' stream ${r} transport opened.`)})),p(h,Ma.EventType.CLOSE,(()=>{d||(d=!0,Ka(Md,`RPC '${e}' stream ${r} transport closed`),f.Vo())})),p(h,Ma.EventType.ERROR,(t=>{d||(d=!0,Ga(Md,`RPC '${e}' stream ${r} transport errored:`,t),f.Vo(new Za(Ya.UNAVAILABLE,"The operation could not be completed")))})),p(h,Ma.EventType.MESSAGE,(t=>{var n;if(!d){const s=t.data[0];Ja(!!s);const i=s,o=i.error||(null===(n=i[0])||void 0===n?void 0:n.error);if(o){Ka(Md,`RPC '${e}' stream ${r} received error:`,o);const t=o.status;let n=function(e){const t=sl[e];if(void 0!==t)return ol(t)}(t),s=o.message;void 0===n&&(n=Ya.INTERNAL,s="Unknown error status: "+t+" with message "+o.message),d=!0,f.Vo(new Za(n,s)),h.close()}else Ka(Md,`RPC '${e}' stream ${r} received:`,s),f.mo(s)}})),p(o,La.STAT_EVENT,(t=>{t.stat===xa.PROXY?Ka(Md,`RPC '${e}' stream ${r} detected buffering proxy`):t.stat===xa.NOPROXY&&Ka(Md,`RPC '${e}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{f.Ro()}),0),f}}function Fd(){return"undefined"!=typeof document?document:null}function Vd(e){return new Il(e,!0)}class Bd{constructor(e,t,n=1e3,r=1.5,s=6e4){this.oi=e,this.timerId=t,this.Mo=n,this.xo=r,this.Oo=s,this.No=0,this.Lo=null,this.Bo=Date.now(),this.reset()}reset(){this.No=0}ko(){this.No=this.Oo}qo(e){this.cancel();const t=Math.floor(this.No+this.Qo()),n=Math.max(0,Date.now()-this.Bo),r=Math.max(0,t-n);r>0&&Ka("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.No} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.Lo=this.oi.enqueueAfterDelay(this.timerId,r,(()=>(this.Bo=Date.now(),e()))),this.No*=this.xo,this.No<this.Mo&&(this.No=this.Mo),this.No>this.Oo&&(this.No=this.Oo)}Ko(){null!==this.Lo&&(this.Lo.skipDelay(),this.Lo=null)}cancel(){null!==this.Lo&&(this.Lo.cancel(),this.Lo=null)}Qo(){return(Math.random()-.5)*this.No}}class jd{constructor(e,t,n,r,s,i,o,a){this.oi=e,this.$o=n,this.Uo=r,this.connection=s,this.authCredentialsProvider=i,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.Wo=0,this.Go=null,this.zo=null,this.stream=null,this.jo=new Bd(e,t)}Ho(){return 1===this.state||5===this.state||this.Jo()}Jo(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Yo()}async stop(){this.Ho()&&await this.close(0)}Zo(){this.state=0,this.jo.reset()}Xo(){this.Jo()&&null===this.Go&&(this.Go=this.oi.enqueueAfterDelay(this.$o,6e4,(()=>this.e_())))}t_(e){this.n_(),this.stream.send(e)}async e_(){if(this.Jo())return this.close(0)}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}r_(){this.zo&&(this.zo.cancel(),this.zo=null)}async close(e,t){this.n_(),this.r_(),this.jo.cancel(),this.Wo++,4!==e?this.jo.reset():t&&t.code===Ya.RESOURCE_EXHAUSTED?(Ha(t.toString()),Ha("Using maximum backoff delay to prevent overloading the backend."),this.jo.ko()):t&&t.code===Ya.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.i_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.To(t)}i_(){}auth(){this.state=1;const e=this.s_(this.Wo),t=this.Wo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([e,n])=>{this.Wo===t&&this.o_(e,n)}),(t=>{e((()=>{const e=new Za(Ya.UNKNOWN,"Fetching auth token failed: "+t.message);return this.__(e)}))}))}o_(e,t){const n=this.s_(this.Wo);this.stream=this.a_(e,t),this.stream.Po((()=>{n((()=>(this.state=2,this.zo=this.oi.enqueueAfterDelay(this.Uo,1e4,(()=>(this.Jo()&&(this.state=3),Promise.resolve()))),this.listener.Po())))})),this.stream.To((e=>{n((()=>this.__(e)))})),this.stream.onMessage((e=>{n((()=>this.onMessage(e)))}))}Yo(){this.state=5,this.jo.qo((async()=>{this.state=0,this.start()}))}__(e){return Ka("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}s_(e){return t=>{this.oi.enqueueAndForget((()=>this.Wo===e?t():(Ka("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class qd extends jd{constructor(e,t,n,r,s,i){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,i),this.serializer=s}a_(e,t){return this.connection.Fo("Listen",e,t)}onMessage(e){this.jo.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:Qa()}(t.targetChange.targetChangeType||"NO_CHANGE"),s=t.targetChange.targetIds||[],i=function(e,t){return e.useProto3Json?(Ja(void 0===t||"string"==typeof t),Qc.fromBase64String(t||"")):(Ja(void 0===t||t instanceof Uint8Array),Qc.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&function(e){const t=void 0===e.code?Ya.UNKNOWN:ol(e.code);return new Za(t,e.message||"")}(o);n=new ml(r,s,i,a||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const s=Ll(e,r.document.name),i=Rl(r.document.updateTime),o=r.document.createTime?Rl(r.document.createTime):pc.min(),a=new Eu({mapValue:{fields:r.document.fields}}),c=Tu.newFoundDocument(s,i,o,a),u=r.targetIds||[],h=r.removedTargetIds||[];n=new pl(u,h,c.key,c)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const s=Ll(e,r.document),i=r.readTime?Rl(r.readTime):pc.min(),o=Tu.newNoDocument(s,i),a=r.removedTargetIds||[];n=new pl([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const s=Ll(e,r.document),i=r.removedTargetIds||[];n=new pl([],i,s,null)}else{if(!("filter"in t))return Qa();{t.filter;const e=t.filter;e.targetId;const{count:r=0,unchangedNames:s}=e,i=new rl(r,s),o=e.targetId;n=new gl(o,i)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return pc.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?pc.min():t.readTime?Rl(t.readTime):pc.min()}(e);return this.listener.u_(t,n)}c_(e){const t={};t.database=Ml(this.serializer),t.addTarget=function(e,t){let n;const r=t.target;if(n=Qu(r)?{documents:Vl(e,r)}:{query:Bl(e,r).ut},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=Al(e,t.resumeToken);const r=Sl(e,t.expectedCount);null!==r&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(pc.min())>0){n.readTime=Cl(e,t.snapshotVersion.toTimestamp());const r=Sl(e,t.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Qa()}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.t_(t)}l_(e){const t={};t.database=Ml(this.serializer),t.removeTarget=e,this.t_(t)}}class $d extends jd{constructor(e,t,n,r,s,i){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,i),this.serializer=s,this.h_=!1}get P_(){return this.h_}start(){this.h_=!1,this.lastStreamToken=void 0,super.start()}i_(){this.h_&&this.I_([])}a_(e,t){return this.connection.Fo("Write",e,t)}onMessage(e){if(Ja(!!e.streamToken),this.lastStreamToken=e.streamToken,this.h_){this.jo.reset();const t=function(e,t){return e&&e.length>0?(Ja(void 0!==t),e.map((e=>function(e,t){let n=e.updateTime?Rl(e.updateTime):Rl(t);return n.isEqual(pc.min())&&(n=Rl(t)),new Fh(n,e.transformResults||[])}(e,t)))):[]}(e.writeResults,e.commitTime),n=Rl(e.commitTime);return this.listener.T_(n,t)}return Ja(!e.writeResults||0===e.writeResults.length),this.h_=!0,this.listener.E_()}d_(){const e={};e.database=Ml(this.serializer),this.t_(e)}I_(e){const t={streamToken:this.lastStreamToken,writes:e.map((e=>function(e,t){let n;if(t instanceof Gh)n={update:Fl(e,t.key,t.value)};else if(t instanceof Yh)n={delete:Pl(e,t.key)};else if(t instanceof Wh)n={update:Fl(e,t.key,t.data),updateMask:Ql(t.fieldMask)};else{if(!(t instanceof Zh))return Qa();n={verify:Pl(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((e=>function(e,t){const n=t.transform;if(n instanceof Nh)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Dh)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Ph)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof xh)return{fieldPath:t.field.canonicalString(),increment:n.Ie};throw Qa()}(0,e)))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:kl(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:Qa()}(e,t.precondition)),n}(this.serializer,e)))};this.t_(t)}}class zd extends class{}{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.A_=!1}R_(){if(this.A_)throw new Za(Ya.FAILED_PRECONDITION,"The client has already been terminated.")}So(e,t,n,r){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,i])=>this.connection.So(e,Dl(t,n),r,s,i))).catch((e=>{throw"FirebaseError"===e.name?(e.code===Ya.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Za(Ya.UNKNOWN,e.toString())}))}vo(e,t,n,r,s){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,o])=>this.connection.vo(e,Dl(t,n),r,i,o,s))).catch((e=>{throw"FirebaseError"===e.name?(e.code===Ya.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Za(Ya.UNKNOWN,e.toString())}))}terminate(){this.A_=!0,this.connection.terminate()}}class Kd{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.m_=0,this.f_=null,this.g_=!0}p_(){0===this.m_&&(this.y_("Unknown"),this.f_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.f_=null,this.w_("Backend didn't respond within 10 seconds."),this.y_("Offline"),Promise.resolve()))))}S_(e){"Online"===this.state?this.y_("Unknown"):(this.m_++,this.m_>=1&&(this.b_(),this.w_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.y_("Offline")))}set(e){this.b_(),this.m_=0,"Online"===e&&(this.g_=!1),this.y_(e)}y_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}w_(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.g_?(Ha(t),this.g_=!1):Ka("OnlineStateTracker",t)}b_(){null!==this.f_&&(this.f_.cancel(),this.f_=null)}}class Hd{constructor(e,t,n,r,s){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.D_=[],this.C_=new Map,this.v_=new Set,this.F_=[],this.M_=s,this.M_.io((e=>{n.enqueueAndForget((async()=>{tf(this)&&(Ka("RemoteStore","Restarting streams for network reachability change."),await async function(e){const t=Xa(e);t.v_.add(4),await Wd(t),t.x_.set("Unknown"),t.v_.delete(4),await Gd(t)}(this))}))})),this.x_=new Kd(n,r)}}async function Gd(e){if(tf(e))for(const t of e.F_)await t(!0)}async function Wd(e){for(const t of e.F_)await t(!1)}function Qd(e,t){const n=Xa(e);n.C_.has(t.targetId)||(n.C_.set(t.targetId,t),ef(n)?Zd(n):wf(n).Jo()&&Xd(n,t))}function Jd(e,t){const n=Xa(e),r=wf(n);n.C_.delete(t),r.Jo()&&Yd(n,t),0===n.C_.size&&(r.Jo()?r.Xo():tf(n)&&n.x_.set("Unknown"))}function Xd(e,t){if(e.O_.Oe(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(pc.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}wf(e).c_(t)}function Yd(e,t){e.O_.Oe(t),wf(e).l_(t)}function Zd(e){e.O_=new vl({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),_t:t=>e.C_.get(t)||null,nt:()=>e.datastore.serializer.databaseId}),wf(e).start(),e.x_.p_()}function ef(e){return tf(e)&&!wf(e).Ho()&&e.C_.size>0}function tf(e){return 0===Xa(e).v_.size}function nf(e){e.O_=void 0}async function rf(e){e.C_.forEach(((t,n)=>{Xd(e,t)}))}async function sf(e,t){nf(e),ef(e)?(e.x_.S_(t),Zd(e)):e.x_.set("Unknown")}async function of(e,t,n){if(e.x_.set("Online"),t instanceof ml&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.C_.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.C_.delete(r),e.O_.removeTarget(r))}(e,t)}catch(n){Ka("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),await af(e,n)}else if(t instanceof pl?e.O_.$e(t):t instanceof gl?e.O_.Je(t):e.O_.Ge(t),!n.isEqual(pc.min()))try{const t=await Id(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.O_.it(t);return n.targetChanges.forEach(((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const s=e.C_.get(r);s&&e.C_.set(r,s.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach(((t,n)=>{const r=e.C_.get(t);if(!r)return;e.C_.set(t,r.withResumeToken(Qc.EMPTY_BYTE_STRING,r.snapshotVersion)),Yd(e,t);const s=new Xl(r.target,t,n,r.sequenceNumber);Xd(e,s)})),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){Ka("RemoteStore","Failed to raise snapshot:",t),await af(e,t)}}async function af(e,t,n){if(!Dc(t))throw t;e.v_.add(1),await Wd(e),e.x_.set("Offline"),n||(n=()=>Id(e.localStore)),e.asyncQueue.enqueueRetryable((async()=>{Ka("RemoteStore","Retrying IndexedDB access"),await n(),e.v_.delete(1),await Gd(e)}))}function cf(e,t){return t().catch((n=>af(e,n,t)))}async function uf(e){const t=Xa(e),n=_f(t);let r=t.D_.length>0?t.D_[t.D_.length-1].batchId:-1;for(;hf(t);)try{const e=await Sd(t.localStore,r);if(null===e){0===t.D_.length&&n.Xo();break}r=e.batchId,lf(t,e)}catch(e){await af(t,e)}df(t)&&ff(t)}function hf(e){return tf(e)&&e.D_.length<10}function lf(e,t){e.D_.push(t);const n=_f(e);n.Jo()&&n.P_&&n.I_(t.mutations)}function df(e){return tf(e)&&!_f(e).Ho()&&e.D_.length>0}function ff(e){_f(e).start()}async function pf(e){_f(e).d_()}async function gf(e){const t=_f(e);for(const n of e.D_)t.I_(n.mutations)}async function mf(e,t,n){const r=e.D_.shift(),s=tl.from(r,t,n);await cf(e,(()=>e.remoteSyncer.applySuccessfulWrite(s))),await uf(e)}async function yf(e,t){t&&_f(e).P_&&await async function(e,t){if(function(e){return function(e){switch(e){default:return Qa();case Ya.CANCELLED:case Ya.UNKNOWN:case Ya.DEADLINE_EXCEEDED:case Ya.RESOURCE_EXHAUSTED:case Ya.INTERNAL:case Ya.UNAVAILABLE:case Ya.UNAUTHENTICATED:return!1;case Ya.INVALID_ARGUMENT:case Ya.NOT_FOUND:case Ya.ALREADY_EXISTS:case Ya.PERMISSION_DENIED:case Ya.FAILED_PRECONDITION:case Ya.ABORTED:case Ya.OUT_OF_RANGE:case Ya.UNIMPLEMENTED:case Ya.DATA_LOSS:return!0}}(e)&&e!==Ya.ABORTED}(t.code)){const n=e.D_.shift();_f(e).Zo(),await cf(e,(()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t))),await uf(e)}}(e,t),df(e)&&ff(e)}async function vf(e,t){const n=Xa(e);n.asyncQueue.verifyOperationInProgress(),Ka("RemoteStore","RemoteStore received new credentials");const r=tf(n);n.v_.add(3),await Wd(n),r&&n.x_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.v_.delete(3),await Gd(n)}function wf(e){return e.N_||(e.N_=function(e,t,n){const r=Xa(e);return r.R_(),new qd(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Po:rf.bind(null,e),To:sf.bind(null,e),u_:of.bind(null,e)}),e.F_.push((async t=>{t?(e.N_.Zo(),ef(e)?Zd(e):e.x_.set("Unknown")):(await e.N_.stop(),nf(e))}))),e.N_}function _f(e){return e.L_||(e.L_=function(e,t,n){const r=Xa(e);return r.R_(),new $d(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Po:pf.bind(null,e),To:yf.bind(null,e),E_:gf.bind(null,e),T_:mf.bind(null,e)}),e.F_.push((async t=>{t?(e.L_.Zo(),await uf(e)):(await e.L_.stop(),e.D_.length>0&&(Ka("RemoteStore",`Stopping write stream with ${e.D_.length} pending writes`),e.D_=[]))}))),e.L_}class Ef{constructor(e,t,n,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=s,this.deferred=new ec,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((e=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,s){const i=Date.now()+n,o=new Ef(e,t,i,r,s);return o.start(n),o}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Za(Ya.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function bf(e,t){if(Ha("AsyncQueue",`${t}: ${e}`),Dc(e))return new Za(Ya.UNAVAILABLE,`${t}: ${e}`);throw e}class Tf{constructor(e){this.comparator=e?(t,n)=>e(t,n)||wc.comparator(t.key,n.key):(e,t)=>wc.comparator(e.key,t.key),this.keyedMap=ph(),this.sortedSet=new qc(this.comparator)}static emptySet(e){return new Tf(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Tf))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new Tf;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class If{constructor(){this.B_=new qc(wc.comparator)}track(e){const t=e.doc.key,n=this.B_.get(t);n?0!==e.type&&3===n.type?this.B_=this.B_.insert(t,e):3===e.type&&1!==n.type?this.B_=this.B_.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.B_=this.B_.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.B_=this.B_.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.B_=this.B_.remove(t):1===e.type&&2===n.type?this.B_=this.B_.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.B_=this.B_.insert(t,{type:2,doc:e.doc}):Qa():this.B_=this.B_.insert(t,e)}k_(){const e=[];return this.B_.inorderTraversal(((t,n)=>{e.push(n)})),e}}class Sf{constructor(e,t,n,r,s,i,o,a,c){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=s,this.fromCache=i,this.syncStateChanged=o,this.excludesMetadataChanges=a,this.hasCachedResults=c}static fromInitialDocuments(e,t,n,r,s){const i=[];return t.forEach((e=>{i.push({type:0,doc:e})})),new Sf(e,t,Tf.emptySet(t),i,n,r,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&sh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let e=0;e<t.length;e++)if(t[e].type!==n[e].type||!t[e].doc.isEqual(n[e].doc))return!1;return!0}}class Cf{constructor(){this.q_=void 0,this.Q_=[]}K_(){return this.Q_.some((e=>e.U_()))}}class Af{constructor(){this.queries=new hh((e=>ih(e)),sh),this.onlineState="Unknown",this.W_=new Set}}async function kf(e,t){const n=Xa(e);let r=3;const s=t.query;let i=n.queries.get(s);i?!i.K_()&&t.U_()&&(r=2):(i=new Cf,r=t.U_()?0:1);try{switch(r){case 0:i.q_=await n.onListen(s,!0);break;case 1:i.q_=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(e){const n=bf(e,`Initialization of query '${oh(t.query)}' failed`);return void t.onError(n)}n.queries.set(s,i),i.Q_.push(t),t.G_(n.onlineState),i.q_&&t.z_(i.q_)&&Df(n)}function Rf(e,t){const n=Xa(e);let r=!1;for(const e of t){const t=e.query,s=n.queries.get(t);if(s){for(const t of s.Q_)t.z_(e)&&(r=!0);s.q_=e}}r&&Df(n)}function Nf(e,t,n){const r=Xa(e),s=r.queries.get(t);if(s)for(const e of s.Q_)e.onError(n);r.queries.delete(t)}function Df(e){e.W_.forEach((e=>{e.next()}))}var Of,Pf;(Pf=Of||(Of={})).j_="default",Pf.Cache="cache";class Lf{constructor(e,t,n){this.query=e,this.H_=t,this.J_=!1,this.Y_=null,this.onlineState="Unknown",this.options=n||{}}z_(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new Sf(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.J_?this.Z_(e)&&(this.H_.next(e),t=!0):this.X_(e,this.onlineState)&&(this.ea(e),t=!0),this.Y_=e,t}onError(e){this.H_.error(e)}G_(e){this.onlineState=e;let t=!1;return this.Y_&&!this.J_&&this.X_(this.Y_,e)&&(this.ea(this.Y_),t=!0),t}X_(e,t){if(!e.fromCache)return!0;if(!this.U_())return!0;const n="Offline"!==t;return(!this.options.ta||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Z_(e){if(e.docChanges.length>0)return!0;const t=this.Y_&&this.Y_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}ea(e){e=Sf.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.J_=!0,this.H_.next(e)}U_(){return this.options.source!==Of.Cache}}class xf{constructor(e){this.key=e}}class Mf{constructor(e){this.key=e}}class Uf{constructor(e,t){this.query=e,this.ua=t,this.ca=null,this.hasCachedResults=!1,this.current=!1,this.la=Eh(),this.mutatedKeys=Eh(),this.ha=ch(e),this.Pa=new Tf(this.ha)}get Ia(){return this.ua}Ta(e,t){const n=t?t.Ea:new If,r=t?t.Pa:this.Pa;let s=t?t.mutatedKeys:this.mutatedKeys,i=r,o=!1;const a="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,c="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((e,t)=>{const u=r.get(e),h=ah(this.query,t)?t:null,l=!!u&&this.mutatedKeys.has(u.key),d=!!h&&(h.hasLocalMutations||this.mutatedKeys.has(h.key)&&h.hasCommittedMutations);let f=!1;u&&h?u.data.isEqual(h.data)?l!==d&&(n.track({type:3,doc:h}),f=!0):this.da(u,h)||(n.track({type:2,doc:h}),f=!0,(a&&this.ha(h,a)>0||c&&this.ha(h,c)<0)&&(o=!0)):!u&&h?(n.track({type:0,doc:h}),f=!0):u&&!h&&(n.track({type:1,doc:u}),f=!0,(a||c)&&(o=!0)),f&&(h?(i=i.add(h),s=d?s.add(e):s.delete(e)):(i=i.delete(e),s=s.delete(e)))})),null!==this.query.limit)for(;i.size>this.query.limit;){const e="F"===this.query.limitType?i.last():i.first();i=i.delete(e.key),s=s.delete(e.key),n.track({type:1,doc:e})}return{Pa:i,Ea:n,Xi:o,mutatedKeys:s}}da(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){const s=this.Pa;this.Pa=e.Pa,this.mutatedKeys=e.mutatedKeys;const i=e.Ea.k_();i.sort(((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Qa()}};return n(e)-n(t)}(e.type,t.type)||this.ha(e.doc,t.doc))),this.Aa(n),r=null!=r&&r;const o=t&&!r?this.Ra():[],a=0===this.la.size&&this.current&&!r?1:0,c=a!==this.ca;return this.ca=a,0!==i.length||c?{snapshot:new Sf(this.query,e.Pa,s,i,e.mutatedKeys,0===a,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),Va:o}:{Va:o}}G_(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Pa:this.Pa,Ea:new If,mutatedKeys:this.mutatedKeys,Xi:!1},!1)):{Va:[]}}ma(e){return!this.ua.has(e)&&!!this.Pa.has(e)&&!this.Pa.get(e).hasLocalMutations}Aa(e){e&&(e.addedDocuments.forEach((e=>this.ua=this.ua.add(e))),e.modifiedDocuments.forEach((e=>{})),e.removedDocuments.forEach((e=>this.ua=this.ua.delete(e))),this.current=e.current)}Ra(){if(!this.current)return[];const e=this.la;this.la=Eh(),this.Pa.forEach((e=>{this.ma(e.key)&&(this.la=this.la.add(e.key))}));const t=[];return e.forEach((e=>{this.la.has(e)||t.push(new Mf(e))})),this.la.forEach((n=>{e.has(n)||t.push(new xf(n))})),t}fa(e){this.ua=e.hs,this.la=Eh();const t=this.Ta(e.documents);return this.applyChanges(t,!0)}ga(){return Sf.fromInitialDocuments(this.query,this.Pa,this.mutatedKeys,0===this.ca,this.hasCachedResults)}}class Ff{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class Vf{constructor(e){this.key=e,this.pa=!1}}class Bf{constructor(e,t,n,r,s,i){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=i,this.ya={},this.wa=new hh((e=>ih(e)),sh),this.Sa=new Map,this.ba=new Set,this.Da=new qc(wc.comparator),this.Ca=new Map,this.va=new hd,this.Fa={},this.Ma=new Map,this.xa=sd.Ln(),this.onlineState="Unknown",this.Oa=void 0}get isPrimaryClient(){return!0===this.Oa}}async function jf(e,t,n=!0){const r=ap(e);let s;const i=r.wa.get(t);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.ga()):s=await $f(r,t,n,!0),s}async function qf(e,t){const n=ap(e);await $f(n,t,!0,!1)}async function $f(e,t,n,r){const s=await function(e,t){const n=Xa(e);return n.persistence.runTransaction("Allocate target","readwrite",(e=>{let r;return n.Qr.getTargetData(e,t).next((s=>s?(r=s,Cc.resolve(r)):n.Qr.allocateTargetId(e).next((s=>(r=new Xl(t,s,"TargetPurposeListen",e.currentSequenceNumber),n.Qr.addTargetData(e,r).next((()=>r)))))))})).then((e=>{const r=n.ns.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.ns=n.ns.insert(e.targetId,e),n.rs.set(t,e.targetId)),e}))}(e.localStore,th(t)),i=s.targetId,o=n?e.sharedClientState.addLocalQueryTarget(i):"not-current";let a;return r&&(a=await async function(e,t,n,r,s){e.Na=(t,n,r)=>async function(e,t,n,r){let s=t.view.Ta(n);s.Xi&&(s=await Ad(e.localStore,t.query,!1).then((({documents:e})=>t.view.Ta(e,s))));const i=r&&r.targetChanges.get(t.targetId),o=r&&null!=r.targetMismatches.get(t.targetId),a=t.view.applyChanges(s,e.isPrimaryClient,i,o);return tp(e,t.targetId,a.Va),a.snapshot}(e,t,n,r);const i=await Ad(e.localStore,t,!0),o=new Uf(t,i.hs),a=o.Ta(i.documents),c=fl.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,s),u=o.applyChanges(a,e.isPrimaryClient,c);tp(e,n,u.Va);const h=new Ff(t,n,o);return e.wa.set(t,h),e.Sa.has(n)?e.Sa.get(n).push(t):e.Sa.set(n,[t]),u.snapshot}(e,t,i,"current"===o,s.resumeToken)),e.isPrimaryClient&&n&&Qd(e.remoteStore,s),a}async function zf(e,t,n){const r=Xa(e),s=r.wa.get(t),i=r.Sa.get(s.targetId);if(i.length>1)return r.Sa.set(s.targetId,i.filter((e=>!sh(e,t)))),void r.wa.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Cd(r.localStore,s.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(s.targetId),n&&Jd(r.remoteStore,s.targetId),Zf(r,s.targetId)})).catch(Sc)):(Zf(r,s.targetId),await Cd(r.localStore,s.targetId,!0))}async function Kf(e,t){const n=Xa(e),r=n.wa.get(t),s=n.Sa.get(r.targetId);n.isPrimaryClient&&1===s.length&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Jd(n.remoteStore,r.targetId))}async function Hf(e,t){const n=Xa(e);try{const e=await function(e,t){const n=Xa(e),r=t.snapshotVersion;let s=n.ns;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(e=>{const i=n.os.newChangeBuffer({trackRemovals:!0});s=n.ns;const o=[];t.targetChanges.forEach(((i,a)=>{const c=s.get(a);if(!c)return;o.push(n.Qr.removeMatchingKeys(e,i.removedDocuments,a).next((()=>n.Qr.addMatchingKeys(e,i.addedDocuments,a))));let u=c.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(a)?u=u.withResumeToken(Qc.EMPTY_BYTE_STRING,pc.min()).withLastLimboFreeSnapshotVersion(pc.min()):i.resumeToken.approximateByteSize()>0&&(u=u.withResumeToken(i.resumeToken,r)),s=s.insert(a,u),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(c,u,i)&&o.push(n.Qr.updateTargetData(e,u))}));let a=dh(),c=Eh();if(t.documentUpdates.forEach((r=>{t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))})),o.push(function(e,t,n){let r=Eh(),s=Eh();return n.forEach((e=>r=r.add(e))),t.getEntries(e,r).next((e=>{let r=dh();return n.forEach(((n,i)=>{const o=e.get(n);i.isFoundDocument()!==o.isFoundDocument()&&(s=s.add(n)),i.isNoDocument()&&i.version.isEqual(pc.min())?(t.removeEntry(n,i.readTime),r=r.insert(n,i)):!o.isValidDocument()||i.version.compareTo(o.version)>0||0===i.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(i),r=r.insert(n,i)):Ka("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",i.version)})),{cs:r,ls:s}}))}(e,i,t.documentUpdates).next((e=>{a=e.cs,c=e.ls}))),!r.isEqual(pc.min())){const t=n.Qr.getLastRemoteSnapshotVersion(e).next((t=>n.Qr.setTargetsMetadata(e,e.currentSequenceNumber,r)));o.push(t)}return Cc.waitFor(o).next((()=>i.apply(e))).next((()=>n.localDocuments.getLocalViewOfDocuments(e,a,c))).next((()=>a))})).then((e=>(n.ns=s,e)))}(n.localStore,t);t.targetChanges.forEach(((e,t)=>{const r=n.Ca.get(t);r&&(Ja(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?r.pa=!0:e.modifiedDocuments.size>0?Ja(r.pa):e.removedDocuments.size>0&&(Ja(r.pa),r.pa=!1))})),await sp(n,e,t)}catch(e){await Sc(e)}}function Gf(e,t,n){const r=Xa(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.wa.forEach(((n,r)=>{const s=r.view.G_(t);s.snapshot&&e.push(s.snapshot)})),function(e,t){const n=Xa(e);n.onlineState=t;let r=!1;n.queries.forEach(((e,n)=>{for(const e of n.Q_)e.G_(t)&&(r=!0)})),r&&Df(n)}(r.eventManager,t),e.length&&r.ya.u_(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function Wf(e,t,n){const r=Xa(e);r.sharedClientState.updateQueryState(t,"rejected",n);const s=r.Ca.get(t),i=s&&s.key;if(i){let e=new qc(wc.comparator);e=e.insert(i,Tu.newNoDocument(i,pc.min()));const n=Eh().add(i),s=new dl(pc.min(),new Map,new qc(lc),e,n);await Hf(r,s),r.Da=r.Da.remove(i),r.Ca.delete(t),rp(r)}else await Cd(r.localStore,t,!1).then((()=>Zf(r,t,n))).catch(Sc)}async function Qf(e,t){const n=Xa(e),r=t.batch.batchId;try{const e=await function(e,t){const n=Xa(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(e=>{const r=t.batch.keys(),s=n.os.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const s=n.batch,i=s.keys();let o=Cc.resolve();return i.forEach((e=>{o=o.next((()=>r.getEntry(t,e))).next((t=>{const i=n.docVersions.get(e);Ja(null!==i),t.version.compareTo(i)<0&&(s.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))}))})),o.next((()=>e.mutationQueue.removeMutationBatch(t,s)))}(n,e,t,s).next((()=>s.apply(e))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=Eh();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t)))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(n.localStore,t);Yf(n,r,null),Xf(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await sp(n,e)}catch(e){await Sc(e)}}async function Jf(e,t,n){const r=Xa(e);try{const e=await function(e,t){const n=Xa(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next((t=>(Ja(null!==t),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t)))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(r.localStore,t);Yf(r,t,n),Xf(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await sp(r,e)}catch(n){await Sc(n)}}function Xf(e,t){(e.Ma.get(t)||[]).forEach((e=>{e.resolve()})),e.Ma.delete(t)}function Yf(e,t,n){const r=Xa(e);let s=r.Fa[r.currentUser.toKey()];if(s){const e=s.get(t);e&&(n?e.reject(n):e.resolve(),s=s.remove(t)),r.Fa[r.currentUser.toKey()]=s}}function Zf(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.Sa.get(t))e.wa.delete(r),n&&e.ya.La(r,n);e.Sa.delete(t),e.isPrimaryClient&&e.va.Vr(t).forEach((t=>{e.va.containsKey(t)||ep(e,t)}))}function ep(e,t){e.ba.delete(t.path.canonicalString());const n=e.Da.get(t);null!==n&&(Jd(e.remoteStore,n),e.Da=e.Da.remove(t),e.Ca.delete(n),rp(e))}function tp(e,t,n){for(const r of n)r instanceof xf?(e.va.addReference(r.key,t),np(e,r)):r instanceof Mf?(Ka("SyncEngine","Document no longer in limbo: "+r.key),e.va.removeReference(r.key,t),e.va.containsKey(r.key)||ep(e,r.key)):Qa()}function np(e,t){const n=t.key,r=n.path.canonicalString();e.Da.get(n)||e.ba.has(r)||(Ka("SyncEngine","New document in limbo: "+n),e.ba.add(r),rp(e))}function rp(e){for(;e.ba.size>0&&e.Da.size<e.maxConcurrentLimboResolutions;){const t=e.ba.values().next().value;e.ba.delete(t);const n=new wc(mc.fromString(t)),r=e.xa.next();e.Ca.set(r,new Vf(n)),e.Da=e.Da.insert(n,r),Qd(e.remoteStore,new Xl(th(Xu(n.path)),r,"TargetPurposeLimboResolution",Mc._e))}}async function sp(e,t,n){const r=Xa(e),s=[],i=[],o=[];r.wa.isEmpty()||(r.wa.forEach(((e,a)=>{o.push(r.Na(a,t,n).then((e=>{if((e||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(a.targetId,(null==e?void 0:e.fromCache)?"not-current":"current"),e){s.push(e);const t=wd.Ki(a.targetId,e);i.push(t)}})))})),await Promise.all(o),r.ya.u_(s),await async function(e,t){const n=Xa(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(e=>Cc.forEach(t,(t=>Cc.forEach(t.qi,(r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r))).next((()=>Cc.forEach(t.Qi,(r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))))))}catch(e){if(!Dc(e))throw e;Ka("LocalStore","Failed to update sequence numbers: "+e)}for(const e of t){const t=e.targetId;if(!e.fromCache){const e=n.ns.get(t),r=e.snapshotVersion,s=e.withLastLimboFreeSnapshotVersion(r);n.ns=n.ns.insert(t,s)}}}(r.localStore,i))}async function ip(e,t){const n=Xa(e);if(!n.currentUser.isEqual(t)){Ka("SyncEngine","User change. New user:",t.toKey());const e=await Td(n.localStore,t);n.currentUser=t,function(e,t){e.Ma.forEach((e=>{e.forEach((e=>{e.reject(new Za(Ya.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),e.Ma.clear()}(n),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await sp(n,e.us)}}function op(e,t){const n=Xa(e),r=n.Ca.get(t);if(r&&r.pa)return Eh().add(r.key);{let e=Eh();const r=n.Sa.get(t);if(!r)return e;for(const t of r){const r=n.wa.get(t);e=e.unionWith(r.view.Ia)}return e}}function ap(e){const t=Xa(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=Hf.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=op.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Wf.bind(null,t),t.ya.u_=Rf.bind(null,t.eventManager),t.ya.La=Nf.bind(null,t.eventManager),t}function cp(e){const t=Xa(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Qf.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Jf.bind(null,t),t}class up{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=Vd(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return function(e,t,n,r){return new bd(e,t,n,r)}(this.persistence,new Ed,e.initialUser,this.serializer)}createPersistence(e){return new md(vd.Hr,this.serializer)}createSharedClientState(e){return new Rd}async terminate(){var e,t;null===(e=this.gcScheduler)||void 0===e||e.stop(),null===(t=this.indexBackfillerScheduler)||void 0===t||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class hp{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>Gf(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=ip.bind(null,this.syncEngine),await async function(e,t){const n=Xa(e);t?(n.v_.delete(2),await Gd(n)):t||(n.v_.add(2),await Wd(n),n.x_.set("Unknown"))}(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new Af}createDatastore(e){const t=Vd(e.databaseInfo.databaseId),n=function(e){return new Ud(e)}(e.databaseInfo);return function(e,t,n,r){return new zd(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,r,s){return new Hd(e,t,n,r,s)}(this.localStore,this.datastore,e.asyncQueue,(e=>Gf(this.syncEngine,e,0)),Dd.D()?new Dd:new Nd)}createSyncEngine(e,t){return function(e,t,n,r,s,i,o){const a=new Bf(e,t,n,r,s,i);return o&&(a.Oa=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e;await async function(e){const t=Xa(e);Ka("RemoteStore","RemoteStore shutting down."),t.v_.add(5),await Wd(t),t.M_.shutdown(),t.x_.set("Unknown")}(this.remoteStore),null===(e=this.datastore)||void 0===e||e.terminate()}}class lp{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.qa(this.observer.next,e)}error(e){this.observer.error?this.qa(this.observer.error,e):Ha("Uncaught Error in snapshot listener:",e.toString())}Qa(){this.muted=!0}qa(e,t){this.muted||setTimeout((()=>{this.muted||e(t)}),0)}}class dp{constructor(e,t,n,r){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=ja.UNAUTHENTICATED,this.clientId=hc.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,(async e=>{Ka("FirestoreClient","Received user=",e.uid),await this.authCredentialListener(e),this.user=e})),this.appCheckCredentials.start(n,(e=>(Ka("FirestoreClient","Received new app check token=",e),this.appCheckCredentialListener(e,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Za(Ya.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ec;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=bf(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function fp(e,t){e.asyncQueue.verifyOperationInProgress(),Ka("FirestoreClient","Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener((async e=>{r.isEqual(e)||(await Td(t.localStore,e),r=e)})),t.persistence.setDatabaseDeletedListener((()=>e.terminate())),e._offlineComponents=t}async function pp(e,t){e.asyncQueue.verifyOperationInProgress();const n=await async function(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){Ka("FirestoreClient","Using user provided OfflineComponentProvider");try{await fp(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(e){return"FirebaseError"===e.name?e.code===Ya.FAILED_PRECONDITION||e.code===Ya.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}(n))throw n;Ga("Error using user provided cache. Falling back to memory cache: "+n),await fp(e,new up)}}else Ka("FirestoreClient","Using default OfflineComponentProvider"),await fp(e,new up);return e._offlineComponents}(e);Ka("FirestoreClient","Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener((e=>vf(t.remoteStore,e))),e.setAppCheckTokenChangeListener(((e,n)=>vf(t.remoteStore,n))),e._onlineComponents=t}async function gp(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(Ka("FirestoreClient","Using user provided OnlineComponentProvider"),await pp(e,e._uninitializedComponentsProvider._online)):(Ka("FirestoreClient","Using default OnlineComponentProvider"),await pp(e,new hp))),e._onlineComponents}async function mp(e){const t=await gp(e),n=t.eventManager;return n.onListen=jf.bind(null,t.syncEngine),n.onUnlisten=zf.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=qf.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=Kf.bind(null,t.syncEngine),n}function yp(e,t,n={}){const r=new ec;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,s){const i=new lp({next:n=>{t.enqueueAndForget((()=>async function(e,t){const n=Xa(e),r=t.query;let s=3;const i=n.queries.get(r);if(i){const e=i.Q_.indexOf(t);e>=0&&(i.Q_.splice(e,1),0===i.Q_.length?s=t.U_()?0:1:!i.K_()&&t.U_()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}(e,o))),n.fromCache&&"server"===r.source?s.reject(new Za(Ya.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):s.resolve(n)},error:e=>s.reject(e)}),o=new Lf(n,i,{includeMetadataChanges:!0,ta:!0});return kf(e,o)}(await mp(e),e.asyncQueue,t,n,r))),r.promise}function vp(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const wp=new Map;function _p(e,t,n){if(!n)throw new Za(Ya.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function Ep(e){if(!wc.isDocumentKey(e))throw new Za(Ya.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function bp(e){if(wc.isDocumentKey(e))throw new Za(Ya.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function Tp(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return"function"==typeof e?"a function":Qa()}function Ip(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Za(Ya.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Tp(e);throw new Za(Ya.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}class Sp{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new Za(Ya.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Za(Ya.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,r){if(!0===t&&!0===r)throw new Za(Ya.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")})(0,e.experimentalForceLongPolling,0,e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=vp(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new Za(Ya.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new Za(Ya.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new Za(Ya.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Cp{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Sp({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Za(Ya.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Za(Ya.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Sp(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new nc;switch(e.type){case"firstParty":return new oc(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new Za(Ya.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=wp.get(e);t&&(Ka("ComponentProvider","Removing Datastore"),wp.delete(e),t.terminate())}(this),Promise.resolve()}}class Ap{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Ap(this.firestore,e,this._query)}}class kp{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Rp(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new kp(this.firestore,e,this._key)}}class Rp extends Ap{constructor(e,t,n){super(e,t,Xu(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new kp(this.firestore,null,new wc(e))}withConverter(e){return new Rp(this.firestore,e,this._path)}}function Np(e,t,...n){if(e=S(e),_p("collection","path",t),e instanceof Cp){const r=mc.fromString(t,...n);return bp(r),new Rp(e,null,r)}{if(!(e instanceof kp||e instanceof Rp))throw new Za(Ya.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(mc.fromString(t,...n));return bp(r),new Rp(e.firestore,null,r)}}function Dp(e,t,...n){if(e=S(e),1===arguments.length&&(t=hc.newId()),_p("doc","path",t),e instanceof Cp){const r=mc.fromString(t,...n);return Ep(r),new kp(e,null,new wc(r))}{if(!(e instanceof kp||e instanceof Rp))throw new Za(Ya.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(mc.fromString(t,...n));return Ep(r),new kp(e.firestore,e instanceof Rp?e.converter:null,new wc(r))}}class Op{constructor(){this.nu=Promise.resolve(),this.ru=[],this.iu=!1,this.su=[],this.ou=null,this._u=!1,this.au=!1,this.uu=[],this.jo=new Bd(this,"async_queue_retry"),this.cu=()=>{const e=Fd();e&&Ka("AsyncQueue","Visibility state changed to "+e.visibilityState),this.jo.Ko()};const e=Fd();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.cu)}get isShuttingDown(){return this.iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.lu(),this.hu(e)}enterRestrictedMode(e){if(!this.iu){this.iu=!0,this.au=e||!1;const t=Fd();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.cu)}}enqueue(e){if(this.lu(),this.iu)return new Promise((()=>{}));const t=new ec;return this.hu((()=>this.iu&&this.au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.ru.push(e),this.Pu())))}async Pu(){if(0!==this.ru.length){try{await this.ru[0](),this.ru.shift(),this.jo.reset()}catch(e){if(!Dc(e))throw e;Ka("AsyncQueue","Operation failed with retryable error: "+e)}this.ru.length>0&&this.jo.qo((()=>this.Pu()))}}hu(e){const t=this.nu.then((()=>(this._u=!0,e().catch((e=>{this.ou=e,this._u=!1;const t=function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw Ha("INTERNAL UNHANDLED ERROR: ",t),e})).then((e=>(this._u=!1,e))))));return this.nu=t,t}enqueueAfterDelay(e,t,n){this.lu(),this.uu.indexOf(e)>-1&&(t=0);const r=Ef.createAndSchedule(this,e,t,n,(e=>this.Iu(e)));return this.su.push(r),r}lu(){this.ou&&Qa()}verifyOperationInProgress(){}async Tu(){let e;do{e=this.nu,await e}while(e!==this.nu)}Eu(e){for(const t of this.su)if(t.timerId===e)return!0;return!1}du(e){return this.Tu().then((()=>{this.su.sort(((e,t)=>e.targetTimeMs-t.targetTimeMs));for(const t of this.su)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Tu()}))}Au(e){this.uu.push(e)}Iu(e){const t=this.su.indexOf(e);this.su.splice(t,1)}}function Pp(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const e of["next","error","complete"])if(e in n&&"function"==typeof n[e])return!0;return!1}(e)}class Lp extends Cp{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new Op,this._persistenceKey=(null==r?void 0:r.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||Mp(this),this._firestoreClient.terminate()}}function xp(e){return e._firestoreClient||Mp(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function Mp(e){var t,n,r;const s=e._freezeSettings(),i=function(e,t,n,r){return new ru(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,vp(r.experimentalLongPollingOptions),r.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,s);e._firestoreClient=new dp(e._authCredentials,e._appCheckCredentials,e._queue,i),(null===(n=s.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(r=s.localCache)||void 0===r?void 0:r._onlineComponentProvider)&&(e._firestoreClient._uninitializedComponentsProvider={_offlineKind:s.localCache.kind,_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider})}class Up{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Up(Qc.fromBase64String(e))}catch(e){throw new Za(Ya.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new Up(Qc.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class Fp{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new Za(Ya.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new vc(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Vp{constructor(e){this._methodName=e}}class Bp{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Za(Ya.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Za(Ya.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return lc(this._lat,e._lat)||lc(this._long,e._long)}}const jp=/^__.*__$/;class qp{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new Wh(e,this.data,this.fieldMask,t,this.fieldTransforms):new Gh(e,this.data,t,this.fieldTransforms)}}function $p(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Qa()}}class zp{constructor(e,t,n,r,s,i){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===s&&this.Ru(),this.fieldTransforms=s||[],this.fieldMask=i||[]}get path(){return this.settings.path}get Vu(){return this.settings.Vu}mu(e){return new zp(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}fu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.mu({path:n,gu:!1});return r.pu(e),r}yu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.mu({path:n,gu:!1});return r.Ru(),r}wu(e){return this.mu({path:void 0,gu:!0})}Su(e){return tg(e,this.settings.methodName,this.settings.bu||!1,this.path,this.settings.Du)}contains(e){return void 0!==this.fieldMask.find((t=>e.isPrefixOf(t)))||void 0!==this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))}Ru(){if(this.path)for(let e=0;e<this.path.length;e++)this.pu(this.path.get(e))}pu(e){if(0===e.length)throw this.Su("Document fields must not be empty");if($p(this.Vu)&&jp.test(e))throw this.Su('Document fields cannot begin and end with "__"')}}class Kp{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||Vd(e)}Cu(e,t,n,r=!1){return new zp({Vu:e,methodName:t,Du:n,path:vc.emptyPath(),gu:!1,bu:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Hp(e){const t=e._freezeSettings(),n=Vd(e._databaseId);return new Kp(e._databaseId,!!t.ignoreUndefinedProperties,n)}function Gp(e,t,n,r,s,i={}){const o=e.Cu(i.merge||i.mergeFields?2:0,t,n,s);Xp("Data must be an object, but it was:",o,r);const a=Qp(r,o);let c,u;if(i.merge)c=new Gc(o.fieldMask),u=o.fieldTransforms;else if(i.mergeFields){const e=[];for(const r of i.mergeFields){const s=Yp(t,r,n);if(!o.contains(s))throw new Za(Ya.INVALID_ARGUMENT,`Field '${s}' is specified in your field mask but missing from your input data.`);ng(e,s)||e.push(s)}c=new Gc(e),u=o.fieldTransforms.filter((e=>c.covers(e.field)))}else c=null,u=o.fieldTransforms;return new qp(new Eu(a),c,u)}function Wp(e,t){if(Jp(e=S(e)))return Xp("Unsupported field value:",t,e),Qp(e,t);if(e instanceof Vp)return function(e,t){if(!$p(t.Vu))throw t.Su(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.Su(`${e._methodName}() is not currently supported inside arrays`);const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.gu&&4!==t.Vu)throw t.Su("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const s of e){let e=Wp(s,t.wu(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=S(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return Sh(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=fc.fromDate(e);return{timestampValue:Cl(t.serializer,n)}}if(e instanceof fc){const n=new fc(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:Cl(t.serializer,n)}}if(e instanceof Bp)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof Up)return{bytesValue:Al(t.serializer,e._byteString)};if(e instanceof kp){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.Su(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:Nl(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t.Su(`Unsupported field value: ${Tp(e)}`)}(e,t)}function Qp(e,t){const n={};return jc(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Bc(e,((e,r)=>{const s=Wp(r,t.fu(e));null!=s&&(n[e]=s)})),{mapValue:{fields:n}}}function Jp(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof fc||e instanceof Bp||e instanceof Up||e instanceof kp||e instanceof Vp)}function Xp(e,t,n){if(!Jp(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){const r=Tp(n);throw"an object"===r?t.Su(e+" a custom object"):t.Su(e+" "+r)}}function Yp(e,t,n){if((t=S(t))instanceof Fp)return t._internalPath;if("string"==typeof t)return eg(e,t);throw tg("Field path arguments must be of type string or ",e,!1,void 0,n)}const Zp=new RegExp("[~\\*/\\[\\]]");function eg(e,t,n){if(t.search(Zp)>=0)throw tg(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new Fp(...t.split("."))._internalPath}catch(r){throw tg(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function tg(e,t,n,r,s){const i=r&&!r.isEmpty(),o=void 0!==s;let a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${r}`),o&&(c+=` in document ${s}`),c+=")"),new Za(Ya.INVALID_ARGUMENT,a+e+c)}function ng(e,t){return e.some((e=>e.isEqual(t)))}class rg{constructor(e,t,n,r,s){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new kp(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new sg(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(ig("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class sg extends rg{data(){return super.data()}}function ig(e,t){return"string"==typeof t?eg(e,t):t instanceof Fp?t._internalPath:t._delegate._internalPath}function og(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new Za(Ya.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class ag{}class cg extends ag{}class ug extends cg{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new ug(e,t,n)}_apply(e){const t=this._parse(e);return fg(e._query,t),new Ap(e.firestore,e.converter,nh(e._query,t))}_parse(e){const t=Hp(e.firestore),n=function(e,t,n,r,s,i,o){let a;if(s.isKeyField()){if("array-contains"===i||"array-contains-any"===i)throw new Za(Ya.INVALID_ARGUMENT,`Invalid Query. You can't perform '${i}' queries on documentId().`);if("in"===i||"not-in"===i){dg(o,i);const t=[];for(const n of o)t.push(lg(r,e,n));a={arrayValue:{values:t}}}else a=lg(r,e,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||dg(o,i),a=function(e,t,n,r=!1){return Wp(n,e.Cu(r?4:3,t))}(n,"where",o,"in"===i||"not-in"===i);return Nu.create(s,i,a)}(e._query,0,t,e.firestore._databaseId,this._field,this._op,this._value);return n}}class hg extends ag{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new hg(e,t)}_parse(e){const t=this._queryConstraints.map((t=>t._parse(e))).filter((e=>e.getFilters().length>0));return 1===t.length?t[0]:Du.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const r=t.getFlattenedFilters();for(const e of r)fg(n,e),n=nh(n,e)}(e._query,t),new Ap(e.firestore,e.converter,nh(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}function lg(e,t,n){if("string"==typeof(n=S(n))){if(""===n)throw new Za(Ya.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Zu(t)&&-1!==n.indexOf("/"))throw new Za(Ya.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=t.path.child(mc.fromString(n));if(!wc.isDocumentKey(r))throw new Za(Ya.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return fu(e,new wc(r))}if(n instanceof kp)return fu(e,n._key);throw new Za(Ya.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Tp(n)}.`)}function dg(e,t){if(!Array.isArray(e)||0===e.length)throw new Za(Ya.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function fg(e,t){const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new Za(Ya.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new Za(Ya.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}class pg{convertValue(e,t="none"){switch(ou(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Yc(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Zc(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw Qa()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return Bc(e,((e,r)=>{n[e]=this.convertValue(r,t)})),n}convertGeoPoint(e){return new Bp(Yc(e.latitude),Yc(e.longitude))}convertArray(e,t){return(e.values||[]).map((e=>this.convertValue(e,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=tu(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(nu(e));default:return null}}convertTimestamp(e){const t=Xc(e);return new fc(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=mc.fromString(e);Ja(Jl(n));const r=new su(n.get(1),n.get(3)),s=new wc(n.popFirst(5));return r.isEqual(t)||Ha(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}function gg(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}class mg{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class yg extends rg{constructor(e,t,n,r,s,i){super(e,t,n,r,i),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new vg(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(ig("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class vg extends yg{data(e={}){return super.data(e)}}class wg{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new mg(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new vg(this._firestore,this._userDataWriter,n.key,n,new mg(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Za(Ya.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map((n=>{const r=new vg(e._firestore,e._userDataWriter,n.doc.key,n.doc,new mg(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}}))}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((e=>t||3!==e.type)).map((t=>{const r=new vg(e._firestore,e._userDataWriter,t.doc.key,t.doc,new mg(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let s=-1,i=-1;return 0!==t.type&&(s=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),i=n.indexOf(t.doc.key)),{type:_g(t.type),doc:r,oldIndex:s,newIndex:i}}))}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function _g(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Qa()}}class Eg extends pg{constructor(e){super(),this.firestore=e}convertBytes(e){return new Up(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new kp(this.firestore,null,t)}}function bg(e,t){return function(e,t){const n=new ec;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){const r=cp(e);try{const e=await function(e,t){const n=Xa(e),r=fc.now(),s=t.reduce(((e,t)=>e.add(t.key)),Eh());let i,o;return n.persistence.runTransaction("Locally write mutations","readwrite",(e=>{let a=dh(),c=Eh();return n.os.getEntries(e,s).next((e=>{a=e,a.forEach(((e,t)=>{t.isValidDocument()||(c=c.add(e))}))})).next((()=>n.localDocuments.getOverlayedDocuments(e,a))).next((s=>{i=s;const o=[];for(const e of t){const t=Kh(e,i.get(e.key).overlayedDocument);null!=t&&o.push(new Wh(e.key,t,bu(t.value.mapValue),Vh.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,o,t)})).next((t=>{o=t;const r=t.applyToLocalDocumentSet(i,c);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)}))})).then((()=>({batchId:o.batchId,changes:gh(i)})))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.Fa[e.currentUser.toKey()];r||(r=new qc(lc)),r=r.insert(t,n),e.Fa[e.currentUser.toKey()]=r}(r,e.batchId,n),await sp(r,e.changes),await uf(r.remoteStore)}catch(e){const t=bf(e,"Failed to persist write");n.reject(t)}}(await function(e){return gp(e).then((e=>e.syncEngine))}(e),t,n))),n.promise}(xp(e),t)}new WeakMap,function(e,t=!0){!function(e){qa=e}(pe),he(new C("firestore",((e,{instanceIdentifier:n,options:r})=>{const s=e.getProvider("app").getImmediate(),i=new Lp(new sc(e.getProvider("auth-internal")),new cc(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new Za(Ya.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new su(e.options.projectId,t)}(s,n),s);return r=Object.assign({useFetchStreams:t},r),i._setSettings(r),i}),"PUBLIC").setMultipleInstances(!0)),ye(Ba,"4.5.0",e),ye(Ba,"4.5.0","esm2017")}();const Tg="firebasestorage.googleapis.com",Ig="storageBucket";class Sg extends g{constructor(e,t,n=0){super(kg(e),`Firebase Storage: ${t} (${kg(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Sg.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return kg(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}\n${this.customData.serverResponse}`:this.message=this._baseMessage}}var Cg,Ag;function kg(e){return"storage/"+e}function Rg(){return new Sg(Cg.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function Ng(e){return new Sg(Cg.INVALID_ARGUMENT,e)}function Dg(){return new Sg(Cg.APP_DELETED,"The Firebase app was deleted.")}function Og(e,t){return new Sg(Cg.INVALID_FORMAT,"String does not match format '"+e+"': "+t)}function Pg(e){throw new Sg(Cg.INTERNAL_ERROR,"Internal error: "+e)}!function(e){e.UNKNOWN="unknown",e.OBJECT_NOT_FOUND="object-not-found",e.BUCKET_NOT_FOUND="bucket-not-found",e.PROJECT_NOT_FOUND="project-not-found",e.QUOTA_EXCEEDED="quota-exceeded",e.UNAUTHENTICATED="unauthenticated",e.UNAUTHORIZED="unauthorized",e.UNAUTHORIZED_APP="unauthorized-app",e.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",e.INVALID_CHECKSUM="invalid-checksum",e.CANCELED="canceled",e.INVALID_EVENT_NAME="invalid-event-name",e.INVALID_URL="invalid-url",e.INVALID_DEFAULT_BUCKET="invalid-default-bucket",e.NO_DEFAULT_BUCKET="no-default-bucket",e.CANNOT_SLICE_BLOB="cannot-slice-blob",e.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",e.NO_DOWNLOAD_URL="no-download-url",e.INVALID_ARGUMENT="invalid-argument",e.INVALID_ARGUMENT_COUNT="invalid-argument-count",e.APP_DELETED="app-deleted",e.INVALID_ROOT_OPERATION="invalid-root-operation",e.INVALID_FORMAT="invalid-format",e.INTERNAL_ERROR="internal-error",e.UNSUPPORTED_ENVIRONMENT="unsupported-environment"}(Cg||(Cg={}));class Lg{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let n;try{n=Lg.makeFromUrl(e,t)}catch(t){return new Lg(e,"")}if(""===n.path)return n;throw r=e,new Sg(Cg.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+r+"'.");var r}static makeFromUrl(e,t){let n=null;const r="([A-Za-z0-9.\\-_]+)",s=new RegExp("^gs://"+r+"(/(.*))?$","i");function i(e){e.path_=decodeURIComponent(e.path)}const o=t.replace(/[.]/g,"\\."),a=[{regex:s,indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${o}/v[A-Za-z0-9_]+/b/${r}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:i},{regex:new RegExp(`^https?://${t===Tg?"(?:storage.googleapis.com|storage.cloud.google.com)":t}/${r}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:i}];for(let t=0;t<a.length;t++){const r=a[t],s=r.regex.exec(e);if(s){const e=s[r.indices.bucket];let t=s[r.indices.path];t||(t=""),n=new Lg(e,t),r.postModify(n);break}}if(null==n)throw function(e){return new Sg(Cg.INVALID_URL,"Invalid URL '"+e+"'.")}(e);return n}}class xg{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function Mg(e){return"string"==typeof e||e instanceof String}function Ug(e){return Fg()&&e instanceof Blob}function Fg(){return"undefined"!=typeof Blob}function Vg(e,t,n,r){if(r<t)throw Ng(`Invalid value for '${e}'. Expected ${t} or greater.`);if(r>n)throw Ng(`Invalid value for '${e}'. Expected ${n} or less.`)}function Bg(e,t,n){let r=t;return null==n&&(r=`https://${t}`),`${n}://${r}/v0${e}`}function jg(e){const t=encodeURIComponent;let n="?";for(const r in e)e.hasOwnProperty(r)&&(n=n+(t(r)+"=")+t(e[r])+"&");return n=n.slice(0,-1),n}!function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"}(Ag||(Ag={}));class qg{constructor(e,t,n,r,s,i,o,a,c,u,h,l=!0){this.url_=e,this.method_=t,this.headers_=n,this.body_=r,this.successCodes_=s,this.additionalRetryCodes_=i,this.callback_=o,this.errorCallback_=a,this.timeout_=c,this.progressCallback_=u,this.connectionFactory_=h,this.retry=l,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise(((e,t)=>{this.resolve_=e,this.reject_=t,this.start_()}))}start_(){const e=(e,t)=>{const n=this.resolve_,r=this.reject_,s=t.connection;if(t.wasSuccessCode)try{const e=this.callback_(s,s.getResponse());!function(e){return void 0!==e}(e)?n():n(e)}catch(e){r(e)}else if(null!==s){const e=Rg();e.serverResponse=s.getErrorText(),this.errorCallback_?r(this.errorCallback_(s,e)):r(e)}else t.canceled?r(this.appDelete_?Dg():new Sg(Cg.CANCELED,"User canceled the upload/download.")):r(new Sg(Cg.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again."))};this.canceled_?e(0,new $g(!1,null,!0)):this.backoffId_=function(e,t,n){let r=1,s=null,i=null,o=!1,a=0;function c(){return 2===a}let u=!1;function h(...e){u||(u=!0,t.apply(null,e))}function l(t){s=setTimeout((()=>{s=null,e(f,c())}),t)}function d(){i&&clearTimeout(i)}function f(e,...t){if(u)return void d();if(e)return d(),void h.call(null,e,...t);if(c()||o)return d(),void h.call(null,e,...t);let n;r<64&&(r*=2),1===a?(a=2,n=0):n=1e3*(r+Math.random()),l(n)}let p=!1;function g(e){p||(p=!0,d(),u||(null!==s?(e||(a=2),clearTimeout(s),l(0)):e||(a=1)))}return l(0),i=setTimeout((()=>{o=!0,g(!0)}),n),g}(((e,t)=>{if(t)return void e(!1,new $g(!1,null,!0));const n=this.connectionFactory_();this.pendingConnection_=n;const r=e=>{const t=e.loaded,n=e.lengthComputable?e.total:-1;null!==this.progressCallback_&&this.progressCallback_(t,n)};null!==this.progressCallback_&&n.addUploadProgressListener(r),n.send(this.url_,this.method_,this.body_,this.headers_).then((()=>{null!==this.progressCallback_&&n.removeUploadProgressListener(r),this.pendingConnection_=null;const t=n.getErrorCode()===Ag.NO_ERROR,s=n.getStatus();if(!t||function(e,t){const n=e>=500&&e<600,r=-1!==[408,429].indexOf(e),s=-1!==t.indexOf(e);return n||r||s}(s,this.additionalRetryCodes_)&&this.retry){const t=n.getErrorCode()===Ag.ABORT;return void e(!1,new $g(!1,null,t))}const i=-1!==this.successCodes_.indexOf(s);e(!0,new $g(i,n))}))}),e,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&function(e){e(!1)}(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class $g{constructor(e,t,n){this.wasSuccessCode=e,this.connection=t,this.canceled=!!n}}function zg(){return"undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function Kg(...e){const t=zg();if(void 0!==t){const n=new t;for(let t=0;t<e.length;t++)n.append(e[t]);return n.getBlob()}if(Fg())return new Blob(e);throw new Sg(Cg.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}const Hg={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Gg{constructor(e,t){this.data=e,this.contentType=t||null}}function Wg(e){const t=[];for(let n=0;n<e.length;n++){let r=e.charCodeAt(n);r<=127?t.push(r):r<=2047?t.push(192|r>>6,128|63&r):55296==(64512&r)?n<e.length-1&&56320==(64512&e.charCodeAt(n+1))?(r=65536|(1023&r)<<10|1023&e.charCodeAt(++n),t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)):t.push(239,191,189):56320==(64512&r)?t.push(239,191,189):t.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(t)}function Qg(e,t){switch(e){case Hg.BASE64:{const n=-1!==t.indexOf("-"),r=-1!==t.indexOf("_");if(n||r)throw Og(e,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?");break}case Hg.BASE64URL:{const n=-1!==t.indexOf("+"),r=-1!==t.indexOf("/");if(n||r)throw Og(e,"Invalid character '"+(n?"+":"/")+"' found: is it base64 encoded?");t=t.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=function(e){if("undefined"==typeof atob)throw new Sg(Cg.UNSUPPORTED_ENVIRONMENT,"base-64 is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.");return atob(e)}(t)}catch(t){if(t.message.includes("polyfill"))throw t;throw Og(e,"Invalid character found")}const r=new Uint8Array(n.length);for(let e=0;e<n.length;e++)r[e]=n.charCodeAt(e);return r}class Jg{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(null===t)throw Og(Hg.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=t[1]||null;var r,s;null!=n&&(this.base64=(s=";base64",(r=n).length>=7&&r.substring(r.length-7)===s),this.contentType=this.base64?n.substring(0,n.length-7):n),this.rest=e.substring(e.indexOf(",")+1)}}class Xg{constructor(e,t){let n=0,r="";Ug(e)?(this.data_=e,n=e.size,r=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),n=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),n=e.length),this.size_=n,this.type_=r}size(){return this.size_}type(){return this.type_}slice(e,t){if(Ug(this.data_)){const i=(n=this.data_,r=e,s=t,n.webkitSlice?n.webkitSlice(r,s):n.mozSlice?n.mozSlice(r,s):n.slice?n.slice(r,s):null);return null===i?null:new Xg(i)}var n,r,s;{const n=new Uint8Array(this.data_.buffer,e,t-e);return new Xg(n,!0)}}static getBlob(...e){if(Fg()){const t=e.map((e=>e instanceof Xg?e.data_:e));return new Xg(Kg.apply(null,t))}{const t=e.map((e=>Mg(e)?function(e,t){switch(e){case Hg.RAW:return new Gg(Wg(t));case Hg.BASE64:case Hg.BASE64URL:return new Gg(Qg(e,t));case Hg.DATA_URL:return new Gg(function(e){const t=new Jg(e);return t.base64?Qg(Hg.BASE64,t.rest):function(e){let t;try{t=decodeURIComponent(e)}catch(e){throw Og(Hg.DATA_URL,"Malformed data URL.")}return Wg(t)}(t.rest)}(t),new Jg(t).contentType)}throw Rg()}(Hg.RAW,e).data:e.data_));let n=0;t.forEach((e=>{n+=e.byteLength}));const r=new Uint8Array(n);let s=0;return t.forEach((e=>{for(let t=0;t<e.length;t++)r[s++]=e[t]})),new Xg(r,!0)}}uploadData(){return this.data_}}function Yg(e){let t;try{t=JSON.parse(e)}catch(e){return null}return function(e){return"object"==typeof e&&!Array.isArray(e)}(t)?t:null}function Zg(e){const t=e.lastIndexOf("/",e.length-2);return-1===t?e:e.slice(t+1)}function em(e,t){return t}class tm{constructor(e,t,n,r){this.server=e,this.local=t||e,this.writable=!!n,this.xform=r||em}}let nm=null;function rm(){if(nm)return nm;const e=[];e.push(new tm("bucket")),e.push(new tm("generation")),e.push(new tm("metageneration")),e.push(new tm("name","fullPath",!0));const t=new tm("name");t.xform=function(e,t){return function(e){return!Mg(e)||e.length<2?e:Zg(e)}(t)},e.push(t);const n=new tm("size");return n.xform=function(e,t){return void 0!==t?Number(t):t},e.push(n),e.push(new tm("timeCreated")),e.push(new tm("updated")),e.push(new tm("md5Hash",null,!0)),e.push(new tm("cacheControl",null,!0)),e.push(new tm("contentDisposition",null,!0)),e.push(new tm("contentEncoding",null,!0)),e.push(new tm("contentLanguage",null,!0)),e.push(new tm("contentType",null,!0)),e.push(new tm("metadata","customMetadata",!0)),nm=e,nm}function sm(e,t,n){const r=Yg(t);return null===r?null:function(e,t,n){const r={type:"file"},s=n.length;for(let e=0;e<s;e++){const s=n[e];r[s.local]=s.xform(r,t[s.server])}return function(e,t){Object.defineProperty(e,"ref",{get:function(){const n=e.bucket,r=e.fullPath,s=new Lg(n,r);return t._makeStorageReference(s)}})}(r,e),r}(e,r,n)}class im{constructor(e,t,n,r){this.url=e,this.method=t,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function om(e){if(!e)throw Rg()}function am(e){return function(t,n){let r;var s,i;return 401===t.getStatus()?r=t.getErrorText().includes("Firebase App Check token is invalid")?new Sg(Cg.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project."):new Sg(Cg.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again."):402===t.getStatus()?(i=e.bucket,r=new Sg(Cg.QUOTA_EXCEEDED,"Quota for bucket '"+i+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===t.getStatus()?(s=e.path,r=new Sg(Cg.UNAUTHORIZED,"User does not have permission to access '"+s+"'.")):r=n,r.status=t.getStatus(),r.serverResponse=n.serverResponse,r}}function cm(e,t,n,r,s){const i=t.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"},a=function(){let e="";for(let t=0;t<2;t++)e+=Math.random().toString().slice(2);return e}();o["Content-Type"]="multipart/related; boundary="+a;const c=function(e,t,n){const r=Object.assign({},n);return r.fullPath=e.path,r.size=t.size(),r.contentType||(r.contentType=function(e,t){return t&&t.type()||"application/octet-stream"}(0,t)),r}(t,r,s),u="--"+a+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+function(e,t){const n={},r=t.length;for(let s=0;s<r;s++){const r=t[s];r.writable&&(n[r.server]=e[r.local])}return JSON.stringify(n)}(c,n)+"\r\n--"+a+"\r\nContent-Type: "+c.contentType+"\r\n\r\n",h="\r\n--"+a+"--",l=Xg.getBlob(u,r,h);if(null===l)throw new Sg(Cg.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.");const d={name:c.fullPath},f=Bg(i,e.host,e._protocol),p=e.maxUploadRetryTime,g=new im(f,"POST",function(e,t){return function(n,r){const s=sm(e,r,t);return om(null!==s),s}}(e,n),p);return g.urlParams=d,g.headers=o,g.body=l.uploadData(),g.errorHandler=am(t),g}let um=null;class hm{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Ag.NO_ERROR,this.sendPromise_=new Promise((e=>{this.xhr_.addEventListener("abort",(()=>{this.errorCode_=Ag.ABORT,e()})),this.xhr_.addEventListener("error",(()=>{this.errorCode_=Ag.NETWORK_ERROR,e()})),this.xhr_.addEventListener("load",(()=>{e()}))}))}send(e,t,n,r){if(this.sent_)throw Pg("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),void 0!==r)for(const e in r)r.hasOwnProperty(e)&&this.xhr_.setRequestHeader(e,r[e].toString());return void 0!==n?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Pg("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Pg("cannot .getStatus() before sending");try{return this.xhr_.status}catch(e){return-1}}getResponse(){if(!this.sent_)throw Pg("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Pg("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}class lm extends hm{initXhr(){this.xhr_.responseType="text"}}function dm(){return um?um():new lm}class fm{constructor(e,t){this._service=e,this._location=t instanceof Lg?t:Lg.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new fm(e,t)}get root(){const e=new Lg(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Zg(this._location.path)}get storage(){return this._service}get parent(){const e=function(e){if(0===e.length)return null;const t=e.lastIndexOf("/");return-1===t?"":e.slice(0,t)}(this._location.path);if(null===e)return null;const t=new Lg(this._location.bucket,e);return new fm(this._service,t)}_throwIfRoot(e){if(""===this._location.path)throw function(e){return new Sg(Cg.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(e)}}function pm(e){e._throwIfRoot("getDownloadURL");const t=function(e,t,n){const r=Bg(t.fullServerUrl(),e.host,e._protocol),s=e.maxOperationRetryTime,i=new im(r,"GET",function(e,t){return function(n,r){const s=sm(e,r,t);return om(null!==s),function(e,t,n,r){const s=Yg(t);if(null===s)return null;if(!Mg(s.downloadTokens))return null;const i=s.downloadTokens;if(0===i.length)return null;const o=encodeURIComponent;return i.split(",").map((t=>{const s=e.bucket,i=e.fullPath;return Bg("/b/"+o(s)+"/o/"+o(i),n,r)+jg({alt:"media",token:t})}))[0]}(s,r,e.host,e._protocol)}}(e,n),s);return i.errorHandler=function(e){const t=am(e);return function(n,r){let s=t(n,r);var i;return 404===n.getStatus()&&(i=e.path,s=new Sg(Cg.OBJECT_NOT_FOUND,"Object '"+i+"' does not exist.")),s.serverResponse=r.serverResponse,s}}(t),i}(e.storage,e._location,rm());return e.storage.makeRequestWithTokens(t,dm).then((e=>{if(null===e)throw new Sg(Cg.NO_DOWNLOAD_URL,"The given file does not have any download URLs.");return e}))}function gm(e,t){if(e instanceof ym){const n=e;if(null==n._bucket)throw new Sg(Cg.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Ig+"' property when initializing the app?");const r=new fm(n,n._bucket);return null!=t?gm(r,t):r}return void 0!==t?function(e,t){const n=function(e,t){const n=t.split("/").filter((e=>e.length>0)).join("/");return 0===e.length?n:e+"/"+n}(e._location.path,t),r=new Lg(e._location.bucket,n);return new fm(e.storage,r)}(e,t):e}function mm(e,t){const n=null==t?void 0:t[Ig];return null==n?null:Lg.makeFromBucketSpec(n,e)}class ym{constructor(e,t,n,r,s){this.app=e,this._authProvider=t,this._appCheckProvider=n,this._url=r,this._firebaseVersion=s,this._bucket=null,this._host=Tg,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=r?Lg.makeFromBucketSpec(r,this._host):mm(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,null!=this._url?this._bucket=Lg.makeFromBucketSpec(this._url,e):this._bucket=mm(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Vg("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Vg("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(null!==t)return t.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach((e=>e.cancel())),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new fm(this,e)}_makeRequest(e,t,n,r,s=!0){if(this._deleted)return new xg(Dg());{const i=function(e,t,n,r,s,i,o=!0){const a=jg(e.urlParams),c=e.url+a,u=Object.assign({},e.headers);return function(e,t){t&&(e["X-Firebase-GMPID"]=t)}(u,t),function(e,t){null!==t&&t.length>0&&(e.Authorization="Firebase "+t)}(u,n),function(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(null!=t?t:"AppManager")}(u,i),function(e,t){null!==t&&(e["X-Firebase-AppCheck"]=t)}(u,r),new qg(c,e.method,u,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,s,o)}(e,this._appId,n,r,t,this._firebaseVersion,s);return this._requests.add(i),i.getPromise().then((()=>this._requests.delete(i)),(()=>this._requests.delete(i))),i}}async makeRequestWithTokens(e,t){const[n,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,n,r).getPromise()}}const vm="@firebase/storage",wm="0.12.2",_m="storage";function Em(e,t){return function(e,t){if(t&&/^[A-Za-z]+:\/\//.test(t)){if(e instanceof ym)return new fm(e,t);throw Ng("To use ref(service, url), the first argument must be a Storage instance.")}return gm(e,t)}(e=S(e),t)}he(new C(_m,(function(e,{instanceIdentifier:t}){const n=e.getProvider("app").getImmediate(),r=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return new ym(n,r,s,t,pe)}),"PUBLIC").setMultipleInstances(!0)),ye(vm,wm,""),ye(vm,wm,"esm2017");const bm=ge({apiKey:"AIzaSyD-HYIh8x0onCBChk1wlSDlWIeSUdaFXNM",authDomain:"dcatest-2ee5f.firebaseapp.com",projectId:"dcatest-2ee5f",storageBucket:"dcatest-2ee5f.appspot.com",messagingSenderId:"634779052994",appId:"1:634779052994:web:e23d3ec2eb58c9d2f6045b",measurementId:"G-V8GF33RZ1M"}),Tm=function(e,t){const n="string"==typeof e?e:"(default)",r=le("object"==typeof e?e:me(),"firestore").getImmediate({identifier:n});if(!r._initialized){const e=c("firestore");e&&function(e,t,n,r={}){var s;const i=(e=Ip(e,Cp))._getSettings(),o=`${t}:${n}`;if("firestore.googleapis.com"!==i.host&&i.host!==o&&Ga("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},i),{host:o,ssl:!1})),r.mockUserToken){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=ja.MOCK_USER;else{t=d(r.mockUserToken,null===(s=e._app)||void 0===s?void 0:s.options.projectId);const i=r.mockUserToken.sub||r.mockUserToken.user_id;if(!i)throw new Za(Ya.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new ja(i)}e._authCredentials=new rc(new tc(t,n))}}(r,...e)}return r}(bm),Im=function(e=me()){const t=le(e,"auth");if(t.isInitialized())return t.getImmediate();const n=function(e,t){const n=le(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(v(n.getOptions(),null!=t?t:{}))return e;Le(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:gr,persistence:[Ln,yn,wn]}),r=h("authTokenSyncURL");if(r&&r.match(/^\/[^\/].*/)){const e=(s=r,async e=>{const t=e&&await e.getIdTokenResult(),n=t&&((new Date).getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>wr)return;const r=null==t?void 0:t.token;_r!==r&&(_r=r,await fetch(s,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))});!function(e,t,n){S(e).beforeAuthStateChanged(t,n)}(n,e,(()=>e(n.currentUser))),function(t,n,r,s){S(t).onIdTokenChanged((t=>e(t)),void 0,void 0)}(n)}var s;const i=a("auth");return i&&function(e,t,n){const r=Lt(e);Ue(r._canInitEmulator,r,"emulator-config-failed"),Ue(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const s=!!(null==n?void 0:n.disableWarnings),i=qt(t),{host:o,port:a}=function(e){const t=qt(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const e=s[1];return{host:e,port:$t(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:$t(t)}}}(t),c=null===a?"":`:${a}`;r.config.emulator={url:`${i}//${o}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),s||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}(n,`http://${i}`),n}(bm),Sm=function(e=me(),t){const n=le(e=S(e),_m).getImmediate({identifier:t}),r=c("storage");return r&&function(e,t,n,r={}){!function(e,t,n,r={}){e.host=`${t}:${n}`,e._protocol="http";const{mockUserToken:s}=r;s&&(e._overrideAuthToken="string"==typeof s?s:d(s,e.app.options.projectId))}(e,t,n,r)}(n,...r),n}(),Cm=e=>{(function(e,t,n){return async function(e,t){return dn(Lt(e),t)}(S(e),Zt.credential(t,n)).catch((async t=>{throw"auth/password-does-not-meet-requirements"===t.code&&fn(e),t}))})(Im,e.email,e.password).then((async e=>{const t=e.user;console.log(t.uid)})).catch((e=>{const t=e.code,n=e.message;console.error(t,n)}))},Am=async e=>{const t=function(e,t,...n){let r=[];t instanceof ag&&r.push(t),r=r.concat(n),function(e){const t=e.filter((e=>e instanceof hg)).length,n=e.filter((e=>e instanceof ug)).length;if(t>1||t>0&&n>0)throw new Za(Ya.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const t of r)e=t._apply(e);return e}(Np(Tm,"posts"),function(e,t,n){const r=ig("where","idUser");return ug._create(r,"==",n)}(0,0,e)),n=await function(e){e=Ip(e,Ap);const t=Ip(e.firestore,Lp),n=xp(t),r=new Eg(t);return og(e._query),yp(n,e._query).then((n=>new wg(t,r,e,n)))}(t),r=[];return n.forEach((e=>{const t=e.data();r.push(Object.assign({id:e.id},t))})),r},km=async(e,t)=>{(function(e,t,n){return function(e,t,n){e._throwIfRoot("uploadBytes");const r=cm(e.storage,e._location,rm(),new Xg(t,!0),n);return e.storage.makeRequestWithTokens(r,dm).then((t=>({metadata:t,ref:e})))}(e=S(e),t,void 0)})(Em(Sm,"imgsProfile/"+t),e).then((e=>{console.log("Uploaded a blob or file!")}))},Rm=e=>{!function(e,...t){var n,r,s;e=S(e);let i={includeMetadataChanges:!1,source:"default"},o=0;"object"!=typeof t[o]||Pp(t[o])||(i=t[o],o++);const a={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(Pp(t[o])){const e=t[o];t[o]=null===(n=e.next)||void 0===n?void 0:n.bind(e),t[o+1]=null===(r=e.error)||void 0===r?void 0:r.bind(e),t[o+2]=null===(s=e.complete)||void 0===s?void 0:s.bind(e)}let c,u,h;if(e instanceof kp)u=Ip(e.firestore,Lp),h=Xu(e._key.path),c={next:n=>{t[o]&&t[o](function(e,t,n){const r=n.docs.get(t._key),s=new Eg(e);return new yg(e,s,t._key,r,new mg(n.hasPendingWrites,n.fromCache),t.converter)}(u,e,n))},error:t[o+1],complete:t[o+2]};else{const n=Ip(e,Ap);u=Ip(n.firestore,Lp),h=n._query;const r=new Eg(u);c={next:e=>{t[o]&&t[o](new wg(u,r,n,e))},error:t[o+1],complete:t[o+2]},og(e._query)}!function(e,t,n,r){const s=new lp(r),i=new Lf(t,s,n);e.asyncQueue.enqueueAndForget((async()=>kf(await mp(e),i)))}(xp(u),h,a,c)}(Np(Tm,"posts"),(t=>{const n=t.docs.map((e=>Object.assign({id:e.id},e.data())));e(n)}))},Nm={email:"",password:""};class Dm extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render()}changeEmail(e){var t;Nm.email=null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.value}changePassword(e){var t;Nm.password=null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.value}submitForm(){Cm(Nm)}render(){var e,t,n,r;const s=this.ownerDocument.createElement("h1");s.innerText="Iniciar sesin",null===(e=this.shadowRoot)||void 0===e||e.appendChild(s);const i=this.ownerDocument.createElement("input");i.placeholder="Correo electronico",i.addEventListener("change",this.changeEmail),null===(t=this.shadowRoot)||void 0===t||t.appendChild(i);const o=this.ownerDocument.createElement("input");o.placeholder="Contrasea",o.addEventListener("change",this.changePassword),null===(n=this.shadowRoot)||void 0===n||n.appendChild(o);const a=this.ownerDocument.createElement("button");a.innerText="Iniciar sesin",a.addEventListener("click",this.submitForm),null===(r=this.shadowRoot)||void 0===r||r.appendChild(a)}}customElements.define("app-login",Dm);const Om={email:"",password:"",age:""};class Pm extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render()}changeEmail(e){var t;Om.email=null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.value}changePassword(e){var t;Om.password=null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.value}changeAge(e){var t;Om.age=null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.value}submitForm(){(e=>{(async function(e,t,n){const r=Lt(e),s=jt(r,{returnSecureToken:!0,email:t,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",an),i=await s.catch((t=>{throw"auth/password-does-not-meet-requirements"===t.code&&fn(e),t})),o=await cn._fromIdTokenResponse(r,"signIn",i);return await r._updateCurrentUser(o.user),o})(Im,e.email,e.password).then((async t=>{const n=t.user;console.log(n.uid);try{const t=Dp(Tm,"users",n.uid),r={age:e.age};await function(e,t,n){e=Ip(e,kp);const r=Ip(e.firestore,Lp),s=gg(e.converter,t,n);return bg(r,[Gp(Hp(r),"setDoc",e._key,s,null!==e.converter,n).toMutation(e._key,Vh.none())])}(t,r),alert("Se cre el usuario")}catch(e){console.error(e)}})).catch((e=>{const t=e.code,n=e.message;console.error(t,n)}))})(Om)}async render(){var e,t,n,r,s;const i=this.ownerDocument.createElement("h1");i.innerText="Registrarme",null===(e=this.shadowRoot)||void 0===e||e.appendChild(i);const o=this.ownerDocument.createElement("input");o.placeholder="Correo electronico",o.addEventListener("change",this.changeEmail),null===(t=this.shadowRoot)||void 0===t||t.appendChild(o);const a=this.ownerDocument.createElement("input");a.placeholder="Contrasea",a.addEventListener("change",this.changePassword),null===(n=this.shadowRoot)||void 0===n||n.appendChild(a);const c=this.ownerDocument.createElement("input");c.placeholder="Edad",c.addEventListener("change",this.changeAge),null===(r=this.shadowRoot)||void 0===r||r.appendChild(c);const u=this.ownerDocument.createElement("button");u.innerText="Registrarme",u.addEventListener("click",this.submitForm),null===(s=this.shadowRoot)||void 0===s||s.appendChild(u)}}var Lm;customElements.define("app-register",Pm),function(e){e.LOGIN="LOGIN",e.DASHBOARD="DASHBOARD",e.REGISTER="REGISTER",e.PROFILE="PROFILE"}(Lm||(Lm={}));const xm=e=>({action:"NAVIGATE",payload:e});!function(e,t,n,r){S(e).onAuthStateChanged((e=>{e?(null!==e.uid&&Fm((e=>({action:"SETUSER",payload:e}))(e.uid)),Fm(xm(Lm.DASHBOARD))):Fm(xm(Lm.LOGIN))}),void 0,void 0)}(Im);let Mm={screen:Lm.LOGIN,posts:[],user:"",postsProfile:[]},Um=[];const Fm=e=>{const t=((e,t)=>{const{action:n,payload:r}=e;switch(n){case"NAVIGATE":t.screen=r;break;case"GETPOSTS":t.posts=r;break;case"GETPOSTSPROFILE":t.postsProfile=r;break;case"SETUSER":t.user=r}return t})(e,JSON.parse(JSON.stringify(Mm)));Mm=t,Um.forEach((e=>e.render()))},Vm=e=>{Um=[...Um,e]},Bm={artistName:"",price:0,idUser:""};class jm extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),Vm(this)}async connectedCallback(){this.render()}submitForm(){Bm.idUser=Mm.user,(async e=>{try{const t=await function(e,t){const n=Ip(e.firestore,Lp),r=Dp(e),s=gg(e.converter,t);return bg(n,[Gp(Hp(e.firestore),"addDoc",r._key,s,null!==e.converter,{}).toMutation(r._key,Vh.exists(!1))]).then((()=>r))}(Np(Tm,"posts"),e);console.log("Document written with ID: ",t.id)}catch(e){console.error("Error adding document: ",e)}})(Bm)}goProfile(){Fm(xm(Lm.PROFILE))}changeName(e){var t;Bm.artistName=null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.value}changePrice(e){var t;Bm.price=Number(null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.value)}logout(){indexedDB.deleteDatabase("firebase-heartbeat-database"),indexedDB.deleteDatabase("firebaseLocalStorageDb"),window.location.reload()}render(){var e,t,n,r,s,i,o,a;console.log(Mm.posts);const c=this.ownerDocument.createElement("h1");c.innerText="Dashboard",null===(e=this.shadowRoot)||void 0===e||e.appendChild(c);const u=this.ownerDocument.createElement("input");u.placeholder="Artist Name",u.addEventListener("change",this.changeName),null===(t=this.shadowRoot)||void 0===t||t.appendChild(u);const h=this.ownerDocument.createElement("input");h.placeholder="Price",h.addEventListener("change",this.changePrice),null===(n=this.shadowRoot)||void 0===n||n.appendChild(h);const l=this.ownerDocument.createElement("button");l.innerText="Save",l.addEventListener("click",this.submitForm),null===(r=this.shadowRoot)||void 0===r||r.appendChild(l);const d=this.ownerDocument.createElement("button");d.innerText="Go to my profile",d.addEventListener("click",this.goProfile),null===(s=this.shadowRoot)||void 0===s||s.appendChild(d);const f=this.ownerDocument.createElement("input");f.type="file",f.addEventListener("change",(()=>{var e;const t=null===(e=f.files)||void 0===e?void 0:e[0];t&&km(t,Mm.user)})),null===(i=this.shadowRoot)||void 0===i||i.appendChild(f);const p=this.ownerDocument.createElement("button");p.innerText="Logout",p.addEventListener("click",this.logout),null===(o=this.shadowRoot)||void 0===o||o.appendChild(p);const g=this.ownerDocument.createElement("section");null===(a=this.shadowRoot)||void 0===a||a.appendChild(g),Rm((e=>{for(;g.firstChild;)g.removeChild(g.firstChild);e.forEach((e=>{const t=this.ownerDocument.createElement("section"),n=this.ownerDocument.createElement("h4");n.innerText=e.artistName,t.appendChild(n);const r=this.ownerDocument.createElement("p");r.innerText=String(e.price),t.appendChild(r),g.prepend(t)}))}))}}customElements.define("app-dashboard",jm);class qm extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),Vm(this)}async connectedCallback(){if(0===Mm.postsProfile.length){const e=await(async e=>({action:"GETPOSTSPROFILE",payload:await Am(e)}))(Mm.user);Fm(e)}else this.render()}async render(){var e,t;const n=this.ownerDocument.createElement("h1");n.innerText="Profile",null===(e=this.shadowRoot)||void 0===e||e.appendChild(n);const r=await(async e=>{const t=Em(Sm,"imgsProfile/"+e);return await function(e){return pm(e=S(e))}(Em(t)).then((e=>e)).catch((e=>{console.error(e)}))})(Mm.user),s=this.ownerDocument.createElement("img");s.src=String(r),null===(t=this.shadowRoot)||void 0===t||t.appendChild(s),Mm.postsProfile.forEach((e=>{var t,n;const r=this.ownerDocument.createElement("p");r.innerText=e.artistName,null===(t=this.shadowRoot)||void 0===t||t.appendChild(r);const s=this.ownerDocument.createElement("p");s.innerText=e.price,null===(n=this.shadowRoot)||void 0===n||n.appendChild(s)}))}}customElements.define("app-profile",qm);class $m extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),Vm(this)}connectedCallback(){this.render()}render(){var e,t,n,r;switch(this.shadowRoot&&(this.shadowRoot.innerHTML=""),Mm.screen){case Lm.DASHBOARD:const s=this.ownerDocument.createElement("app-dashboard");null===(e=this.shadowRoot)||void 0===e||e.appendChild(s);break;case Lm.LOGIN:const i=this.ownerDocument.createElement("app-login");null===(t=this.shadowRoot)||void 0===t||t.appendChild(i);break;case Lm.REGISTER:const o=this.ownerDocument.createElement("app-register");null===(n=this.shadowRoot)||void 0===n||n.appendChild(o);break;case Lm.PROFILE:const a=this.ownerDocument.createElement("app-profile");null===(r=this.shadowRoot)||void 0===r||r.appendChild(a)}}}customElements.define("app-container",$m)})();